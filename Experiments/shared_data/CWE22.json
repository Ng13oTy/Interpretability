[{"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case id is not in query string */\r\n    /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n    {\r\n        StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n        while (tokenizer.hasMoreTokens()) {\r\n            String token = tokenizer.nextToken();\r\n            /* a token will be like \"id=foo\" */\r\n            if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n            {\r\n                data = token.substring(3);\r\n                /* set data to \"foo\" */\r\n                break;\r\n                /* exit while loop */\r\n            }\r\n        }\r\n    }\r\n    (new CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 36, "column": 13, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2, 0], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 37, "column": 20, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 39, "column": 17, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 40, "column": 20, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 42, "column": 21, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 48, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b()).badSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c()).badSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR5", ",", "VAR6", ",", "VAR7", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 14, 8, 15, 8, 18, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR8", ",", "HttpServletRequest", "VAR9", ",", "HttpServletResponse", "VAR10", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 26, 8, 39, 31, 8, 40, 36, 2, 22, 23]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR11", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [44, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR11", "=", "\"/home/user/uploads/\""], "tokens_order": [44, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["File", "VAR12", "=", "new", "File", "(", "VAR11", "+", "VAR8", ")"], "tokens_order": [55, 52, 4, 7, 55, 1, 44, 21, 26, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR12", ".", "exists", "(", ")", "&&", "VAR12", ".", "isFile", "(", ")"], "tokens_order": [52, 3, 194, 1, 2, 76, 52, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR13", "=", "new", "FileInputStream", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 66, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR14", "=", "new", "InputStreamReader", "(", "VAR13", ",", "\"UTF-8\"", ")"], "tokens_order": [77, 4, 7, 46, 1, 60, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR15", "=", "new", "BufferedReader", "(", "VAR14", ")"], "tokens_order": [91, 4, 7, 45, 1, 77, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["CLS2", ".", "FUN2", "(", "VAR15", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 57, 1, 91, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_52c", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 7, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 1, "target": 7, "type": "DDG"}, {"id": 6, "source": 4, "target": 5, "type": "DDG"}, {"id": 7, "source": 4, "target": 6, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 13, "type": "DDG"}, {"id": 1, "source": 10, "target": 14, "type": "DDG"}, {"id": 2, "source": 12, "target": 14, "type": "DDG"}, {"id": 3, "source": 11, "target": 14, "type": "DDG"}, {"id": 4, "source": 14, "target": 15, "type": "DDG"}, {"id": 5, "source": 14, "target": 16, "type": "DDG"}, {"id": 6, "source": 16, "target": 17, "type": "DDG"}, {"id": 7, "source": 17, "target": 18, "type": "DDG"}, {"id": 8, "source": 18, "target": 19, "type": "DDG"}, {"id": 9, "source": 18, "target": 20, "type": "DDG"}, {"id": 10, "source": 18, "target": 21, "type": "DDG"}, {"id": 11, "source": 17, "target": 22, "type": "DDG"}, {"id": 12, "source": 17, "target": 23, "type": "DDG"}, {"id": 13, "source": 16, "target": 24, "type": "DDG"}, {"id": 14, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_53a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 55, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 56, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 107, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 109, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_53b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__listen_tcp_53b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__listen_tcp_53b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__listen_tcp_53c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_53c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__listen_tcp_53c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__listen_tcp_53c()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__listen_tcp_53d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 15, 2, 22, 23, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__listen_tcp_53d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__listen_tcp_53d()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR6", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 15, 2, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 18, 2, 22, 23, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0], "bad_sink": true}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0]}, {"id": 26, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["CLS3", ".", "FUN1", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 25, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 33, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 21, "type": "DDG"}, {"id": 1, "source": 18, "target": 22, "type": "DDG"}, {"id": 2, "source": 19, "target": 22, "type": "DDG"}, {"id": 3, "source": 20, "target": 22, "type": "DDG"}, {"id": 4, "source": 22, "target": 23, "type": "DDG"}, {"id": 5, "source": 22, "target": 24, "type": "DDG"}, {"id": 6, "source": 24, "target": 25, "type": "DDG"}, {"id": 7, "source": 25, "target": 26, "type": "DDG"}, {"id": 8, "source": 26, "target": 27, "type": "DDG"}, {"id": 9, "source": 26, "target": 28, "type": "DDG"}, {"id": 10, "source": 26, "target": 29, "type": "DDG"}, {"id": 11, "source": 25, "target": 30, "type": "DDG"}, {"id": 12, "source": 25, "target": 31, "type": "DDG"}, {"id": 13, "source": 24, "target": 32, "type": "DDG"}, {"id": 14, "source": 24, "target": 33, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_01____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 192, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 198, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 203, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 206, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 209, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 213, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 217, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 218, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 219, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 220, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 231, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 233, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 243, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 245, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 255, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 257, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_81a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 41, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 50, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 61, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 63, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 73, "column": 9, "tokens": ["CWE23_Relative_Path_Traversal__PropertiesFile_81_base", "baseObject", "=", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "(", ")"], "code": "CWE23_Relative_Path_Traversal__PropertiesFile_81_base baseObject = new CWE23_Relative_Path_Traversal__PropertiesFile_81_bad()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["CLS0", "VAR3", "=", "new", "VAR", "(", ")"], "tokens_order": [27, 9, 4, 7, 78, 1, 2, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_81_base", "mtdSignature": "action(java.lang.String)", "called_column": "9"}], "varibles": ["data", "baseObject"], "line": 74, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ")"], "code": "baseObject.action(data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81a", "new_tokens": ["VAR3", ".", "FUN0", "(", "VAR2", ")"], "tokens_order": [9, 3, 16, 1, 6, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void action(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 11, 2, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_81_bad", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 7, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 11, "type": "DDG"}, {"id": 1, "source": 8, "target": 12, "type": "DDG"}, {"id": 2, "source": 10, "target": 12, "type": "DDG"}, {"id": 3, "source": 9, "target": 12, "type": "DDG"}, {"id": 4, "source": 12, "target": 13, "type": "DDG"}, {"id": 5, "source": 12, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 16, "target": 17, "type": "DDG"}, {"id": 9, "source": 16, "target": 18, "type": "DDG"}, {"id": 10, "source": 16, "target": 19, "type": "DDG"}, {"id": 11, "source": 15, "target": 20, "type": "DDG"}, {"id": 12, "source": 15, "target": 21, "type": "DDG"}, {"id": 13, "source": 14, "target": 22, "type": "DDG"}, {"id": 14, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String dataCopy;\r\n    {\r\n        String data;\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n        dataCopy = data;\r\n    }\r\n    {\r\n        String data = dataCopy;\r\n        String root;\r\n        if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n            /* running on Windows */\r\n            root = \"C:\\\\uploads\\\\\";\r\n        } else {\r\n            /* running on non-Windows */\r\n            root = \"/home/user/uploads/\";\r\n        }\r\n        if (data != null) {\r\n            /* POTENTIAL FLAW: no validation of concatenated value */\r\n            File file = new File(root + data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 37, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "dataCopy"], "line": 39, "column": 13, "tokens": ["dataCopy", "=", "data"], "code": "dataCopy = data", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR3", "=", "VAR2"], "tokens_order": [9, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataCopy", "data"], "line": 42, "column": 13, "tokens": ["String", "data", "=", "dataCopy"], "code": "String data = dataCopy", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["String", "VAR2", "=", "VAR3"], "tokens_order": [20, 6, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 53, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 56, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 59, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR2", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 63, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 67, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 68, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 69, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 70, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 81, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 83, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 93, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 95, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 105, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 107, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_31", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 6, "type": "DDG"}, {"id": 4, "source": 3, "target": 7, "type": "DDG"}, {"id": 5, "source": 5, "target": 7, "type": "DDG"}, {"id": 6, "source": 4, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": 13, "source": 11, "target": 14, "type": "DDG"}, {"id": 14, "source": 10, "target": 15, "type": "DDG"}, {"id": 15, "source": 10, "target": 16, "type": "DDG"}, {"id": 16, "source": 9, "target": 17, "type": "DDG"}, {"id": 17, "source": 9, "target": 18, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__File_41____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 119, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 127, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 128, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 129, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 134, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 145, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 147, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 157, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 159, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 169, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 171, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__File_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 181, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["FUN0", "(", "VAR4", ")"], "tokens_order": [16, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 46, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 49, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 52, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 56, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 60, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 61, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 62, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 63, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 74, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 86, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 98, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_41", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 15, "type": "DDG"}, {"id": 1, "source": 12, "target": 16, "type": "DDG"}, {"id": 2, "source": 14, "target": 16, "type": "DDG"}, {"id": 3, "source": 13, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 16, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 19, "target": 20, "type": "DDG"}, {"id": 8, "source": 20, "target": 21, "type": "DDG"}, {"id": 9, "source": 20, "target": 22, "type": "DDG"}, {"id": 10, "source": 20, "target": 23, "type": "DDG"}, {"id": 11, "source": 19, "target": 24, "type": "DDG"}, {"id": 12, "source": 19, "target": 25, "type": "DDG"}, {"id": 13, "source": 18, "target": 26, "type": "DDG"}, {"id": 14, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_41____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 120, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 125, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 126, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 129, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 140, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 142, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 152, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["FUN0", "(", "VAR2", ")"], "tokens_order": [16, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR3", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 9, 2, 22, 23, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 45, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 48, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 51, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 55, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 59, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 60, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 61, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 62, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 73, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 75, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 85, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 87, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 97, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 99, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_41", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 10, "type": "DDG"}, {"id": 1, "source": 7, "target": 11, "type": "DDG"}, {"id": 2, "source": 9, "target": 11, "type": "DDG"}, {"id": 3, "source": 8, "target": 11, "type": "DDG"}, {"id": 4, "source": 11, "target": 12, "type": "DDG"}, {"id": 5, "source": 11, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 15, "target": 16, "type": "DDG"}, {"id": 9, "source": 15, "target": 17, "type": "DDG"}, {"id": 10, "source": 15, "target": 18, "type": "DDG"}, {"id": 11, "source": 14, "target": 19, "type": "DDG"}, {"id": 12, "source": 14, "target": 20, "type": "DDG"}, {"id": 13, "source": 13, "target": 21, "type": "DDG"}, {"id": 14, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_75a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 52, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 55, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 56, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 59, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 70, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 72, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 82, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 84, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 94, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 96, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 112, "column": 13, "tokens": ["streamByteArrayOutput", "=", "new", "ByteArrayOutputStream", "(", ")"], "code": "streamByteArrayOutput = new ByteArrayOutputStream()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR4", "=", "new", "ByteArrayOutputStream", "(", ")"], "tokens_order": [11, 4, 7, 142, 1, 2, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["outputObject", "streamByteArrayOutput"], "line": 113, "column": 13, "tokens": ["outputObject", "=", "new", "ObjectOutputStream", "(", "streamByteArrayOutput", ")"], "code": "outputObject = new ObjectOutputStream(streamByteArrayOutput)", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR5", "=", "new", "ObjectOutputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 143, 1, 11, 2, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "outputObject"], "line": 114, "column": 13, "tokens": ["outputObject", ".", "writeObject", "(", "data", ")"], "code": "outputObject.writeObject(data)", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR5", ".", "writeObject", "(", "VAR3", ")"], "tokens_order": [14, 3, 144, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayOutput"], "line": 115, "column": 13, "tokens": ["byte", "[", "]", "dataSerialized", "=", "streamByteArrayOutput", ".", "toByteArray", "(", ")"], "code": "byte[] dataSerialized = streamByteArrayOutput.toByteArray()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["byte", "[", "]", "VAR6", "=", "VAR4", ".", "toByteArray", "(", ")"], "tokens_order": [51, 29, 30, 15, 4, 11, 3, 145, 1, 2, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_75b", "mtdSignature": "badSink(byte[])", "called_column": "13"}], "varibles": ["dataSerialized"], "line": 116, "column": 13, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_75b", "(", ")", ")", ".", "badSink", "(", "dataSerialized", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_75b()).badSink(dataSerialized)", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR6", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 15, 2]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 127, "column": 21, "tokens": ["outputObject", "!=", "null"], "code": "outputObject != null", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 129, "column": 21, "tokens": ["outputObject", ".", "close", "(", ")"], "code": "outputObject.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 139, "column": 21, "tokens": ["streamByteArrayOutput", "!=", "null"], "code": "streamByteArrayOutput != null", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 141, "column": 21, "tokens": ["streamByteArrayOutput", ".", "close", "(", ")"], "code": "streamByteArrayOutput.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataSerialized"], "line": 31, "column": 5, "tokens": ["public", "void", "badSink", "(", "byte", "[", "]", "dataSerialized", ")", "throws", "Throwable"], "code": "public void badSink(byte[] dataSerialized) throws Throwable {\r\n    /* unserialize data */\r\n    ByteArrayInputStream streamByteArrayInput = null;\r\n    ObjectInputStream streamObjectInput = null;\r\n    try {\r\n        streamByteArrayInput = new ByteArrayInputStream(dataSerialized);\r\n        streamObjectInput = new ObjectInputStream(streamByteArrayInput);\r\n        String data = (String) streamObjectInput.readObject();\r\n        String root;\r\n        if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n            /* running on Windows */\r\n            root = \"C:\\\\uploads\\\\\";\r\n        } else {\r\n            /* running on non-Windows */\r\n            root = \"/home/user/uploads/\";\r\n        }\r\n        if (data != null) {\r\n            /* POTENTIAL FLAW: no validation of concatenated value */\r\n            File file = new File(root + data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } catch (IOException exceptIO) {\r\n        IO.logger.log(Level.WARNING, \"IOException in deserialization\", exceptIO);\r\n    } catch (ClassNotFoundException exceptClassNotFound) {\r\n        IO.logger.log(Level.WARNING, \"ClassNotFoundException in deserialization\", exceptClassNotFound);\r\n    } finally {\r\n        /* clean up stream reading objects */\r\n        try {\r\n            if (streamObjectInput != null) {\r\n                streamObjectInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ObjectInputStream\", exceptIO);\r\n        }\r\n        try {\r\n            if (streamByteArrayInput != null) {\r\n                streamByteArrayInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ByteArrayInputStream\", exceptIO);\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["public", "void", "FUN1", "(", "byte", "[", "]", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 51, 29, 30, 18, 2, 22, 23]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayInput"], "line": 39, "column": 13, "tokens": ["streamByteArrayInput", "=", "new", "ByteArrayInputStream", "(", "dataSerialized", ")"], "code": "streamByteArrayInput = new ByteArrayInputStream(dataSerialized)", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR8", "=", "new", "ByteArrayInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 146, 1, 18, 2, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput", "streamObjectInput"], "line": 40, "column": 13, "tokens": ["streamObjectInput", "=", "new", "ObjectInputStream", "(", "streamByteArrayInput", ")"], "code": "streamObjectInput = new ObjectInputStream(streamByteArrayInput)", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR9", "=", "new", "ObjectInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 147, 1, 26, 2, 0, 0, 0, 0]}, {"id": 22, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "streamObjectInput"], "line": 41, "column": 13, "tokens": ["String", "data", "=", "(", "String", ")", "streamObjectInput", ".", "readObject", "(", ")"], "code": "String data = (String) streamObjectInput.readObject()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["String", "VAR10", "=", "(", "String", ")", "VAR9", ".", "readObject", "(", ")"], "tokens_order": [20, 36, 4, 1, 20, 2, 31, 3, 148, 1, 2]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 47, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR11", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [44, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 52, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR11", "=", "\"/home/user/uploads/\""], "tokens_order": [44, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 55, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 58, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["File", "VAR12", "=", "new", "File", "(", "VAR11", "+", "VAR10", ")"], "tokens_order": [55, 52, 4, 7, 55, 1, 44, 21, 36, 2, 0], "bad_sink": true}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 62, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR12", ".", "exists", "(", ")", "&&", "VAR12", ".", "isFile", "(", ")"], "tokens_order": [52, 3, 194, 1, 2, 76, 52, 3, 197, 1, 2]}, {"id": 28, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 66, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR13", "=", "new", "FileInputStream", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 66, 1, 52, 2, 0, 0, 0, 0]}, {"id": 29, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 67, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR14", "=", "new", "InputStreamReader", "(", "VAR13", ",", "\"UTF-8\"", ")"], "tokens_order": [77, 4, 7, 46, 1, 60, 8, 42, 2, 0, 0]}, {"id": 30, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 68, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR15", "=", "new", "BufferedReader", "(", "VAR14", ")"], "tokens_order": [91, 4, 7, 45, 1, 77, 2, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 69, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR15", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 91, 3, 47, 1, 2, 2, 0]}, {"id": 32, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 80, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 33, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 34, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 92, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 35, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 36, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 104, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 37, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 38, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 131, "column": 21, "tokens": ["streamObjectInput", "!=", "null"], "code": "streamObjectInput != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 39, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 133, "column": 21, "tokens": ["streamObjectInput", ".", "close", "(", ")"], "code": "streamObjectInput.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 40, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 143, "column": 21, "tokens": ["streamByteArrayInput", "!=", "null"], "code": "streamByteArrayInput != null", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 41, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 145, "column": 21, "tokens": ["streamByteArrayInput", ".", "close", "(", ")"], "code": "streamByteArrayInput.close()", "java_file": "CWE23_Relative_Path_Traversal__database_75b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 10, "target": 11, "type": "DDG"}, {"id": 10, "source": 3, "target": 12, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 10, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 11, "target": 15, "type": "DDG"}, {"id": 15, "source": 11, "target": 16, "type": "DDG"}, {"id": 16, "source": 10, "target": 17, "type": "DDG"}, {"id": 17, "source": 10, "target": 18, "type": "DDG"}, {"id": "-1", "source": 14, "target": 19, "type": "func_call_out"}, {"id": 0, "source": 19, "target": 20, "type": "DDG"}, {"id": 1, "source": 20, "target": 21, "type": "DDG"}, {"id": 2, "source": 21, "target": 22, "type": "DDG"}, {"id": 3, "source": 22, "target": 25, "type": "DDG"}, {"id": 4, "source": 22, "target": 26, "type": "DDG"}, {"id": 5, "source": 23, "target": 26, "type": "DDG"}, {"id": 6, "source": 24, "target": 26, "type": "DDG"}, {"id": 7, "source": 21, "target": 38, "type": "DDG"}, {"id": 8, "source": 21, "target": 39, "type": "DDG"}, {"id": 9, "source": 20, "target": 40, "type": "DDG"}, {"id": 10, "source": 20, "target": 41, "type": "DDG"}, {"id": 11, "source": 26, "target": 27, "type": "DDG"}, {"id": 12, "source": 26, "target": 28, "type": "DDG"}, {"id": 13, "source": 28, "target": 29, "type": "DDG"}, {"id": 14, "source": 29, "target": 30, "type": "DDG"}, {"id": 15, "source": 30, "target": 31, "type": "DDG"}, {"id": 16, "source": 30, "target": 32, "type": "DDG"}, {"id": 17, "source": 30, "target": 33, "type": "DDG"}, {"id": 18, "source": 29, "target": 34, "type": "DDG"}, {"id": 19, "source": 29, "target": 35, "type": "DDG"}, {"id": 20, "source": 28, "target": 36, "type": "DDG"}, {"id": 21, "source": 28, "target": 37, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_73a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 49, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 52, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 53, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 56, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 67, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 69, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 79, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 81, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 91, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 93, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 103, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR4", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 11, 4, 7, 69, 32, 20, 34, 1, 2]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 104, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR4", ".", "add", "(", "0", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 33, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 105, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR4", ".", "add", "(", "1", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 37, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 106, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["VAR4", ".", "add", "(", "2", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 35, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>)", "called_column": "9"}], "varibles": ["dataLinkedList"], "line": 107, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_73b()).badSink(dataLinkedList)", "java_file": "CWE23_Relative_Path_Traversal__database_73a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR4", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 11, 2, 0, 0]}, {"id": 15, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["public", "void", "FUN1", "(", "LinkedList", "<", "String", ">", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 69, 32, 20, 34, 14, 2, 22, 23, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "remove", "(", "2", ")"], "tokens_order": [20, 15, 4, 14, 3, 89, 1, 35, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR6", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 15, 2, 0, 0, 0], "bad_sink": true}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_73b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 12, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 3, "target": 13, "type": "DDG"}, {"id": 14, "source": 10, "target": 13, "type": "DDG"}, {"id": 15, "source": 10, "target": 14, "type": "DDG"}, {"id": "-1", "source": 14, "target": 15, "type": "func_call_out"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": 1, "source": 16, "target": 19, "type": "DDG"}, {"id": 2, "source": 16, "target": 20, "type": "DDG"}, {"id": 3, "source": 17, "target": 20, "type": "DDG"}, {"id": 4, "source": 18, "target": 20, "type": "DDG"}, {"id": 5, "source": 20, "target": 21, "type": "DDG"}, {"id": 6, "source": 20, "target": 22, "type": "DDG"}, {"id": 7, "source": 22, "target": 23, "type": "DDG"}, {"id": 8, "source": 23, "target": 24, "type": "DDG"}, {"id": 9, "source": 24, "target": 25, "type": "DDG"}, {"id": 10, "source": 24, "target": 26, "type": "DDG"}, {"id": 11, "source": 24, "target": 27, "type": "DDG"}, {"id": 12, "source": 23, "target": 28, "type": "DDG"}, {"id": 13, "source": 23, "target": 29, "type": "DDG"}, {"id": 14, "source": 22, "target": 30, "type": "DDG"}, {"id": 15, "source": 22, "target": 31, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_72a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 35, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR1", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 10, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 36, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["VAR1", ".", "add", "(", "0", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 33, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 37, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["VAR1", ".", "add", "(", "1", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 37, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 38, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["VAR1", ".", "add", "(", "2", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 35, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Environment_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 39, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__Environment_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ")"], "code": "(new CWE23_Relative_Path_Traversal__Environment_72b()).badSink(dataVector)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2, 0, 0, 0]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 6, 2, 22, 23, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "remove", "(", "2", ")"], "tokens_order": [20, 9, 4, 6, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_72b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 4, "type": "DDG"}, {"id": 6, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 10, "type": "DDG"}, {"id": 2, "source": 7, "target": 11, "type": "DDG"}, {"id": 3, "source": 8, "target": 11, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 11, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 15, "target": 16, "type": "DDG"}, {"id": 10, "source": 15, "target": 17, "type": "DDG"}, {"id": 11, "source": 15, "target": 18, "type": "DDG"}, {"id": 12, "source": 14, "target": 19, "type": "DDG"}, {"id": 13, "source": 14, "target": 20, "type": "DDG"}, {"id": 14, "source": 13, "target": 21, "type": "DDG"}, {"id": 15, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__URLConnection_51a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 41, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 47, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 48, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 53, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 64, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 76, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__URLConnection_51b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 88, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__URLConnection_51b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__URLConnection_51b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 9, 2, 0, 0, 0]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 34, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 39, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 11, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 49, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 53, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 55, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 56, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_51b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 12, "type": "DDG"}, {"id": 1, "source": 9, "target": 13, "type": "DDG"}, {"id": 2, "source": 10, "target": 13, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 13, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 16, "target": 17, "type": "DDG"}, {"id": 8, "source": 17, "target": 18, "type": "DDG"}, {"id": 9, "source": 17, "target": 19, "type": "DDG"}, {"id": 10, "source": 17, "target": 20, "type": "DDG"}, {"id": 11, "source": 16, "target": 21, "type": "DDG"}, {"id": 12, "source": 16, "target": 22, "type": "DDG"}, {"id": 13, "source": 15, "target": 23, "type": "DDG"}, {"id": 14, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink - see how tools report flaws that don't always occur */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (IO.staticReturnsTrueOrFalse()) {\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n    } else {\r\n        /* FIX: Use a hardcoded string */\r\n        data = \"foo\";\r\n    }\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 35, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 49, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 54, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 57, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 60, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 64, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 69, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 70, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 71, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 84, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 96, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 108, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_12", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 5, "type": "DDG"}, {"id": 2, "source": 2, "target": 5, "type": "DDG"}, {"id": 3, "source": 1, "target": 6, "type": "DDG"}, {"id": 4, "source": 2, "target": 6, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 4, "target": 6, "type": "DDG"}, {"id": 7, "source": 6, "target": 7, "type": "DDG"}, {"id": 8, "source": 6, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 9, "target": 10, "type": "DDG"}, {"id": 11, "source": 10, "target": 11, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 10, "target": 13, "type": "DDG"}, {"id": 14, "source": 9, "target": 14, "type": "DDG"}, {"id": 15, "source": 9, "target": 15, "type": "DDG"}, {"id": 16, "source": 8, "target": 16, "type": "DDG"}, {"id": 17, "source": 8, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_16____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["String", "VAR0"], "tokens_order": [20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 13, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 44, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 49, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 52, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 55, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 59, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 64, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 65, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 66, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 77, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 79, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 89, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 91, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 101, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 103, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_16", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 4, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 0, "target": 5, "type": "DDG"}, {"id": 3, "source": 1, "target": 5, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 5, "type": "DDG"}, {"id": 6, "source": 5, "target": 6, "type": "DDG"}, {"id": 7, "source": 5, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 9, "target": 10, "type": "DDG"}, {"id": 11, "source": 9, "target": 11, "type": "DDG"}, {"id": 12, "source": 9, "target": 12, "type": "DDG"}, {"id": 13, "source": 8, "target": 13, "type": "DDG"}, {"id": 14, "source": 8, "target": 14, "type": "DDG"}, {"id": 15, "source": 7, "target": 15, "type": "DDG"}, {"id": 16, "source": 7, "target": 16, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_22a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "mtdSignature": "badSource()", "called_column": "16"}], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__PropertiesFile_22b()).badSource()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 43, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 51, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 54, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 58, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 62, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 64, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 65, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 42, "column": 17, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["Properties", "VAR6", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 15, 4, 7, 71, 1, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [18, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 21, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR6", ".", "load", "(", "VAR7", ")"], "tokens_order": [15, 3, 101, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 49, "column": 21, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR8", "=", "VAR6", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [26, 4, 15, 3, 74, 1, 115, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 60, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 62, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 76, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["VAR8", "=", "null"], "tokens_order": [26, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 78, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_22b", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 23, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 19, "target": 23, "type": "DDG"}, {"id": 1, "source": 22, "target": 23, "type": "DDG"}, {"id": 2, "source": 16, "target": 18, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 16, "target": 19, "type": "DDG"}, {"id": 5, "source": 17, "target": 20, "type": "DDG"}, {"id": 6, "source": 17, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_16____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["String", "VAR0"], "tokens_order": [20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 21, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR1", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [10, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 51, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 52, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 54, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR0", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [5, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 65, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 77, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 90, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 92, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 108, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 113, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 116, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 119, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR0", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 123, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 127, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 128, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 129, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 130, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 141, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 143, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 153, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 155, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 165, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 167, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_16", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 4, "target": 13, "type": "DDG"}, {"id": 1, "source": 0, "target": 13, "type": "DDG"}, {"id": 2, "source": 4, "target": 14, "type": "DDG"}, {"id": 3, "source": 0, "target": 14, "type": "DDG"}, {"id": 4, "source": 12, "target": 14, "type": "DDG"}, {"id": 5, "source": 11, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 14, "target": 16, "type": "DDG"}, {"id": 8, "source": 16, "target": 17, "type": "DDG"}, {"id": 9, "source": 17, "target": 18, "type": "DDG"}, {"id": 10, "source": 18, "target": 19, "type": "DDG"}, {"id": 11, "source": 18, "target": 20, "type": "DDG"}, {"id": 12, "source": 18, "target": 21, "type": "DDG"}, {"id": 13, "source": 17, "target": 22, "type": "DDG"}, {"id": 14, "source": 17, "target": 23, "type": "DDG"}, {"id": 15, "source": 16, "target": 24, "type": "DDG"}, {"id": 16, "source": 16, "target": 25, "type": "DDG"}, {"id": 17, "source": 1, "target": 2, "type": "DDG"}, {"id": 18, "source": 2, "target": 3, "type": "DDG"}, {"id": 19, "source": 3, "target": 4, "type": "DDG"}, {"id": 20, "source": 3, "target": 5, "type": "DDG"}, {"id": 21, "source": 3, "target": 6, "type": "DDG"}, {"id": 22, "source": 2, "target": 7, "type": "DDG"}, {"id": 23, "source": 2, "target": 8, "type": "DDG"}, {"id": 24, "source": 1, "target": 9, "type": "DDG"}, {"id": 25, "source": 1, "target": 10, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_52a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_52b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_52b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_52b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_52a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 2]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__database_52c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_52b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_52c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_52c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_52c()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_52b", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR4", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 11, 2]}, {"id": 13, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0], "bad_sink": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_52c", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": "-1", "source": 12, "target": 13, "type": "func_call_out"}, {"id": 0, "source": 13, "target": 16, "type": "DDG"}, {"id": 1, "source": 13, "target": 17, "type": "DDG"}, {"id": 2, "source": 14, "target": 17, "type": "DDG"}, {"id": 3, "source": 15, "target": 17, "type": "DDG"}, {"id": 4, "source": 17, "target": 18, "type": "DDG"}, {"id": 5, "source": 17, "target": 19, "type": "DDG"}, {"id": 6, "source": 19, "target": 20, "type": "DDG"}, {"id": 7, "source": 20, "target": 21, "type": "DDG"}, {"id": 8, "source": 21, "target": 22, "type": "DDG"}, {"id": 9, "source": 21, "target": 23, "type": "DDG"}, {"id": 10, "source": 21, "target": 24, "type": "DDG"}, {"id": 11, "source": 20, "target": 25, "type": "DDG"}, {"id": 12, "source": 20, "target": 26, "type": "DDG"}, {"id": 13, "source": 19, "target": 27, "type": "DDG"}, {"id": 14, "source": 19, "target": 28, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_01____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 109, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 114, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 117, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 120, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 124, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 128, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 129, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 130, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 131, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 142, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 144, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 154, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 156, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 166, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 168, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_01", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 12, "type": "DDG"}, {"id": 10, "source": 3, "target": 13, "type": "DDG"}, {"id": 11, "source": 10, "target": 13, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": 15, "source": 15, "target": 16, "type": "DDG"}, {"id": 16, "source": 16, "target": 17, "type": "DDG"}, {"id": 17, "source": 17, "target": 18, "type": "DDG"}, {"id": 18, "source": 17, "target": 19, "type": "DDG"}, {"id": 19, "source": 17, "target": 20, "type": "DDG"}, {"id": 20, "source": 16, "target": 21, "type": "DDG"}, {"id": 21, "source": 16, "target": 22, "type": "DDG"}, {"id": 22, "source": 15, "target": 23, "type": "DDG"}, {"id": 23, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_12____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 48, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 58, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 60, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 70, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 72, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 87, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR3", "=", "\"foo\""], "tokens_order": [9, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 95, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 100, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 103, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 106, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 110, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 114, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 115, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 116, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 117, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 128, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 130, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 140, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 142, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 152, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 154, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 2, "target": 10, "type": "DDG"}, {"id": 1, "source": 7, "target": 10, "type": "DDG"}, {"id": 2, "source": 2, "target": 11, "type": "DDG"}, {"id": 3, "source": 7, "target": 11, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 8, "target": 11, "type": "DDG"}, {"id": 6, "source": 11, "target": 12, "type": "DDG"}, {"id": 7, "source": 11, "target": 13, "type": "DDG"}, {"id": 8, "source": 13, "target": 14, "type": "DDG"}, {"id": 9, "source": 14, "target": 15, "type": "DDG"}, {"id": 10, "source": 15, "target": 16, "type": "DDG"}, {"id": 11, "source": 15, "target": 17, "type": "DDG"}, {"id": 12, "source": 15, "target": 18, "type": "DDG"}, {"id": 13, "source": 14, "target": 19, "type": "DDG"}, {"id": 14, "source": 14, "target": 20, "type": "DDG"}, {"id": 15, "source": 13, "target": 21, "type": "DDG"}, {"id": 16, "source": 13, "target": 22, "type": "DDG"}, {"id": 17, "source": 0, "target": 1, "type": "DDG"}, {"id": 18, "source": 1, "target": 2, "type": "DDG"}, {"id": 19, "source": 1, "target": 3, "type": "DDG"}, {"id": 20, "source": 1, "target": 4, "type": "DDG"}, {"id": 21, "source": 0, "target": 5, "type": "DDG"}, {"id": 22, "source": 0, "target": 6, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a____goodG2B2", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 211, "column": 5, "tokens": ["private", "void", "goodG2B2", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B2() - use goodsource and badsink by reversing the blocks in the if in the sink function */\r\nprivate void goodG2B2(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    CWE23_Relative_Path_Traversal__getCookies_Servlet_22a.goodG2B2PublicStatic = true;\r\n    data = (new CWE23_Relative_Path_Traversal__getCookies_Servlet_22b()).goodG2B2Source(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "mtdSignature": "goodG2B2Source(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "16"}], "varibles": ["request", "data", "response"], "line": 216, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "(", ")", ")", ".", "goodG2B2Source", "(", "request", ",", "response", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__getCookies_Servlet_22b()).goodG2B2Source(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [6, 4, 1, 7, 27, 1, 2, 2, 3, 25, 1, 5, 8, 10, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 222, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 227, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 230, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 233, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 237, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 241, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 242, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 243, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 244, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 255, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 257, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 267, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 269, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 279, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 281, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 83, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR8", "=", "\"foo\""], "tokens_order": [26, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 89, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR8", "=", "null"], "tokens_order": [26, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 92, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 3, "target": 5, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 19, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 19, "type": "DDG"}, {"id": 1, "source": 18, "target": 19, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String dataCopy;\r\n    {\r\n        String data;\r\n        data = \"\";\r\n        /* initialize data in case there are no cookies */\r\n        /* Read data from cookies */\r\n        {\r\n            Cookie[] cookieSources = request.getCookies();\r\n            if (cookieSources != null) {\r\n                /* POTENTIAL FLAW: Read data from the first cookie value */\r\n                data = cookieSources[0].getValue();\r\n            }\r\n        }\r\n        dataCopy = data;\r\n    }\r\n    {\r\n        String data = dataCopy;\r\n        String root;\r\n        if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n            /* running on Windows */\r\n            root = \"C:\\\\uploads\\\\\";\r\n        } else {\r\n            /* running on non-Windows */\r\n            root = \"/home/user/uploads/\";\r\n        }\r\n        if (data != null) {\r\n            /* POTENTIAL FLAW: no validation of concatenated value */\r\n            File file = new File(root + data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 13, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 40, "column": 17, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 41, "column": 21, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 44, "column": 21, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0], "bad_source": true}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "dataCopy"], "line": 48, "column": 13, "tokens": ["dataCopy", "=", "data"], "code": "dataCopy = data", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR4", "=", "VAR2"], "tokens_order": [11, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataCopy", "data"], "line": 51, "column": 13, "tokens": ["String", "data", "=", "dataCopy"], "code": "String data = dataCopy", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["String", "VAR2", "=", "VAR4"], "tokens_order": [20, 6, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 57, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 62, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 65, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 68, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR2", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 72, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 76, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 77, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 78, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 79, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 90, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 92, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 102, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 104, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 114, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 116, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_31", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 4, "target": 5, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 9, "type": "DDG"}, {"id": 7, "source": 6, "target": 10, "type": "DDG"}, {"id": 8, "source": 7, "target": 10, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 10, "target": 12, "type": "DDG"}, {"id": 12, "source": 12, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 14, "target": 15, "type": "DDG"}, {"id": 15, "source": 14, "target": 16, "type": "DDG"}, {"id": 16, "source": 14, "target": 17, "type": "DDG"}, {"id": 17, "source": 13, "target": 18, "type": "DDG"}, {"id": 18, "source": 13, "target": 19, "type": "DDG"}, {"id": 19, "source": 12, "target": 20, "type": "DDG"}, {"id": 20, "source": 12, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_12____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 21, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 21, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 92, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 94, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 104, "column": 29, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 106, "column": 29, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 120, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "=", "\"foo\""], "tokens_order": [11, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 128, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 133, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 136, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 139, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 11, 2, 0, 0, 0], "bad_sink": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 143, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 147, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 148, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 149, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 150, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 161, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 163, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 173, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 175, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 185, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 187, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 4, "target": 16, "type": "DDG"}, {"id": 1, "source": 13, "target": 16, "type": "DDG"}, {"id": 2, "source": 4, "target": 17, "type": "DDG"}, {"id": 3, "source": 13, "target": 17, "type": "DDG"}, {"id": 4, "source": 15, "target": 17, "type": "DDG"}, {"id": 5, "source": 14, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 17, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 20, "target": 21, "type": "DDG"}, {"id": 10, "source": 21, "target": 22, "type": "DDG"}, {"id": 11, "source": 21, "target": 23, "type": "DDG"}, {"id": 12, "source": 21, "target": 24, "type": "DDG"}, {"id": 13, "source": 20, "target": 25, "type": "DDG"}, {"id": 14, "source": 20, "target": 26, "type": "DDG"}, {"id": 15, "source": 19, "target": 27, "type": "DDG"}, {"id": 16, "source": 19, "target": 28, "type": "DDG"}, {"id": 17, "source": 0, "target": 1, "type": "DDG"}, {"id": 18, "source": 1, "target": 2, "type": "DDG"}, {"id": 19, "source": 2, "target": 3, "type": "DDG"}, {"id": 20, "source": 3, "target": 4, "type": "DDG"}, {"id": 21, "source": 3, "target": 5, "type": "DDG"}, {"id": 22, "source": 3, "target": 6, "type": "DDG"}, {"id": 23, "source": 2, "target": 7, "type": "DDG"}, {"id": 24, "source": 2, "target": 8, "type": "DDG"}, {"id": 25, "source": 1, "target": 9, "type": "DDG"}, {"id": 26, "source": 1, "target": 10, "type": "DDG"}, {"id": 27, "source": 0, "target": 11, "type": "DDG"}, {"id": 28, "source": 0, "target": 12, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_16____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["String", "VAR0"], "tokens_order": [20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 46, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR2", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 6, 3, 87, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 47, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [9, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 49, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR0", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [5, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 59, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 61, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 71, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 73, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 90, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 95, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 98, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 101, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR0", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 5, 2, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 105, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 109, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 110, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 111, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 112, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 123, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 125, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 135, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 137, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 147, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 149, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_16", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 10, "type": "DDG"}, {"id": 1, "source": 0, "target": 10, "type": "DDG"}, {"id": 2, "source": 3, "target": 11, "type": "DDG"}, {"id": 3, "source": 0, "target": 11, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 8, "target": 11, "type": "DDG"}, {"id": 6, "source": 11, "target": 12, "type": "DDG"}, {"id": 7, "source": 11, "target": 13, "type": "DDG"}, {"id": 8, "source": 13, "target": 14, "type": "DDG"}, {"id": 9, "source": 14, "target": 15, "type": "DDG"}, {"id": 10, "source": 15, "target": 16, "type": "DDG"}, {"id": 11, "source": 15, "target": 17, "type": "DDG"}, {"id": 12, "source": 15, "target": 18, "type": "DDG"}, {"id": 13, "source": 14, "target": 19, "type": "DDG"}, {"id": 14, "source": 14, "target": 20, "type": "DDG"}, {"id": 15, "source": 13, "target": 21, "type": "DDG"}, {"id": 16, "source": 13, "target": 22, "type": "DDG"}, {"id": 17, "source": 1, "target": 2, "type": "DDG"}, {"id": 18, "source": 2, "target": 3, "type": "DDG"}, {"id": 19, "source": 2, "target": 4, "type": "DDG"}, {"id": 20, "source": 2, "target": 5, "type": "DDG"}, {"id": 21, "source": 1, "target": 6, "type": "DDG"}, {"id": 22, "source": 1, "target": 7, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_02____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 13, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR0", "=", "null"], "tokens_order": [5, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 53, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 56, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 59, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 63, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 67, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 69, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 70, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 81, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 83, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 93, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 95, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 105, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 107, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_02", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 4, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 2, "target": 5, "type": "DDG"}, {"id": 6, "source": 5, "target": 6, "type": "DDG"}, {"id": 7, "source": 5, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 9, "target": 10, "type": "DDG"}, {"id": 11, "source": 9, "target": 11, "type": "DDG"}, {"id": 12, "source": 9, "target": 12, "type": "DDG"}, {"id": 13, "source": 8, "target": 13, "type": "DDG"}, {"id": 14, "source": 8, "target": 14, "type": "DDG"}, {"id": 15, "source": 7, "target": 15, "type": "DDG"}, {"id": 16, "source": 7, "target": 16, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__File_74a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 41, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 49, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 50, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 91, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 93, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 103, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR5", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 14, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 104, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR5", ".", "put", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 105, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR5", ".", "put", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 106, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["VAR5", ".", "put", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__File_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 107, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__File_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE23_Relative_Path_Traversal__File_74b()).badSink(dataHashMap)", "java_file": "CWE23_Relative_Path_Traversal__File_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 15, 2, 22, 23, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "get", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 12, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": 13, "source": 11, "target": 13, "type": "DDG"}, {"id": 14, "source": 4, "target": 14, "type": "DDG"}, {"id": 15, "source": 11, "target": 14, "type": "DDG"}, {"id": 16, "source": 11, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 20, "type": "DDG"}, {"id": 2, "source": 17, "target": 21, "type": "DDG"}, {"id": 3, "source": 19, "target": 21, "type": "DDG"}, {"id": 4, "source": 18, "target": 21, "type": "DDG"}, {"id": 5, "source": 21, "target": 22, "type": "DDG"}, {"id": 6, "source": 21, "target": 23, "type": "DDG"}, {"id": 7, "source": 23, "target": 24, "type": "DDG"}, {"id": 8, "source": 24, "target": 25, "type": "DDG"}, {"id": 9, "source": 25, "target": 26, "type": "DDG"}, {"id": 10, "source": 25, "target": 27, "type": "DDG"}, {"id": 11, "source": 25, "target": 28, "type": "DDG"}, {"id": 12, "source": 24, "target": 29, "type": "DDG"}, {"id": 13, "source": 24, "target": 30, "type": "DDG"}, {"id": 14, "source": 23, "target": 31, "type": "DDG"}, {"id": 15, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_72a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 125, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR1", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 10, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 126, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["VAR1", ".", "add", "(", "0", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 33, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 127, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["VAR1", ".", "add", "(", "1", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 37, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 128, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["VAR1", ".", "add", "(", "2", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 35, 8, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "mtdSignature": "goodG2BSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 129, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__connect_tcp_72b", "(", ")", ")", ".", "goodG2BSink", "(", "dataVector", ")"], "code": "(new CWE23_Relative_Path_Traversal__connect_tcp_72b()).goodG2BSink(dataVector)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2, 0, 0, 0]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 110, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 6, 2, 22, 23, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 112, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "remove", "(", "2", ")"], "tokens_order": [20, 9, 4, 6, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 118, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 123, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 126, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 129, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 133, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 138, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 139, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 140, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 151, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 153, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 163, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 165, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 175, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 177, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_72b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 4, "type": "DDG"}, {"id": 6, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 10, "type": "DDG"}, {"id": 2, "source": 7, "target": 11, "type": "DDG"}, {"id": 3, "source": 9, "target": 11, "type": "DDG"}, {"id": 4, "source": 8, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 11, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 15, "target": 16, "type": "DDG"}, {"id": 10, "source": 15, "target": 17, "type": "DDG"}, {"id": 11, "source": 15, "target": 18, "type": "DDG"}, {"id": 12, "source": 14, "target": 19, "type": "DDG"}, {"id": 13, "source": 14, "target": 20, "type": "DDG"}, {"id": 14, "source": 13, "target": 21, "type": "DDG"}, {"id": 15, "source": 13, "target": 22, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 55, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 57, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__Environment_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 58, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__Environment_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Environment_67b", "mtdSignature": "goodG2BSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__Environment_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 59, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__Environment_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__Environment_67b()).goodG2BSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__Environment_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE23_Relative_Path_Traversal__Environment_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE23_Relative_Path_Traversal__Environment_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__Environment_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 8, "type": "DDG"}, {"id": 2, "source": 5, "target": 9, "type": "DDG"}, {"id": 3, "source": 6, "target": 9, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 9, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 13, "target": 14, "type": "DDG"}, {"id": 10, "source": 13, "target": 15, "type": "DDG"}, {"id": 11, "source": 13, "target": 16, "type": "DDG"}, {"id": 12, "source": 12, "target": 17, "type": "DDG"}, {"id": 13, "source": 12, "target": 18, "type": "DDG"}, {"id": 14, "source": 11, "target": 19, "type": "DDG"}, {"id": 15, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_74a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 125, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR1", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 10, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 126, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", ".", "put", "(", "0", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 33, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 127, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", ".", "put", "(", "1", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 37, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 128, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", ".", "put", "(", "2", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 35, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "mtdSignature": "goodG2BSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 129, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__connect_tcp_74b", "(", ")", ")", ".", "goodG2BSink", "(", "dataHashMap", ")"], "code": "(new CWE23_Relative_Path_Traversal__connect_tcp_74b()).goodG2BSink(dataHashMap)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 110, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 6, 2, 22, 23, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 112, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "get", "(", "2", ")"], "tokens_order": [20, 9, 4, 6, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 118, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 123, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 126, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 129, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 133, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 138, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 139, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 140, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 151, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 153, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 163, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 165, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 175, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 177, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 4, "type": "DDG"}, {"id": 6, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 10, "type": "DDG"}, {"id": 2, "source": 7, "target": 11, "type": "DDG"}, {"id": 3, "source": 8, "target": 11, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 11, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 15, "target": 16, "type": "DDG"}, {"id": 10, "source": 15, "target": 17, "type": "DDG"}, {"id": 11, "source": 15, "target": 18, "type": "DDG"}, {"id": 12, "source": 14, "target": 19, "type": "DDG"}, {"id": 13, "source": 14, "target": 20, "type": "DDG"}, {"id": 14, "source": 13, "target": 21, "type": "DDG"}, {"id": 15, "source": 13, "target": 22, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_21____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_21", "mtdSignature": "bad_source()", "called_column": "16"}], "varibles": ["data"], "line": 43, "column": 9, "tokens": ["data", "=", "bad_source", "(", ")"], "code": "data = bad_source()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR0", "=", "FUN0", "(", ")"], "tokens_order": [5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 49, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 54, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 57, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 60, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 64, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 69, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 70, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 71, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 84, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 96, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 108, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 137, "column": 21, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [15, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 138, "column": 21, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", "=", "VAR6", ".", "accept", "(", ")"], "tokens_order": [18, 4, 15, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 140, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 3, 58, 1, 2, 8, 42, 2]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 141, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 143, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR10", "=", "VAR9", ".", "readLine", "(", ")"], "tokens_order": [36, 4, 31, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 154, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 156, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 166, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 168, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 179, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 181, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 191, "column": 29, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 193, "column": 29, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 207, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR10", "=", "null"], "tokens_order": [36, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 210, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_21", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 30, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 20, "target": 30, "type": "DDG"}, {"id": 1, "source": 29, "target": 30, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 18, "target": 19, "type": "DDG"}, {"id": 5, "source": 19, "target": 20, "type": "DDG"}, {"id": 6, "source": 19, "target": 21, "type": "DDG"}, {"id": 7, "source": 19, "target": 22, "type": "DDG"}, {"id": 8, "source": 18, "target": 23, "type": "DDG"}, {"id": 9, "source": 18, "target": 24, "type": "DDG"}, {"id": 10, "source": 17, "target": 25, "type": "DDG"}, {"id": 11, "source": 17, "target": 26, "type": "DDG"}, {"id": 12, "source": 16, "target": 27, "type": "DDG"}, {"id": 13, "source": 16, "target": 28, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_54a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_54b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_54b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_54b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_54a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 2]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__database_54c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_54b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_54c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_54c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_54c()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_54b", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR4", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 11, 2]}, {"id": 13, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__database_54d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_54c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_54d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_54d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_54d()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_54c", "new_tokens": ["(", "new", "CLS3", "(", ")", ")", ".", "FUN1", "(", "VAR5", ")"], "tokens_order": [1, 7, 92, 1, 2, 2, 3, 25, 1, 14, 2]}, {"id": 15, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__database_54e()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_54d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 15, 2, 22, 23, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_54e", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_54e", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_54e()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_54d", "new_tokens": ["(", "new", "CLS4", "(", ")", ")", ".", "FUN1", "(", "VAR6", ")"], "tokens_order": [1, 7, 164, 1, 2, 2, 3, 25, 1, 15, 2]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 18, 2, 22, 23, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_54e", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": "-1", "source": 12, "target": 13, "type": "func_call_out"}, {"id": 0, "source": 13, "target": 14, "type": "DDG"}, {"id": "-1", "source": 14, "target": 15, "type": "func_call_out"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": "-1", "source": 16, "target": 17, "type": "func_call_out"}, {"id": 0, "source": 17, "target": 20, "type": "DDG"}, {"id": 1, "source": 17, "target": 21, "type": "DDG"}, {"id": 2, "source": 19, "target": 21, "type": "DDG"}, {"id": 3, "source": 18, "target": 21, "type": "DDG"}, {"id": 4, "source": 21, "target": 22, "type": "DDG"}, {"id": 5, "source": 21, "target": 23, "type": "DDG"}, {"id": 6, "source": 23, "target": 24, "type": "DDG"}, {"id": 7, "source": 24, "target": 25, "type": "DDG"}, {"id": 8, "source": 25, "target": 26, "type": "DDG"}, {"id": 9, "source": 25, "target": 27, "type": "DDG"}, {"id": 10, "source": 25, "target": 28, "type": "DDG"}, {"id": 11, "source": 24, "target": 29, "type": "DDG"}, {"id": 12, "source": 24, "target": 30, "type": "DDG"}, {"id": 13, "source": 23, "target": 31, "type": "DDG"}, {"id": 14, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case id is not in query string */\r\n    /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n    {\r\n        StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n        while (tokenizer.hasMoreTokens()) {\r\n            String token = tokenizer.nextToken();\r\n            /* a token will be like \"id=foo\" */\r\n            if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n            {\r\n                data = token.substring(3);\r\n                /* set data to \"foo\" */\r\n                break;\r\n                /* exit while loop */\r\n            }\r\n        }\r\n    }\r\n    for (int i = 0; i < 1; i++) {\r\n        String root;\r\n        if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n            /* running on Windows */\r\n            root = \"C:\\\\uploads\\\\\";\r\n        } else {\r\n            /* running on non-Windows */\r\n            root = \"/home/user/uploads/\";\r\n        }\r\n        if (data != null) {\r\n            /* POTENTIAL FLAW: no validation of concatenated value */\r\n            File file = new File(root + data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 38, "column": 13, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 39, "column": 20, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 41, "column": 17, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 42, "column": 20, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 44, "column": 21, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 50, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["int", "VAR5", "=", "0"], "tokens_order": [19, 14, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 50, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR5", "<", "1"], "tokens_order": [14, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 50, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR5", "++"], "tokens_order": [14, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 56, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 61, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 63, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 66, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR2", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 6, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 70, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 74, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 75, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 76, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 77, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 88, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 90, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 100, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 102, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 112, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 114, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 9, "target": 8, "type": "DDG"}, {"id": 4, "source": 7, "target": 8, "type": "DDG"}, {"id": 5, "source": 6, "target": 12, "type": "DDG"}, {"id": 6, "source": 1, "target": 12, "type": "DDG"}, {"id": 7, "source": 6, "target": 13, "type": "DDG"}, {"id": 8, "source": 1, "target": 13, "type": "DDG"}, {"id": 9, "source": 10, "target": 13, "type": "DDG"}, {"id": 10, "source": 11, "target": 13, "type": "DDG"}, {"id": 11, "source": 9, "target": 9, "type": "DDG"}, {"id": 12, "source": 7, "target": 9, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": 15, "source": 15, "target": 16, "type": "DDG"}, {"id": 16, "source": 16, "target": 17, "type": "DDG"}, {"id": 17, "source": 17, "target": 18, "type": "DDG"}, {"id": 18, "source": 17, "target": 19, "type": "DDG"}, {"id": 19, "source": 17, "target": 20, "type": "DDG"}, {"id": 20, "source": 16, "target": 21, "type": "DDG"}, {"id": 21, "source": 16, "target": 22, "type": "DDG"}, {"id": 22, "source": 15, "target": 23, "type": "DDG"}, {"id": 23, "source": 15, "target": 24, "type": "DDG"}, {"id": 24, "source": 4, "target": 5, "type": "DDG"}, {"id": 25, "source": 4, "target": 6, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Property_61a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Property_61b", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE23_Relative_Path_Traversal__Property_61b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "String data = (new CWE23_Relative_Path_Traversal__Property_61b()).badSource()", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["String", "VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_61a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE23_Relative_Path_Traversal__Property_61b", "new_tokens": ["VAR6", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [15, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 17, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__Property_61b", "new_tokens": ["return", "VAR6", ";"], "tokens_order": [84, 15, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 17, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_17____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["int", "VAR4", "=", "0"], "tokens_order": [19, 11, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR4", "<", "1"], "tokens_order": [11, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR4", "++"], "tokens_order": [11, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 111, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 116, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 118, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 121, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR3", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 9, 2, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 125, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 129, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 130, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 131, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 132, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 143, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 145, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 155, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 157, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 167, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 169, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 10, "target": 11, "type": "DDG"}, {"id": 10, "source": 12, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 15, "type": "DDG"}, {"id": 12, "source": 3, "target": 16, "type": "DDG"}, {"id": 13, "source": 14, "target": 16, "type": "DDG"}, {"id": 14, "source": 13, "target": 16, "type": "DDG"}, {"id": 15, "source": 10, "target": 12, "type": "DDG"}, {"id": 16, "source": 12, "target": 12, "type": "DDG"}, {"id": 17, "source": 16, "target": 17, "type": "DDG"}, {"id": 18, "source": 16, "target": 18, "type": "DDG"}, {"id": 19, "source": 18, "target": 19, "type": "DDG"}, {"id": 20, "source": 19, "target": 20, "type": "DDG"}, {"id": 21, "source": 20, "target": 21, "type": "DDG"}, {"id": 22, "source": 20, "target": 22, "type": "DDG"}, {"id": 23, "source": 20, "target": 23, "type": "DDG"}, {"id": 24, "source": 19, "target": 24, "type": "DDG"}, {"id": 25, "source": 19, "target": 25, "type": "DDG"}, {"id": 26, "source": 18, "target": 26, "type": "DDG"}, {"id": 27, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__URLConnection_41____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 121, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 127, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 128, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 133, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 144, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 146, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 156, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 158, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__URLConnection_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 168, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["FUN0", "(", "VAR3", ")"], "tokens_order": [16, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 46, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 49, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 52, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 11, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 56, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 60, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 61, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 62, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 63, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 74, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 86, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 98, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 12, "type": "DDG"}, {"id": 1, "source": 9, "target": 13, "type": "DDG"}, {"id": 2, "source": 11, "target": 13, "type": "DDG"}, {"id": 3, "source": 10, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 13, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 16, "target": 17, "type": "DDG"}, {"id": 8, "source": 17, "target": 18, "type": "DDG"}, {"id": 9, "source": 17, "target": 19, "type": "DDG"}, {"id": 10, "source": 17, "target": 20, "type": "DDG"}, {"id": 11, "source": 16, "target": 21, "type": "DDG"}, {"id": 12, "source": 16, "target": 22, "type": "DDG"}, {"id": 13, "source": 15, "target": 23, "type": "DDG"}, {"id": 14, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_81a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 49, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 59, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 61, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 71, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 73, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 84, "column": 9, "tokens": ["CWE23_Relative_Path_Traversal__console_readLine_81_base", "baseObject", "=", "new", "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "(", ")"], "code": "CWE23_Relative_Path_Traversal__console_readLine_81_base baseObject = new CWE23_Relative_Path_Traversal__console_readLine_81_bad()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["CLS0", "VAR4", "=", "new", "VAR", "(", ")"], "tokens_order": [27, 11, 4, 7, 78, 1, 2, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__console_readLine_81_base", "mtdSignature": "action(java.lang.String)", "called_column": "9"}], "varibles": ["data", "baseObject"], "line": 85, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ")"], "code": "baseObject.action(data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81a", "new_tokens": ["VAR4", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [11, 3, 16, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void action(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_81_bad", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 8, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 12, "type": "DDG"}, {"id": 1, "source": 9, "target": 13, "type": "DDG"}, {"id": 2, "source": 10, "target": 13, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 13, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 16, "target": 17, "type": "DDG"}, {"id": 8, "source": 17, "target": 18, "type": "DDG"}, {"id": 9, "source": 17, "target": 19, "type": "DDG"}, {"id": 10, "source": 17, "target": 20, "type": "DDG"}, {"id": 11, "source": 16, "target": 21, "type": "DDG"}, {"id": 12, "source": 16, "target": 22, "type": "DDG"}, {"id": 13, "source": 15, "target": 23, "type": "DDG"}, {"id": 14, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 139, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = goodG2BSource(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "mtdSignature": "goodG2BSource(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "23"}], "varibles": ["request", "data", "response"], "line": 141, "column": 9, "tokens": ["String", "data", "=", "goodG2BSource", "(", "request", ",", "response", ")"], "code": "String data = goodG2BSource(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["String", "VAR2", "=", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [20, 6, 4, 25, 1, 5, 8, 10, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 147, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 152, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 155, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 158, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 162, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 166, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 167, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 168, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 169, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 180, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 182, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 192, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 194, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 204, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 206, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 133, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR8", "=", "\"foo\""], "tokens_order": [26, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 18, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 135, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 2, "target": 5, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 18, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 18, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_17____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["int", "VAR5", "=", "0"], "tokens_order": [19, 14, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR5", "<", "1"], "tokens_order": [14, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR5", "++"], "tokens_order": [14, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 126, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 131, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 133, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 136, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR4", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 11, 2, 0, 0, 0], "bad_sink": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 140, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 144, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 145, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 146, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 147, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 158, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 160, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 170, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 172, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 182, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 184, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 13, "target": 14, "type": "DDG"}, {"id": 13, "source": 15, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 18, "type": "DDG"}, {"id": 15, "source": 4, "target": 19, "type": "DDG"}, {"id": 16, "source": 16, "target": 19, "type": "DDG"}, {"id": 17, "source": 17, "target": 19, "type": "DDG"}, {"id": 18, "source": 13, "target": 15, "type": "DDG"}, {"id": 19, "source": 15, "target": 15, "type": "DDG"}, {"id": 20, "source": 19, "target": 20, "type": "DDG"}, {"id": 21, "source": 19, "target": 21, "type": "DDG"}, {"id": 22, "source": 21, "target": 22, "type": "DDG"}, {"id": 23, "source": 22, "target": 23, "type": "DDG"}, {"id": 24, "source": 23, "target": 24, "type": "DDG"}, {"id": 25, "source": 23, "target": 25, "type": "DDG"}, {"id": 26, "source": 23, "target": 26, "type": "DDG"}, {"id": 27, "source": 22, "target": 27, "type": "DDG"}, {"id": 28, "source": 22, "target": 28, "type": "DDG"}, {"id": 29, "source": 21, "target": 29, "type": "DDG"}, {"id": 30, "source": 21, "target": 30, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    LinkedList<String> dataLinkedList = new LinkedList<String>();\r\n    dataLinkedList.add(0, data);\r\n    dataLinkedList.add(1, data);\r\n    dataLinkedList.add(2, data);\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_73b()).badSink(dataLinkedList, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 36, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 37, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 40, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 44, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR4", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 11, 4, 7, 69, 32, 20, 34, 1, 2, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 45, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR4", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 46, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR4", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 47, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["VAR4", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataLinkedList"], "line": 48, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_73b()).badSink(dataLinkedList, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 11, 8, 5, 8, 10, 2, 0, 0, 0]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["public", "void", "FUN1", "(", "LinkedList", "<", "String", ">", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 69, 32, 20, 34, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["String", "VAR8", "=", "VAR5", ".", "remove", "(", "2", ")"], "tokens_order": [20, 26, 4, 14, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR9", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [31, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR9", "=", "\"/home/user/uploads/\""], "tokens_order": [31, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["File", "VAR10", "=", "new", "File", "(", "VAR9", "+", "VAR8", ")"], "tokens_order": [55, 36, 4, 7, 55, 1, 31, 21, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR10", ".", "exists", "(", ")", "&&", "VAR10", ".", "isFile", "(", ")"], "tokens_order": [36, 3, 194, 1, 2, 76, 36, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR11", "=", "new", "FileInputStream", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 66, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR12", "=", "new", "InputStreamReader", "(", "VAR11", ",", "\"UTF-8\"", ")"], "tokens_order": [52, 4, 7, 46, 1, 44, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR13", "=", "new", "BufferedReader", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 45, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR13", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 60, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_73b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 4, "target": 6, "type": "DDG"}, {"id": 4, "source": 1, "target": 6, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 4, "target": 7, "type": "DDG"}, {"id": 7, "source": 1, "target": 7, "type": "DDG"}, {"id": 8, "source": 5, "target": 7, "type": "DDG"}, {"id": 9, "source": 4, "target": 8, "type": "DDG"}, {"id": 10, "source": 1, "target": 8, "type": "DDG"}, {"id": 11, "source": 5, "target": 8, "type": "DDG"}, {"id": 12, "source": 0, "target": 9, "type": "DDG"}, {"id": 13, "source": 5, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 11, "target": 14, "type": "DDG"}, {"id": 2, "source": 11, "target": 15, "type": "DDG"}, {"id": 3, "source": 12, "target": 15, "type": "DDG"}, {"id": 4, "source": 13, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 15, "target": 17, "type": "DDG"}, {"id": 7, "source": 17, "target": 18, "type": "DDG"}, {"id": 8, "source": 18, "target": 19, "type": "DDG"}, {"id": 9, "source": 19, "target": 20, "type": "DDG"}, {"id": 10, "source": 19, "target": 21, "type": "DDG"}, {"id": 11, "source": 19, "target": 22, "type": "DDG"}, {"id": 12, "source": 18, "target": 23, "type": "DDG"}, {"id": 13, "source": 18, "target": 24, "type": "DDG"}, {"id": 14, "source": 17, "target": 25, "type": "DDG"}, {"id": 15, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Property_74a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["VAR0", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [5, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 35, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR1", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 10, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 36, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["VAR1", ".", "put", "(", "0", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 33, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 37, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["VAR1", ".", "put", "(", "1", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 37, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 38, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["VAR1", ".", "put", "(", "2", ",", "VAR0", ")"], "tokens_order": [10, 3, 64, 1, 35, 8, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Property_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 39, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__Property_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE23_Relative_Path_Traversal__Property_74b()).badSink(dataHashMap)", "java_file": "CWE23_Relative_Path_Traversal__Property_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 6, 2, 22, 23, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "get", "(", "2", ")"], "tokens_order": [20, 9, 4, 6, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_74b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 4, "type": "DDG"}, {"id": 6, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 10, "type": "DDG"}, {"id": 2, "source": 7, "target": 11, "type": "DDG"}, {"id": 3, "source": 9, "target": 11, "type": "DDG"}, {"id": 4, "source": 8, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 11, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 15, "target": 16, "type": "DDG"}, {"id": 10, "source": 15, "target": 17, "type": "DDG"}, {"id": 11, "source": 15, "target": 18, "type": "DDG"}, {"id": 12, "source": 14, "target": 19, "type": "DDG"}, {"id": 13, "source": 14, "target": 20, "type": "DDG"}, {"id": 14, "source": 13, "target": 21, "type": "DDG"}, {"id": 15, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_66a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 102, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["String", "[", "]", "VAR4", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 11, 4, 7, 20, 29, 73, 30, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 103, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["VAR4", "[", "2", "]", "=", "VAR3"], "tokens_order": [11, 29, 35, 30, 4, 9, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_66b", "mtdSignature": "badSink(java.lang.String[])", "called_column": "9"}], "varibles": ["dataArray"], "line": 104, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__database_66b", "(", ")", ")", ".", "badSink", "(", "dataArray", ")"], "code": "(new CWE23_Relative_Path_Traversal__database_66b()).badSink(dataArray)", "java_file": "CWE23_Relative_Path_Traversal__database_66a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR4", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 11, 2]}, {"id": 13, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "dataArray", "[", "]", ")", "throws", "Throwable"], "code": "public void badSink(String[] dataArray) throws Throwable {\r\n    String data = dataArray[2];\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", "[", "]", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 29, 30, 2, 22, 23]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["String", "VAR6", "=", "VAR5", "[", "2", "]"], "tokens_order": [20, 15, 4, 14, 29, 35, 30, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR6", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 15, 2, 0], "bad_sink": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_66b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 10, "target": 11, "type": "DDG"}, {"id": 10, "source": 3, "target": 11, "type": "DDG"}, {"id": 11, "source": 10, "target": 12, "type": "DDG"}, {"id": "-1", "source": 12, "target": 13, "type": "func_call_out"}, {"id": 0, "source": 13, "target": 14, "type": "DDG"}, {"id": 1, "source": 14, "target": 17, "type": "DDG"}, {"id": 2, "source": 14, "target": 18, "type": "DDG"}, {"id": 3, "source": 16, "target": 18, "type": "DDG"}, {"id": 4, "source": 15, "target": 18, "type": "DDG"}, {"id": 5, "source": 18, "target": 19, "type": "DDG"}, {"id": 6, "source": 18, "target": 20, "type": "DDG"}, {"id": 7, "source": 20, "target": 21, "type": "DDG"}, {"id": 8, "source": 21, "target": 22, "type": "DDG"}, {"id": 9, "source": 22, "target": 23, "type": "DDG"}, {"id": 10, "source": 22, "target": 24, "type": "DDG"}, {"id": 11, "source": 22, "target": 25, "type": "DDG"}, {"id": 12, "source": 21, "target": 26, "type": "DDG"}, {"id": 13, "source": 21, "target": 27, "type": "DDG"}, {"id": 14, "source": 20, "target": 28, "type": "DDG"}, {"id": 15, "source": 20, "target": 29, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 52, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_52b()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 57, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 59, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_52b()).goodG2BSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_52c()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR3", ",", "HttpServletRequest", "VAR4", ",", "HttpServletResponse", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 9, 8, 39, 11, 8, 40, 14, 2, 22, 23]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_52c()).goodG2BSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR4", ",", "VAR5", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 8, 11, 8, 14, 2]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 108, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR6", ",", "HttpServletRequest", "VAR7", ",", "HttpServletResponse", "VAR8", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 15, 8, 39, 18, 8, 40, 26, 2, 22, 23]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 115, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR9", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [31, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 120, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR9", "=", "\"/home/user/uploads/\""], "tokens_order": [31, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 126, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["File", "VAR10", "=", "new", "File", "(", "VAR9", "+", "VAR6", ")"], "tokens_order": [55, 36, 4, 7, 55, 1, 31, 21, 15, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 130, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR10", ".", "exists", "(", ")", "&&", "VAR10", ".", "isFile", "(", ")"], "tokens_order": [36, 3, 194, 1, 2, 76, 36, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 134, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR11", "=", "new", "FileInputStream", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 66, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 135, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", "=", "new", "InputStreamReader", "(", "VAR11", ",", "\"UTF-8\"", ")"], "tokens_order": [52, 4, 7, 46, 1, 44, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 136, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", "=", "new", "BufferedReader", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 45, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 137, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["CLS2", ".", "FUN2", "(", "VAR13", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 57, 1, 60, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 148, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 160, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 172, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 8, "type": "DDG"}, {"id": 1, "source": 5, "target": 9, "type": "DDG"}, {"id": 2, "source": 7, "target": 9, "type": "DDG"}, {"id": 3, "source": 6, "target": 9, "type": "DDG"}, {"id": 4, "source": 9, "target": 10, "type": "DDG"}, {"id": 5, "source": 9, "target": 11, "type": "DDG"}, {"id": 6, "source": 11, "target": 12, "type": "DDG"}, {"id": 7, "source": 12, "target": 13, "type": "DDG"}, {"id": 8, "source": 13, "target": 14, "type": "DDG"}, {"id": 9, "source": 13, "target": 15, "type": "DDG"}, {"id": 10, "source": 13, "target": 16, "type": "DDG"}, {"id": 11, "source": 12, "target": 17, "type": "DDG"}, {"id": 12, "source": 12, "target": 18, "type": "DDG"}, {"id": 13, "source": 11, "target": 19, "type": "DDG"}, {"id": 14, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_74a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 105, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR4", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 11, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 106, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "0", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 33, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 107, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "1", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 37, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 108, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "2", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 35, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 109, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__connect_tcp_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE23_Relative_Path_Traversal__connect_tcp_74b()).badSink(dataHashMap)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 14, 2, 22, 23, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "get", "(", "2", ")"], "tokens_order": [20, 15, 4, 14, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR6", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 15, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 12, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 3, "target": 13, "type": "DDG"}, {"id": 14, "source": 10, "target": 13, "type": "DDG"}, {"id": 15, "source": 10, "target": 14, "type": "DDG"}, {"id": "-1", "source": 14, "target": 15, "type": "func_call_out"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": 1, "source": 16, "target": 19, "type": "DDG"}, {"id": 2, "source": 16, "target": 20, "type": "DDG"}, {"id": 3, "source": 17, "target": 20, "type": "DDG"}, {"id": 4, "source": 18, "target": 20, "type": "DDG"}, {"id": 5, "source": 20, "target": 21, "type": "DDG"}, {"id": 6, "source": 20, "target": 22, "type": "DDG"}, {"id": 7, "source": 22, "target": 23, "type": "DDG"}, {"id": 8, "source": 23, "target": 24, "type": "DDG"}, {"id": 9, "source": 24, "target": 25, "type": "DDG"}, {"id": 10, "source": 24, "target": 26, "type": "DDG"}, {"id": 11, "source": 24, "target": 27, "type": "DDG"}, {"id": 12, "source": 23, "target": 28, "type": "DDG"}, {"id": 13, "source": 23, "target": 29, "type": "DDG"}, {"id": 14, "source": 22, "target": 30, "type": "DDG"}, {"id": 15, "source": 22, "target": 31, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    for (int i = 0; i < 1; i++) {\r\n        String root;\r\n        if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n            /* running on Windows */\r\n            root = \"C:\\\\uploads\\\\\";\r\n        } else {\r\n            /* running on non-Windows */\r\n            root = \"/home/user/uploads/\";\r\n        }\r\n        if (data != null) {\r\n            /* POTENTIAL FLAW: no validation of concatenated value */\r\n            File file = new File(root + data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 37, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 38, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 41, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 45, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["int", "VAR4", "=", "0"], "tokens_order": [19, 11, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 45, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR4", "<", "1"], "tokens_order": [11, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 45, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR4", "++"], "tokens_order": [11, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 51, "column": 17, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 56, "column": 17, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 58, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 61, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR2", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 65, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 69, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 70, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 71, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 72, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 83, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 85, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 95, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 97, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 107, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 109, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_17", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 5, "target": 6, "type": "DDG"}, {"id": 4, "source": 7, "target": 6, "type": "DDG"}, {"id": 5, "source": 1, "target": 10, "type": "DDG"}, {"id": 6, "source": 4, "target": 10, "type": "DDG"}, {"id": 7, "source": 1, "target": 11, "type": "DDG"}, {"id": 8, "source": 4, "target": 11, "type": "DDG"}, {"id": 9, "source": 9, "target": 11, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 5, "target": 7, "type": "DDG"}, {"id": 12, "source": 7, "target": 7, "type": "DDG"}, {"id": 13, "source": 11, "target": 12, "type": "DDG"}, {"id": 14, "source": 11, "target": 13, "type": "DDG"}, {"id": 15, "source": 13, "target": 14, "type": "DDG"}, {"id": 16, "source": 14, "target": 15, "type": "DDG"}, {"id": 17, "source": 15, "target": 16, "type": "DDG"}, {"id": 18, "source": 15, "target": 17, "type": "DDG"}, {"id": 19, "source": 15, "target": 18, "type": "DDG"}, {"id": 20, "source": 14, "target": 19, "type": "DDG"}, {"id": 21, "source": 14, "target": 20, "type": "DDG"}, {"id": 22, "source": 13, "target": 21, "type": "DDG"}, {"id": 23, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = (new CWE23_Relative_Path_Traversal__getParameter_Servlet_61b()).badSource(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61b", "mtdSignature": "badSource(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "23"}], "varibles": ["request", "data", "response"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE23_Relative_Path_Traversal__getParameter_Servlet_61b", "(", ")", ")", ".", "badSource", "(", "request", ",", "response", ")"], "code": "String data = (new CWE23_Relative_Path_Traversal__getParameter_Servlet_61b()).badSource(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["String", "VAR2", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [20, 6, 4, 1, 7, 27, 1, 2, 2, 3, 25, 1, 5, 8, 10, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "String", "badSource", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public String badSource(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    return data;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61b", "new_tokens": ["public", "String", "FUN1", "(", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [28, 20, 25, 1, 39, 26, 8, 40, 31, 2, 22, 23, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 32, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61b", "new_tokens": ["VAR10", "=", "VAR8", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [36, 4, 26, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_61b", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 2, "target": 5, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 1, "target": 17, "type": "func_call_out"}, {"id": "-1", "source": 19, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 18, "type": "DDG"}, {"id": 1, "source": 18, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_41____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 112, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Environment_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 114, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["FUN0", "(", "VAR0", ")"], "tokens_order": [16, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 34, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR2", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [6, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 39, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR2", "=", "\"/home/user/uploads/\""], "tokens_order": [6, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", "+", "VAR1", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 21, 10, 2, 0], "bad_sink": true}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 49, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 53, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 55, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 56, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_41", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 5, "type": "DDG"}, {"id": 1, "source": 2, "target": 6, "type": "DDG"}, {"id": 2, "source": 4, "target": 6, "type": "DDG"}, {"id": 3, "source": 3, "target": 6, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 6, "target": 8, "type": "DDG"}, {"id": 6, "source": 8, "target": 9, "type": "DDG"}, {"id": 7, "source": 9, "target": 10, "type": "DDG"}, {"id": 8, "source": 10, "target": 11, "type": "DDG"}, {"id": 9, "source": 10, "target": 12, "type": "DDG"}, {"id": 10, "source": 10, "target": 13, "type": "DDG"}, {"id": 11, "source": 9, "target": 14, "type": "DDG"}, {"id": 12, "source": 9, "target": 15, "type": "DDG"}, {"id": 13, "source": 8, "target": 16, "type": "DDG"}, {"id": 14, "source": 8, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 108, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 114, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 119, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 122, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 125, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 129, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 133, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 134, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 135, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 136, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 147, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 149, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 159, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 161, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 171, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 173, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR6", "=", "CLS0", ".", "FUN2", "(", ")"], "tokens_order": [15, 4, 27, 3, 57, 1, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR7", "=", "VAR6", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [18, 4, 15, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR8", "=", "VAR7", ".", "executeQuery", "(", ")"], "tokens_order": [26, 4, 18, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR9", "=", "VAR8", ".", "getString", "(", "1", ")"], "tokens_order": [31, 4, 26, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__database_42", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 26, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 18, "target": 19, "type": "DDG"}, {"id": 3, "source": 18, "target": 20, "type": "DDG"}, {"id": 4, "source": 18, "target": 21, "type": "DDG"}, {"id": 5, "source": 17, "target": 22, "type": "DDG"}, {"id": 6, "source": 17, "target": 23, "type": "DDG"}, {"id": 7, "source": 16, "target": 24, "type": "DDG"}, {"id": 8, "source": 16, "target": 25, "type": "DDG"}, {"id": 9, "source": 19, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 125, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 131, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 136, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 139, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 142, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 146, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 150, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 151, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 152, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 153, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 164, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 166, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 176, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 178, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 188, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 190, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [15, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", "=", "VAR6", ".", "accept", "(", ")"], "tokens_order": [18, 4, 15, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 55, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 3, 58, 1, 2, 8, 42, 2]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 56, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR10", "=", "VAR9", ".", "readLine", "(", ")"], "tokens_order": [36, 4, 31, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 107, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 109, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_42", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 29, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 18, "target": 19, "type": "DDG"}, {"id": 3, "source": 19, "target": 20, "type": "DDG"}, {"id": 4, "source": 19, "target": 21, "type": "DDG"}, {"id": 5, "source": 19, "target": 22, "type": "DDG"}, {"id": 6, "source": 18, "target": 23, "type": "DDG"}, {"id": 7, "source": 18, "target": 24, "type": "DDG"}, {"id": 8, "source": 17, "target": 25, "type": "DDG"}, {"id": 9, "source": 17, "target": 26, "type": "DDG"}, {"id": 10, "source": 16, "target": 27, "type": "DDG"}, {"id": 11, "source": 16, "target": 28, "type": "DDG"}, {"id": 12, "source": 20, "target": 29, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_12____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 13, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 49, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 54, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 57, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 60, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 64, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 69, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 70, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 71, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 84, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 96, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 108, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_12", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 4, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 0, "target": 5, "type": "DDG"}, {"id": 3, "source": 1, "target": 5, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 5, "type": "DDG"}, {"id": 6, "source": 5, "target": 6, "type": "DDG"}, {"id": 7, "source": 5, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 9, "target": 10, "type": "DDG"}, {"id": 11, "source": 9, "target": 11, "type": "DDG"}, {"id": 12, "source": 9, "target": 12, "type": "DDG"}, {"id": 13, "source": 8, "target": 13, "type": "DDG"}, {"id": 14, "source": 8, "target": 14, "type": "DDG"}, {"id": 15, "source": 7, "target": 15, "type": "DDG"}, {"id": 16, "source": 7, "target": 16, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Environment_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 41, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 47, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 52, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 55, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 58, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 62, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 66, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 67, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 68, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 69, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 80, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 92, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 104, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["VAR6", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [15, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 17, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__Environment_42", "new_tokens": ["return", "VAR6", ";"], "tokens_order": [84, 15, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 17, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_22a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__console_readLine_22b", "mtdSignature": "badSource()", "called_column": "16"}], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__console_readLine_22b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__console_readLine_22b()).badSource()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 43, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 51, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 54, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 58, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 62, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 64, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 65, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR7", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 18, 3, 87, 8, 42, 2, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [26, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 48, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 58, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 60, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 70, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 72, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 87, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["VAR9", "=", "null"], "tokens_order": [31, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 89, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_22b", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 24, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 18, "target": 24, "type": "DDG"}, {"id": 1, "source": 23, "target": 24, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 17, "target": 19, "type": "DDG"}, {"id": 5, "source": 17, "target": 20, "type": "DDG"}, {"id": 6, "source": 16, "target": 21, "type": "DDG"}, {"id": 7, "source": 16, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_67a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 55, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 56, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 60, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 61, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 64, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 75, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 77, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 87, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 89, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 100, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 102, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 112, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 114, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 124, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["Container", "VAR5", "=", "new", "Container", "(", ")"], "tokens_order": [56, 14, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 125, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR5", ".", "containerOne", "=", "VAR4"], "tokens_order": [14, 3, 70, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "mtdSignature": "badSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__listen_tcp_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 126, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__listen_tcp_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__listen_tcp_67b()).badSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE23_Relative_Path_Traversal__listen_tcp_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE23_Relative_Path_Traversal__listen_tcp_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__listen_tcp_67a", ".", "Container", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 15, 2, 22, 23, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "containerOne"], "tokens_order": [20, 18, 4, 15, 3, 70, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 13, "target": 14, "type": "DDG"}, {"id": 13, "source": 4, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 20, "type": "DDG"}, {"id": 2, "source": 17, "target": 21, "type": "DDG"}, {"id": 3, "source": 19, "target": 21, "type": "DDG"}, {"id": 4, "source": 18, "target": 21, "type": "DDG"}, {"id": 5, "source": 21, "target": 22, "type": "DDG"}, {"id": 6, "source": 21, "target": 23, "type": "DDG"}, {"id": 7, "source": 23, "target": 24, "type": "DDG"}, {"id": 8, "source": 24, "target": 25, "type": "DDG"}, {"id": 9, "source": 25, "target": 26, "type": "DDG"}, {"id": 10, "source": 25, "target": 27, "type": "DDG"}, {"id": 11, "source": 25, "target": 28, "type": "DDG"}, {"id": 12, "source": 24, "target": 29, "type": "DDG"}, {"id": 13, "source": 24, "target": 30, "type": "DDG"}, {"id": 14, "source": 23, "target": 31, "type": "DDG"}, {"id": 15, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_51b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 34, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 35, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 38, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 42, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_51b()).badSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 34, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 39, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR4", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 11, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 49, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 53, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 55, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 56, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 9, "type": "DDG"}, {"id": 1, "source": 6, "target": 10, "type": "DDG"}, {"id": 2, "source": 7, "target": 10, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 10, "target": 11, "type": "DDG"}, {"id": 5, "source": 10, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 14, "target": 16, "type": "DDG"}, {"id": 10, "source": 14, "target": 17, "type": "DDG"}, {"id": 11, "source": 13, "target": 18, "type": "DDG"}, {"id": 12, "source": 13, "target": 19, "type": "DDG"}, {"id": 13, "source": 12, "target": 20, "type": "DDG"}, {"id": 14, "source": 12, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    Vector<String> dataVector = new Vector<String>(5);\r\n    dataVector.add(0, data);\r\n    dataVector.add(1, data);\r\n    dataVector.add(2, data);\r\n    (new CWE23_Relative_Path_Traversal__getParameter_Servlet_72b()).badSink(dataVector, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 33, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 35, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR3", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 9, 4, 7, 68, 32, 20, 34, 1, 73, 2, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 36, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 37, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 38, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataVector"], "line": 39, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getParameter_Servlet_72b()).badSink(dataVector, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0, 0]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["public", "void", "FUN1", "(", "Vector", "<", "String", ">", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 68, 32, 20, 34, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 11, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": 6, "source": 2, "target": 5, "type": "DDG"}, {"id": 7, "source": 0, "target": 6, "type": "DDG"}, {"id": 8, "source": 2, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 8, "target": 11, "type": "DDG"}, {"id": 2, "source": 8, "target": 12, "type": "DDG"}, {"id": 3, "source": 9, "target": 12, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 12, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 15, "target": 16, "type": "DDG"}, {"id": 9, "source": 16, "target": 17, "type": "DDG"}, {"id": 10, "source": 16, "target": 18, "type": "DDG"}, {"id": 11, "source": 16, "target": 19, "type": "DDG"}, {"id": 12, "source": 15, "target": 20, "type": "DDG"}, {"id": 13, "source": 15, "target": 21, "type": "DDG"}, {"id": 14, "source": 14, "target": 22, "type": "DDG"}, {"id": 15, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__URLConnection_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 110, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 112, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 113, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__URLConnection_67b", "mtdSignature": "goodG2BSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__URLConnection_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 114, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__URLConnection_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__URLConnection_67b()).goodG2BSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE23_Relative_Path_Traversal__URLConnection_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE23_Relative_Path_Traversal__URLConnection_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__URLConnection_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 8, "type": "DDG"}, {"id": 2, "source": 5, "target": 9, "type": "DDG"}, {"id": 3, "source": 7, "target": 9, "type": "DDG"}, {"id": 4, "source": 6, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 9, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 13, "target": 14, "type": "DDG"}, {"id": 10, "source": 13, "target": 15, "type": "DDG"}, {"id": 11, "source": 13, "target": 16, "type": "DDG"}, {"id": 12, "source": 12, "target": 17, "type": "DDG"}, {"id": 13, "source": 12, "target": 18, "type": "DDG"}, {"id": 14, "source": 11, "target": 19, "type": "DDG"}, {"id": 15, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_72a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 42, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 47, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 48, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 51, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 62, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 64, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 74, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR3", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 9, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 75, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR3", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 76, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR3", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 77, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["VAR3", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 78, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ")"], "code": "(new CWE23_Relative_Path_Traversal__PropertiesFile_72b()).badSink(dataVector)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 9, 2, 0, 0, 0]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 11, 2, 22, 23, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["String", "VAR5", "=", "VAR4", ".", "remove", "(", "2", ")"], "tokens_order": [20, 14, 4, 11, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_72b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 7, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 8, "type": "DDG"}, {"id": 9, "source": 3, "target": 9, "type": "DDG"}, {"id": 10, "source": 6, "target": 9, "type": "DDG"}, {"id": 11, "source": 6, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": 1, "source": 12, "target": 15, "type": "DDG"}, {"id": 2, "source": 12, "target": 16, "type": "DDG"}, {"id": 3, "source": 13, "target": 16, "type": "DDG"}, {"id": 4, "source": 14, "target": 16, "type": "DDG"}, {"id": 5, "source": 16, "target": 17, "type": "DDG"}, {"id": 6, "source": 16, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 20, "target": 21, "type": "DDG"}, {"id": 10, "source": 20, "target": 22, "type": "DDG"}, {"id": 11, "source": 20, "target": 23, "type": "DDG"}, {"id": 12, "source": 19, "target": 24, "type": "DDG"}, {"id": 13, "source": 19, "target": 25, "type": "DDG"}, {"id": 14, "source": 18, "target": 26, "type": "DDG"}, {"id": 15, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_67a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 50, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 54, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 64, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 76, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 89, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["Container", "VAR4", "=", "new", "Container", "(", ")"], "tokens_order": [56, 11, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 90, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR4", ".", "containerOne", "=", "VAR3"], "tokens_order": [11, 3, 70, 4, 9, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__console_readLine_67b", "mtdSignature": "badSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__console_readLine_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 91, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__console_readLine_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__console_readLine_67b()).badSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE23_Relative_Path_Traversal__console_readLine_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE23_Relative_Path_Traversal__console_readLine_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__console_readLine_67a", ".", "Container", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 14, 2, 22, 23]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "containerOne"], "tokens_order": [20, 15, 4, 14, 3, 70, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR6", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 15, 2, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 7, "target": 8, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 11, "target": 14, "type": "DDG"}, {"id": 2, "source": 11, "target": 15, "type": "DDG"}, {"id": 3, "source": 12, "target": 15, "type": "DDG"}, {"id": 4, "source": 13, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 15, "target": 17, "type": "DDG"}, {"id": 7, "source": 17, "target": 18, "type": "DDG"}, {"id": 8, "source": 18, "target": 19, "type": "DDG"}, {"id": 9, "source": 19, "target": 20, "type": "DDG"}, {"id": 10, "source": 19, "target": 21, "type": "DDG"}, {"id": 11, "source": 19, "target": 22, "type": "DDG"}, {"id": 12, "source": 18, "target": 23, "type": "DDG"}, {"id": 13, "source": 18, "target": 24, "type": "DDG"}, {"id": 14, "source": 17, "target": 25, "type": "DDG"}, {"id": 15, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__File_12____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 42, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 49, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 50, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 55, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 90, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 92, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 106, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR4", "=", "\"foo\""], "tokens_order": [11, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 114, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 119, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 122, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 125, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 14, 21, 11, 2, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 129, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR0", ".", "exists", "(", ")", "&&", "VAR0", ".", "isFile", "(", ")"], "tokens_order": [5, 3, 194, 1, 2, 76, 5, 3, 197, 1, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 133, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [15, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 134, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 135, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 136, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 147, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 149, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 159, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 161, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 171, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 173, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 4, "target": 14, "type": "DDG"}, {"id": 1, "source": 11, "target": 14, "type": "DDG"}, {"id": 2, "source": 4, "target": 15, "type": "DDG"}, {"id": 3, "source": 11, "target": 15, "type": "DDG"}, {"id": 4, "source": 13, "target": 15, "type": "DDG"}, {"id": 5, "source": 12, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 15, "target": 17, "type": "DDG"}, {"id": 8, "source": 17, "target": 18, "type": "DDG"}, {"id": 9, "source": 18, "target": 19, "type": "DDG"}, {"id": 10, "source": 19, "target": 20, "type": "DDG"}, {"id": 11, "source": 19, "target": 21, "type": "DDG"}, {"id": 12, "source": 19, "target": 22, "type": "DDG"}, {"id": 13, "source": 18, "target": 23, "type": "DDG"}, {"id": 14, "source": 18, "target": 24, "type": "DDG"}, {"id": 15, "source": 17, "target": 25, "type": "DDG"}, {"id": 16, "source": 17, "target": 26, "type": "DDG"}, {"id": 17, "source": 0, "target": 1, "type": "DDG"}, {"id": 18, "source": 1, "target": 2, "type": "DDG"}, {"id": 19, "source": 2, "target": 3, "type": "DDG"}, {"id": 20, "source": 3, "target": 4, "type": "DDG"}, {"id": 21, "source": 3, "target": 5, "type": "DDG"}, {"id": 22, "source": 3, "target": 6, "type": "DDG"}, {"id": 23, "source": 2, "target": 7, "type": "DDG"}, {"id": 24, "source": 2, "target": 8, "type": "DDG"}, {"id": 25, "source": 1, "target": 9, "type": "DDG"}, {"id": 26, "source": 1, "target": 10, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_52b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 35, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 36, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 39, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 43, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_52b()).badSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_52c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_52c()).badSink(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR5", ",", "VAR6", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 11, 8, 14, 8, 15, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR7", ",", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 18, 8, 39, 26, 8, 40, 31, 2, 22, 23]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR10", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [36, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR10", "=", "\"/home/user/uploads/\""], "tokens_order": [36, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["File", "VAR11", "=", "new", "File", "(", "VAR10", "+", "VAR7", ")"], "tokens_order": [55, 44, 4, 7, 55, 1, 36, 21, 18, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR11", ".", "exists", "(", ")", "&&", "VAR11", ".", "isFile", "(", ")"], "tokens_order": [44, 3, 194, 1, 2, 76, 44, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", "=", "new", "FileInputStream", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 66, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", "=", "new", "InputStreamReader", "(", "VAR12", ",", "\"UTF-8\"", ")"], "tokens_order": [60, 4, 7, 46, 1, 52, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR14", "=", "new", "BufferedReader", "(", "VAR13", ")"], "tokens_order": [77, 4, 7, 45, 1, 60, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["CLS2", ".", "FUN2", "(", "VAR14", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 57, 1, 77, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_52c", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 11, "type": "DDG"}, {"id": 1, "source": 8, "target": 12, "type": "DDG"}, {"id": 2, "source": 9, "target": 12, "type": "DDG"}, {"id": 3, "source": 10, "target": 12, "type": "DDG"}, {"id": 4, "source": 12, "target": 13, "type": "DDG"}, {"id": 5, "source": 12, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 16, "target": 17, "type": "DDG"}, {"id": 9, "source": 16, "target": 18, "type": "DDG"}, {"id": 10, "source": 16, "target": 19, "type": "DDG"}, {"id": 11, "source": 15, "target": 20, "type": "DDG"}, {"id": 12, "source": 15, "target": 21, "type": "DDG"}, {"id": 13, "source": 14, "target": 22, "type": "DDG"}, {"id": 14, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__URLConnection_12____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 43, "column": 17, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 48, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 49, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 53, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 64, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 76, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 92, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR3", "=", "\"foo\""], "tokens_order": [9, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 100, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 105, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 108, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 111, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 115, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 119, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 120, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 121, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 122, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 133, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 135, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 145, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 147, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 157, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 159, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 11, "type": "DDG"}, {"id": 1, "source": 8, "target": 11, "type": "DDG"}, {"id": 2, "source": 3, "target": 12, "type": "DDG"}, {"id": 3, "source": 8, "target": 12, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 9, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 12, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 15, "target": 16, "type": "DDG"}, {"id": 10, "source": 16, "target": 17, "type": "DDG"}, {"id": 11, "source": 16, "target": 18, "type": "DDG"}, {"id": 12, "source": 16, "target": 19, "type": "DDG"}, {"id": 13, "source": 15, "target": 20, "type": "DDG"}, {"id": 14, "source": 15, "target": 21, "type": "DDG"}, {"id": 15, "source": 14, "target": 22, "type": "DDG"}, {"id": 16, "source": 14, "target": 23, "type": "DDG"}, {"id": 17, "source": 0, "target": 1, "type": "DDG"}, {"id": 18, "source": 1, "target": 2, "type": "DDG"}, {"id": 19, "source": 2, "target": 3, "type": "DDG"}, {"id": 20, "source": 2, "target": 4, "type": "DDG"}, {"id": 21, "source": 2, "target": 5, "type": "DDG"}, {"id": 22, "source": 1, "target": 6, "type": "DDG"}, {"id": 23, "source": 1, "target": 7, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_53a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 41, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 50, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 61, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 63, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_53b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 73, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_53b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__PropertiesFile_53b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR2", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 6, 2]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__PropertiesFile_53c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR3", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 9, 2, 22, 23, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_53c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_53c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__PropertiesFile_53c()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 9, 2]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE23_Relative_Path_Traversal__PropertiesFile_53d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__PropertiesFile_53d()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["CLS3", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_53d", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 14, "type": "DDG"}, {"id": 1, "source": 11, "target": 15, "type": "DDG"}, {"id": 2, "source": 13, "target": 15, "type": "DDG"}, {"id": 3, "source": 12, "target": 15, "type": "DDG"}, {"id": 4, "source": 15, "target": 16, "type": "DDG"}, {"id": 5, "source": 15, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 19, "target": 21, "type": "DDG"}, {"id": 10, "source": 19, "target": 22, "type": "DDG"}, {"id": 11, "source": 18, "target": 23, "type": "DDG"}, {"id": 12, "source": 18, "target": 24, "type": "DDG"}, {"id": 13, "source": 17, "target": 25, "type": "DDG"}, {"id": 14, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 64, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    Container dataContainer = new Container();\r\n    dataContainer.containerOne = data;\r\n    (new CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b()).goodG2BSink(dataContainer, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 69, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 71, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", "new_tokens": ["Container", "VAR3", "=", "new", "Container", "(", ")"], "tokens_order": [56, 9, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 72, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", "new_tokens": ["VAR3", ".", "containerOne", "=", "VAR2"], "tokens_order": [9, 3, 70, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "mtdSignature": "goodG2BSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a.Container, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataContainer", "request", "response"], "line": 73, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b()).goodG2BSink(dataContainer, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer", "request", "response"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", ".", "Container", "dataContainer", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a.Container dataContainer, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["public", "void", "FUN1", "(", "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67a", ".", "Container", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 0, 3, 56, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "containerOne"], "tokens_order": [20, 18, 4, 11, 3, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getQueryString_Servlet_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": 1, "source": 1, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": 1, "source": 6, "target": 9, "type": "DDG"}, {"id": 2, "source": 6, "target": 10, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 7, "target": 10, "type": "DDG"}, {"id": 5, "source": 10, "target": 11, "type": "DDG"}, {"id": 6, "source": 10, "target": 12, "type": "DDG"}, {"id": 7, "source": 12, "target": 13, "type": "DDG"}, {"id": 8, "source": 13, "target": 14, "type": "DDG"}, {"id": 9, "source": 14, "target": 15, "type": "DDG"}, {"id": 10, "source": 14, "target": 16, "type": "DDG"}, {"id": 11, "source": 14, "target": 17, "type": "DDG"}, {"id": 12, "source": 13, "target": 18, "type": "DDG"}, {"id": 13, "source": 13, "target": 19, "type": "DDG"}, {"id": 14, "source": 12, "target": 20, "type": "DDG"}, {"id": 15, "source": 12, "target": 21, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_12____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 42, "column": 17, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 21, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 49, "column": 21, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 60, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 62, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 76, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 84, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 89, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 92, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 95, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 99, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 103, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 104, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 105, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 106, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 117, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 119, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 129, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 131, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 141, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 143, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 9, "type": "DDG"}, {"id": 1, "source": 6, "target": 9, "type": "DDG"}, {"id": 2, "source": 3, "target": 10, "type": "DDG"}, {"id": 3, "source": 6, "target": 10, "type": "DDG"}, {"id": 4, "source": 8, "target": 10, "type": "DDG"}, {"id": 5, "source": 7, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 10, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 13, "target": 14, "type": "DDG"}, {"id": 10, "source": 14, "target": 15, "type": "DDG"}, {"id": 11, "source": 14, "target": 16, "type": "DDG"}, {"id": 12, "source": 14, "target": 17, "type": "DDG"}, {"id": 13, "source": 13, "target": 18, "type": "DDG"}, {"id": 14, "source": 13, "target": 19, "type": "DDG"}, {"id": 15, "source": 12, "target": 20, "type": "DDG"}, {"id": 16, "source": 12, "target": 21, "type": "DDG"}, {"id": 17, "source": 0, "target": 2, "type": "DDG"}, {"id": 18, "source": 1, "target": 2, "type": "DDG"}, {"id": 19, "source": 0, "target": 3, "type": "DDG"}, {"id": 20, "source": 1, "target": 4, "type": "DDG"}, {"id": 21, "source": 1, "target": 5, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    Container dataContainer = new Container();\r\n    dataContainer.containerOne = data;\r\n    (new CWE23_Relative_Path_Traversal__getCookies_Servlet_67b()).badSink(dataContainer, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 40, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 41, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 44, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 48, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["Container", "VAR4", "=", "new", "Container", "(", ")"], "tokens_order": [56, 11, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 49, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR4", ".", "containerOne", "=", "VAR2"], "tokens_order": [11, 3, 70, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "mtdSignature": "badSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__getCookies_Servlet_67a.Container, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataContainer", "request", "response"], "line": 50, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getCookies_Servlet_67b()).badSink(dataContainer, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 11, 8, 5, 8, 10, 2, 0, 0]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", ".", "Container", "dataContainer", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(CWE23_Relative_Path_Traversal__getCookies_Servlet_67a.Container dataContainer, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["public", "void", "FUN1", "(", "CWE23_Relative_Path_Traversal__getCookies_Servlet_67a", ".", "Container", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 0, 3, 56, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["String", "VAR8", "=", "VAR5", ".", "containerOne"], "tokens_order": [20, 26, 4, 14, 3, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR9", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [31, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR9", "=", "\"/home/user/uploads/\""], "tokens_order": [31, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["File", "VAR10", "=", "new", "File", "(", "VAR9", "+", "VAR8", ")"], "tokens_order": [55, 36, 4, 7, 55, 1, 31, 21, 26, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR10", ".", "exists", "(", ")", "&&", "VAR10", ".", "isFile", "(", ")"], "tokens_order": [36, 3, 194, 1, 2, 76, 36, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", "=", "new", "FileInputStream", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 66, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", "=", "new", "InputStreamReader", "(", "VAR11", ",", "\"UTF-8\"", ")"], "tokens_order": [52, 4, 7, 46, 1, 44, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR13", "=", "new", "BufferedReader", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 45, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR13", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 60, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 5, "target": 6, "type": "DDG"}, {"id": 4, "source": 4, "target": 6, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": 1, "source": 9, "target": 12, "type": "DDG"}, {"id": 2, "source": 9, "target": 13, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 10, "target": 13, "type": "DDG"}, {"id": 5, "source": 13, "target": 14, "type": "DDG"}, {"id": 6, "source": 13, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 16, "target": 17, "type": "DDG"}, {"id": 9, "source": 17, "target": 18, "type": "DDG"}, {"id": 10, "source": 17, "target": 19, "type": "DDG"}, {"id": 11, "source": 17, "target": 20, "type": "DDG"}, {"id": 12, "source": 16, "target": 21, "type": "DDG"}, {"id": 13, "source": 16, "target": 22, "type": "DDG"}, {"id": 14, "source": 15, "target": 23, "type": "DDG"}, {"id": 15, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    CWE23_Relative_Path_Traversal__getCookies_Servlet_22a.badPublicStatic = true;\r\n    data = (new CWE23_Relative_Path_Traversal__getCookies_Servlet_22b()).badSource(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "mtdSignature": "badSource(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "16"}], "varibles": ["request", "data", "response"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "(", ")", ")", ".", "badSource", "(", "request", ",", "response", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__getCookies_Servlet_22b()).badSource(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [6, 4, 1, 7, 27, 1, 2, 2, 3, 25, 1, 5, 8, 10, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 43, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 51, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 54, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 58, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 62, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 64, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 65, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "String", "badSource", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public String badSource(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (CWE23_Relative_Path_Traversal__getCookies_Servlet_22a.badPublicStatic) {\r\n        data = \"\";\r\n        /* initialize data in case there are no cookies */\r\n        /* Read data from cookies */\r\n        {\r\n            Cookie[] cookieSources = request.getCookies();\r\n            if (cookieSources != null) {\r\n                /* POTENTIAL FLAW: Read data from the first cookie value */\r\n                data = cookieSources[0].getValue();\r\n            }\r\n        }\r\n    } else {\r\n        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run\r\n             * but ensure data is inititialized before the Sink to avoid compiler errors */\r\n        data = null;\r\n    }\r\n    return data;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["public", "String", "FUN1", "(", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [28, 20, 25, 1, 39, 26, 8, 40, 31, 2, 22, 23, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR10", "=", "\"\""], "tokens_order": [36, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 36, "column": 17, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["Cookie", "VAR11", "[", "]", "=", "VAR8", ".", "getCookies", "(", ")"], "tokens_order": [88, 44, 29, 30, 4, 26, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 37, "column": 21, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 40, "column": 21, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR10", "=", "VAR11", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [36, 4, 44, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 48, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR10", "=", "null"], "tokens_order": [36, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 50, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 2, "target": 5, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 1, "target": 17, "type": "func_call_out"}, {"id": "-1", "source": 23, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 22, "target": 23, "type": "DDG"}, {"id": 1, "source": 18, "target": 23, "type": "DDG"}, {"id": 2, "source": 21, "target": 23, "type": "DDG"}, {"id": 3, "source": 17, "target": 19, "type": "DDG"}, {"id": 4, "source": 19, "target": 20, "type": "DDG"}, {"id": 5, "source": 19, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Property_41____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 112, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR0", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [5, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Property_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 114, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["FUN0", "(", "VAR0", ")"], "tokens_order": [16, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 34, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR2", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [6, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 39, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR2", "=", "\"/home/user/uploads/\""], "tokens_order": [6, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", "+", "VAR1", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 21, 10, 2, 0], "bad_sink": true}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 49, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 53, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 55, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 56, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_41", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 5, "type": "DDG"}, {"id": 1, "source": 2, "target": 6, "type": "DDG"}, {"id": 2, "source": 4, "target": 6, "type": "DDG"}, {"id": 3, "source": 3, "target": 6, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 6, "target": 8, "type": "DDG"}, {"id": 6, "source": 8, "target": 9, "type": "DDG"}, {"id": 7, "source": 9, "target": 10, "type": "DDG"}, {"id": 8, "source": 10, "target": 11, "type": "DDG"}, {"id": 9, "source": 10, "target": 12, "type": "DDG"}, {"id": 10, "source": 10, "target": 13, "type": "DDG"}, {"id": 11, "source": 9, "target": 14, "type": "DDG"}, {"id": 12, "source": 9, "target": 15, "type": "DDG"}, {"id": 13, "source": 8, "target": 16, "type": "DDG"}, {"id": 14, "source": 8, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__File_51a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 47, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 48, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 49, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 54, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 65, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 77, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 89, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 91, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__File_51b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 101, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__File_51b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE23_Relative_Path_Traversal__File_51b()).badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__File_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 34, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR6", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [15, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 39, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR6", "=", "\"/home/user/uploads/\""], "tokens_order": [15, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", "+", "VAR5", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 21, 14, 2, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 49, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 53, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 55, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 56, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__File_51b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 15, "type": "DDG"}, {"id": 1, "source": 12, "target": 16, "type": "DDG"}, {"id": 2, "source": 13, "target": 16, "type": "DDG"}, {"id": 3, "source": 14, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 16, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 19, "target": 20, "type": "DDG"}, {"id": 8, "source": 20, "target": 21, "type": "DDG"}, {"id": 9, "source": 20, "target": 22, "type": "DDG"}, {"id": 10, "source": 20, "target": 23, "type": "DDG"}, {"id": 11, "source": 19, "target": 24, "type": "DDG"}, {"id": 12, "source": 19, "target": 25, "type": "DDG"}, {"id": 13, "source": 18, "target": 26, "type": "DDG"}, {"id": 14, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_66a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 120, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 122, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66a", "new_tokens": ["String", "[", "]", "VAR1", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 10, 4, 7, 20, 29, 73, 30, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 123, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66a", "new_tokens": ["VAR1", "[", "2", "]", "=", "VAR0"], "tokens_order": [10, 29, 35, 30, 4, 5, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "mtdSignature": "goodG2BSink(java.lang.String[])", "called_column": "9"}], "varibles": ["dataArray"], "line": 124, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__connect_tcp_66b", "(", ")", ")", ".", "goodG2BSink", "(", "dataArray", ")"], "code": "(new CWE23_Relative_Path_Traversal__connect_tcp_66b()).goodG2BSink(dataArray)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "dataArray", "[", "]", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String[] dataArray) throws Throwable {\r\n    String data = dataArray[2];\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR2", "[", "]", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 6, 29, 30, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["String", "VAR3", "=", "VAR2", "[", "2", "]"], "tokens_order": [20, 9, 4, 6, 29, 35, 30, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_66b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 8, "type": "DDG"}, {"id": 2, "source": 5, "target": 9, "type": "DDG"}, {"id": 3, "source": 7, "target": 9, "type": "DDG"}, {"id": 4, "source": 6, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 9, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 13, "target": 14, "type": "DDG"}, {"id": 10, "source": 13, "target": 15, "type": "DDG"}, {"id": 11, "source": 13, "target": 16, "type": "DDG"}, {"id": 12, "source": 12, "target": 17, "type": "DDG"}, {"id": 13, "source": 12, "target": 18, "type": "DDG"}, {"id": 14, "source": 11, "target": 19, "type": "DDG"}, {"id": 15, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_22a____goodG2B1", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_22b", "mtdSignature": "goodG2B1Source()", "called_column": "16"}], "varibles": ["data"], "line": 132, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__connect_tcp_22b", "(", ")", ")", ".", "goodG2B1Source", "(", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__connect_tcp_22b()).goodG2B1Source()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 138, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 143, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 146, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 149, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 153, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 157, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 158, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 159, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 160, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 171, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 173, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 183, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 185, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 195, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 197, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 119, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22b", "new_tokens": ["VAR6", "=", "null"], "tokens_order": [15, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22b", "new_tokens": ["VAR6", "=", "\"foo\""], "tokens_order": [15, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 18, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 129, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_22b", "new_tokens": ["return", "VAR6", ";"], "tokens_order": [84, 15, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 18, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 18, "type": "DDG"}, {"id": 1, "source": 16, "target": 18, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    while (true) {\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n        break;\r\n    }\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["String", "VAR2"], "tokens_order": [20, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 36, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 44, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 49, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 52, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 55, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 59, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 64, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 65, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 66, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 77, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 79, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 89, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 91, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 101, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 103, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 5, "type": "DDG"}, {"id": 2, "source": 2, "target": 5, "type": "DDG"}, {"id": 3, "source": 1, "target": 6, "type": "DDG"}, {"id": 4, "source": 2, "target": 6, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 4, "target": 6, "type": "DDG"}, {"id": 7, "source": 6, "target": 7, "type": "DDG"}, {"id": 8, "source": 6, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 9, "target": 10, "type": "DDG"}, {"id": 11, "source": 10, "target": 11, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 10, "target": 13, "type": "DDG"}, {"id": 14, "source": 9, "target": 14, "type": "DDG"}, {"id": 15, "source": 9, "target": 15, "type": "DDG"}, {"id": 16, "source": 8, "target": 16, "type": "DDG"}, {"id": 17, "source": 8, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__URLConnection_67a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 47, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 94, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["Container", "VAR4", "=", "new", "Container", "(", ")"], "tokens_order": [56, 11, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 95, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR4", ".", "containerOne", "=", "VAR3"], "tokens_order": [11, 3, 70, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__URLConnection_67b", "mtdSignature": "badSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__URLConnection_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 96, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__URLConnection_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__URLConnection_67b()).badSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0, 0]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE23_Relative_Path_Traversal__URLConnection_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE23_Relative_Path_Traversal__URLConnection_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__URLConnection_67a", ".", "Container", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 14, 2, 22, 23, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "containerOne"], "tokens_order": [20, 15, 4, 14, 3, 70, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR6", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 15, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 8, "target": 9, "type": "DDG"}, {"id": 8, "source": 3, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": 1, "source": 12, "target": 15, "type": "DDG"}, {"id": 2, "source": 12, "target": 16, "type": "DDG"}, {"id": 3, "source": 14, "target": 16, "type": "DDG"}, {"id": 4, "source": 13, "target": 16, "type": "DDG"}, {"id": 5, "source": 16, "target": 17, "type": "DDG"}, {"id": 6, "source": 16, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 20, "target": 21, "type": "DDG"}, {"id": 10, "source": 20, "target": 22, "type": "DDG"}, {"id": 11, "source": 20, "target": 23, "type": "DDG"}, {"id": 12, "source": 19, "target": 24, "type": "DDG"}, {"id": 13, "source": 19, "target": 25, "type": "DDG"}, {"id": 14, "source": 18, "target": 26, "type": "DDG"}, {"id": 15, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 48, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* use badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = badSource(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "mtdSignature": "badSource(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "23"}], "varibles": ["request", "data", "response"], "line": 50, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", "request", ",", "response", ")"], "code": "String data = badSource(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["String", "VAR2", "=", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [20, 6, 4, 25, 1, 5, 8, 10, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 56, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 61, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 64, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 67, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 71, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 75, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 76, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 77, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 78, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 89, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 91, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 101, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 103, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 113, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 115, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["private", "String", "badSource", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "private String badSource(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    return data;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["private", "String", "FUN1", "(", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [61, 20, 25, 1, 39, 26, 8, 40, 31, 2, 22, 23]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR10", "=", "\"\""], "tokens_order": [36, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 36, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["Cookie", "VAR11", "[", "]", "=", "VAR8", ".", "getCookies", "(", ")"], "tokens_order": [88, 44, 29, 30, 4, 26, 3, 125, 1, 2, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 37, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 40, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["VAR10", "=", "VAR11", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [36, 4, 44, 29, 33, 30, 3, 126, 1, 2, 0, 0], "bad_source": true}, {"id": 22, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getCookies_Servlet_42", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 3, "target": 5, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 1, "target": 17, "type": "func_call_out"}, {"id": "-1", "source": 22, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 19, "type": "DDG"}, {"id": 1, "source": 19, "target": 20, "type": "DDG"}, {"id": 2, "source": 19, "target": 21, "type": "DDG"}, {"id": 3, "source": 21, "target": 22, "type": "DDG"}, {"id": 4, "source": 18, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Environment_01____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 45, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 48, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 51, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 55, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 59, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 60, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 61, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 62, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 73, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 75, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 85, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 87, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 97, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 99, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Environment_01", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__PropertiesFile_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 79, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 85, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 90, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 93, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 96, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 100, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 104, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 105, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 106, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 107, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 118, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 120, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 130, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 132, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 142, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 144, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 41, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["Properties", "VAR6", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 15, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [18, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR6", ".", "load", "(", "VAR7", ")"], "tokens_order": [15, 3, 101, 1, 18, 2, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 50, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR8", "=", "VAR6", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [26, 4, 15, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 61, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 63, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 73, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__PropertiesFile_42", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 22, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 18, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 16, "target": 19, "type": "DDG"}, {"id": 3, "source": 17, "target": 20, "type": "DDG"}, {"id": 4, "source": 17, "target": 21, "type": "DDG"}, {"id": 5, "source": 19, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_01____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 49, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 52, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 53, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 56, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 67, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 69, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 79, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 81, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 91, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 93, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 107, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 112, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 115, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 118, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 122, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 126, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 127, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 128, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 129, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 140, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 142, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 152, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 154, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 164, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 166, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_01", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 12, "type": "DDG"}, {"id": 10, "source": 3, "target": 13, "type": "DDG"}, {"id": 11, "source": 10, "target": 13, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": 15, "source": 15, "target": 16, "type": "DDG"}, {"id": 16, "source": 16, "target": 17, "type": "DDG"}, {"id": 17, "source": 17, "target": 18, "type": "DDG"}, {"id": 18, "source": 17, "target": 19, "type": "DDG"}, {"id": 19, "source": 17, "target": 20, "type": "DDG"}, {"id": 20, "source": 16, "target": 21, "type": "DDG"}, {"id": 21, "source": 16, "target": 22, "type": "DDG"}, {"id": 22, "source": 15, "target": 23, "type": "DDG"}, {"id": 23, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 50, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    Container dataContainer = new Container();\r\n    dataContainer.containerOne = data;\r\n    (new CWE23_Relative_Path_Traversal__getParameter_Servlet_67b()).goodG2BSink(dataContainer, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 55, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 57, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", "new_tokens": ["Container", "VAR3", "=", "new", "Container", "(", ")"], "tokens_order": [56, 9, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 58, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", "new_tokens": ["VAR3", ".", "containerOne", "=", "VAR2"], "tokens_order": [9, 3, 70, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "mtdSignature": "goodG2BSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__getParameter_Servlet_67a.Container, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataContainer", "request", "response"], "line": 59, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ",", "request", ",", "response", ")"], "code": "(new CWE23_Relative_Path_Traversal__getParameter_Servlet_67b()).goodG2BSink(dataContainer, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer", "request", "response"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", ".", "Container", "dataContainer", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE23_Relative_Path_Traversal__getParameter_Servlet_67a.Container dataContainer, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["public", "void", "FUN1", "(", "CWE23_Relative_Path_Traversal__getParameter_Servlet_67a", ".", "Container", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 0, 3, 56, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "containerOne"], "tokens_order": [20, 18, 4, 11, 3, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": 1, "source": 1, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": 1, "source": 6, "target": 9, "type": "DDG"}, {"id": 2, "source": 6, "target": 10, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 7, "target": 10, "type": "DDG"}, {"id": 5, "source": 10, "target": 11, "type": "DDG"}, {"id": 6, "source": 10, "target": 12, "type": "DDG"}, {"id": 7, "source": 12, "target": 13, "type": "DDG"}, {"id": 8, "source": 13, "target": 14, "type": "DDG"}, {"id": 9, "source": 14, "target": 15, "type": "DDG"}, {"id": 10, "source": 14, "target": 16, "type": "DDG"}, {"id": 11, "source": 14, "target": 17, "type": "DDG"}, {"id": 12, "source": 13, "target": 18, "type": "DDG"}, {"id": 13, "source": 13, "target": 19, "type": "DDG"}, {"id": 14, "source": 12, "target": 20, "type": "DDG"}, {"id": 15, "source": 12, "target": 21, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_21____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_21", "mtdSignature": "bad_source()", "called_column": "16"}], "varibles": ["data"], "line": 42, "column": 9, "tokens": ["data", "=", "bad_source", "(", ")"], "code": "data = bad_source()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR0", "=", "FUN0", "(", ")"], "tokens_order": [5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 53, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 56, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 59, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 63, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 67, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 69, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 70, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 81, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 83, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 93, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 95, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 105, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 107, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "34"}], "varibles": ["connection"], "line": 135, "column": 21, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR6", "=", "CLS0", ".", "FUN2", "(", ")"], "tokens_order": [15, 4, 27, 3, 57, 1, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 137, "column": 21, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR7", "=", "VAR6", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [18, 4, 15, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 138, "column": 21, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR8", "=", "VAR7", ".", "executeQuery", "(", ")"], "tokens_order": [26, 4, 18, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 140, "column": 21, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR9", "=", "VAR8", ".", "getString", "(", "1", ")"], "tokens_order": [31, 4, 26, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 151, "column": 29, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 153, "column": 29, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 163, "column": 29, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 165, "column": 29, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 175, "column": 29, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 177, "column": 29, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 191, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["VAR9", "=", "null"], "tokens_order": [31, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 194, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__database_21", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 27, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 19, "target": 27, "type": "DDG"}, {"id": 1, "source": 26, "target": 27, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 18, "target": 19, "type": "DDG"}, {"id": 5, "source": 18, "target": 20, "type": "DDG"}, {"id": 6, "source": 18, "target": 21, "type": "DDG"}, {"id": 7, "source": 17, "target": 22, "type": "DDG"}, {"id": 8, "source": 17, "target": 23, "type": "DDG"}, {"id": 9, "source": 16, "target": 24, "type": "DDG"}, {"id": 10, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    CWE23_Relative_Path_Traversal__getParameter_Servlet_81_base baseObject = new CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad();\r\n    baseObject.action(data, request, response);\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 32, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 34, "column": 9, "tokens": ["CWE23_Relative_Path_Traversal__getParameter_Servlet_81_base", "baseObject", "=", "new", "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "(", ")"], "code": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_base baseObject = new CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81a", "new_tokens": ["CLS0", "VAR3", "=", "new", "VAR", "(", ")"], "tokens_order": [27, 9, 4, 7, 78, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_base", "mtdSignature": "action(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response", "baseObject"], "line": 35, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ",", "request", ",", "response", ")"], "code": "baseObject.action(data, request, response)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81a", "new_tokens": ["VAR3", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [9, 3, 25, 1, 6, 8, 5, 8, 10, 2, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void action(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 35, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR7", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [18, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR7", "=", "\"/home/user/uploads/\""], "tokens_order": [18, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 43, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", "+", "VAR4", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 21, 11, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_81_bad", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 7, "type": "DDG"}, {"id": 1, "source": 4, "target": 8, "type": "DDG"}, {"id": 2, "source": 5, "target": 8, "type": "DDG"}, {"id": 3, "source": 6, "target": 8, "type": "DDG"}, {"id": 4, "source": 8, "target": 9, "type": "DDG"}, {"id": 5, "source": 8, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 12, "target": 14, "type": "DDG"}, {"id": 10, "source": 12, "target": 15, "type": "DDG"}, {"id": 11, "source": 11, "target": 16, "type": "DDG"}, {"id": 12, "source": 11, "target": 17, "type": "DDG"}, {"id": 13, "source": 10, "target": 18, "type": "DDG"}, {"id": 14, "source": 10, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__connect_tcp_41____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 276, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__connect_tcp_41", "mtdSignature": "goodG2BSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 278, "column": 9, "tokens": ["goodG2BSink", "(", "data", ")"], "code": "goodG2BSink(data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["FUN0", "(", "VAR0", ")"], "tokens_order": [16, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 191, "column": 5, "tokens": ["private", "void", "goodG2BSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void goodG2BSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 198, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR2", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [6, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 203, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR2", "=", "\"/home/user/uploads/\""], "tokens_order": [6, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 206, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 209, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", "+", "VAR1", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 21, 10, 2, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 213, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 217, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 218, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 219, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 220, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 231, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 233, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 243, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 245, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 255, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 257, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__connect_tcp_41", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 5, "type": "DDG"}, {"id": 1, "source": 2, "target": 6, "type": "DDG"}, {"id": 2, "source": 4, "target": 6, "type": "DDG"}, {"id": 3, "source": 3, "target": 6, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 6, "target": 8, "type": "DDG"}, {"id": 6, "source": 8, "target": 9, "type": "DDG"}, {"id": 7, "source": 9, "target": 10, "type": "DDG"}, {"id": 8, "source": 10, "target": 11, "type": "DDG"}, {"id": 9, "source": 10, "target": 12, "type": "DDG"}, {"id": 10, "source": 10, "target": 13, "type": "DDG"}, {"id": 11, "source": 9, "target": 14, "type": "DDG"}, {"id": 12, "source": 9, "target": 15, "type": "DDG"}, {"id": 13, "source": 8, "target": 16, "type": "DDG"}, {"id": 14, "source": 8, "target": 17, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__console_readLine_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 105, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 107, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 108, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__console_readLine_67b", "mtdSignature": "goodG2BSink(testcases.CWE23_Relative_Path_Traversal.CWE23_Relative_Path_Traversal__console_readLine_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 109, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__console_readLine_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE23_Relative_Path_Traversal__console_readLine_67b()).goodG2BSink(dataContainer)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 109, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE23_Relative_Path_Traversal__console_readLine_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE23_Relative_Path_Traversal__console_readLine_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE23_Relative_Path_Traversal__console_readLine_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 111, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 117, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR4", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [11, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 122, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR4", "=", "\"/home/user/uploads/\""], "tokens_order": [11, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 128, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", "+", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 21, 9, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 132, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 137, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 138, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 139, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 150, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 162, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 174, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__console_readLine_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 8, "type": "DDG"}, {"id": 2, "source": 5, "target": 9, "type": "DDG"}, {"id": 3, "source": 6, "target": 9, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 9, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 13, "target": 14, "type": "DDG"}, {"id": 10, "source": 13, "target": 15, "type": "DDG"}, {"id": 11, "source": 13, "target": 16, "type": "DDG"}, {"id": 12, "source": 12, "target": 17, "type": "DDG"}, {"id": 13, "source": 12, "target": 18, "type": "DDG"}, {"id": 14, "source": 11, "target": 19, "type": "DDG"}, {"id": 15, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__listen_tcp_74a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 120, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR5", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 14, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 121, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 122, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 123, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 124, "column": 9, "tokens": ["(", "new", "CWE23_Relative_Path_Traversal__listen_tcp_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE23_Relative_Path_Traversal__listen_tcp_74b()).badSink(dataHashMap)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 15, 2, 22, 23, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "get", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 37, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR8", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [26, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 42, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR8", "=", "\"/home/user/uploads/\""], "tokens_order": [26, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", "+", "VAR7", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 21, 18, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 33, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 34, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 14, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 15, "type": "DDG"}, {"id": 15, "source": 13, "target": 15, "type": "DDG"}, {"id": 16, "source": 4, "target": 16, "type": "DDG"}, {"id": 17, "source": 13, "target": 16, "type": "DDG"}, {"id": 18, "source": 13, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 19, "type": "DDG"}, {"id": 1, "source": 19, "target": 22, "type": "DDG"}, {"id": 2, "source": 19, "target": 23, "type": "DDG"}, {"id": 3, "source": 21, "target": 23, "type": "DDG"}, {"id": 4, "source": 20, "target": 23, "type": "DDG"}, {"id": 5, "source": 23, "target": 24, "type": "DDG"}, {"id": 6, "source": 23, "target": 25, "type": "DDG"}, {"id": 7, "source": 25, "target": 26, "type": "DDG"}, {"id": 8, "source": 26, "target": 27, "type": "DDG"}, {"id": 9, "source": 27, "target": 28, "type": "DDG"}, {"id": 10, "source": 27, "target": 29, "type": "DDG"}, {"id": 11, "source": 27, "target": 30, "type": "DDG"}, {"id": 12, "source": 26, "target": 31, "type": "DDG"}, {"id": 13, "source": 26, "target": 32, "type": "DDG"}, {"id": 14, "source": 25, "target": 33, "type": "DDG"}, {"id": 15, "source": 25, "target": 34, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__Property_22a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__Property_22b", "mtdSignature": "badSource()", "called_column": "16"}], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE23_Relative_Path_Traversal__Property_22b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "data = (new CWE23_Relative_Path_Traversal__Property_22b()).badSource()", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 43, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 51, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 54, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 58, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 62, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 64, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 65, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__Property_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE23_Relative_Path_Traversal__Property_22b", "new_tokens": ["VAR6", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [15, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 40, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__Property_22b", "new_tokens": ["VAR6", "=", "null"], "tokens_order": [15, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 42, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__Property_22b", "new_tokens": ["return", "VAR6", ";"], "tokens_order": [84, 15, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 18, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 18, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_41____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 127, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 130, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 131, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 134, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 145, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 147, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 157, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 159, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 169, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 171, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 181, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["FUN1", "(", "VAR3", ")"], "tokens_order": [25, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["private", "void", "FUN1", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [61, 24, 25, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 40, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR5", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [14, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 45, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR5", "=", "\"/home/user/uploads/\""], "tokens_order": [14, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 48, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 51, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", "+", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 21, 11, 2, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 55, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 59, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 60, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 61, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 62, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 31, 3, 47, 1, 2, 2, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 73, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 75, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 85, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 87, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 97, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 99, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_41", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 14, "type": "DDG"}, {"id": 1, "source": 11, "target": 15, "type": "DDG"}, {"id": 2, "source": 12, "target": 15, "type": "DDG"}, {"id": 3, "source": 13, "target": 15, "type": "DDG"}, {"id": 4, "source": 15, "target": 16, "type": "DDG"}, {"id": 5, "source": 15, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 19, "target": 21, "type": "DDG"}, {"id": 10, "source": 19, "target": 22, "type": "DDG"}, {"id": 11, "source": 18, "target": 23, "type": "DDG"}, {"id": 12, "source": 18, "target": 24, "type": "DDG"}, {"id": 13, "source": 17, "target": 25, "type": "DDG"}, {"id": 14, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    this.badPrivate = true;\r\n    data = bad_source(request, response);\r\n    String root;\r\n    if (System.getProperty(\"os.name\").toLowerCase().indexOf(\"win\") >= 0) {\r\n        /* running on Windows */\r\n        root = \"C:\\\\uploads\\\\\";\r\n    } else {\r\n        /* running on non-Windows */\r\n        root = \"/home/user/uploads/\";\r\n    }\r\n    if (data != null) {\r\n        /* POTENTIAL FLAW: no validation of concatenated value */\r\n        File file = new File(root + data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "mtdSignature": "bad_source(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "16"}], "varibles": ["request", "data", "response"], "line": 37, "column": 9, "tokens": ["data", "=", "bad_source", "(", "request", ",", "response", ")"], "code": "data = bad_source(request, response)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR2", "=", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [6, 4, 25, 1, 5, 8, 10, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 43, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR3", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [9, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 48, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR3", "=", "\"/home/user/uploads/\""], "tokens_order": [9, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 51, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 54, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", "+", "VAR2", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 21, 6, 2, 0, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 58, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 62, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 63, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 64, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 65, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 18, 3, 47, 1, 2, 2, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 76, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 88, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 100, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 115, "column": 5, "tokens": ["private", "String", "bad_source", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "private String bad_source(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (this.badPrivate) {\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n    } else {\r\n        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run\r\n             * but ensure data is inititialized before the Sink to avoid compiler errors */\r\n        data = null;\r\n    }\r\n    return data;\r\n}", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["private", "String", "FUN1", "(", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [61, 20, 25, 1, 39, 26, 8, 40, 31, 2, 22, 23]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 122, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR10", "=", "VAR8", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [36, 4, 26, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 128, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["VAR10", "=", "null"], "tokens_order": [36, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 131, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__getParameter_Servlet_21", "new_tokens": ["return", "VAR10", ";"], "tokens_order": [84, 36, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 4, "type": "DDG"}, {"id": 2, "source": 1, "target": 5, "type": "DDG"}, {"id": 3, "source": 2, "target": 5, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 9, "target": 12, "type": "DDG"}, {"id": 12, "source": 8, "target": 13, "type": "DDG"}, {"id": 13, "source": 8, "target": 14, "type": "DDG"}, {"id": 14, "source": 7, "target": 15, "type": "DDG"}, {"id": 15, "source": 7, "target": 16, "type": "DDG"}, {"id": "-1", "source": 1, "target": 17, "type": "func_call_out"}, {"id": "-1", "source": 20, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 18, "type": "DDG"}, {"id": 1, "source": 19, "target": 20, "type": "DDG"}, {"id": 2, "source": 18, "target": 20, "type": "DDG"}], "target": 1}, {"cwe": "CWE23", "fun_info": "CWE23_Relative_Path_Traversal__database_61a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE23_Relative_Path_Traversal__database_61b", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE23_Relative_Path_Traversal__database_61b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "String data = (new CWE23_Relative_Path_Traversal__database_61b()).badSource()", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["String", "VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 36, "column": 13, "tokens": ["root", "=", "\"C:\\\\uploads\\\\\""], "code": "root = \"C:\\\\uploads\\\\\"", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR1", "=", "\"C:\\\\uploads\\\\\""], "tokens_order": [10, 4, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["root"], "line": 41, "column": 13, "tokens": ["root", "=", "\"/home/user/uploads/\""], "code": "root = \"/home/user/uploads/\"", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR1", "=", "\"/home/user/uploads/\""], "tokens_order": [10, 4, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data", "root"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "root", "+", "data", ")"], "code": "File file = new File(root + data)", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", "+", "VAR0", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 21, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR6", "=", "CLS1", ".", "FUN2", "(", ")"], "tokens_order": [15, 4, 38, 3, 57, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR7", "=", "VAR6", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [18, 4, 15, 3, 79, 1, 112, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR8", "=", "VAR7", ".", "executeQuery", "(", ")"], "tokens_order": [26, 4, 18, 3, 90, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR9", "=", "VAR8", ".", "getString", "(", "1", ")"], "tokens_order": [31, 4, 26, 3, 113, 1, 37, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE23_Relative_Path_Traversal__database_61b", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 3, "type": "DDG"}, {"id": 1, "source": 0, "target": 4, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 7, "target": 12, "type": "DDG"}, {"id": 12, "source": 7, "target": 13, "type": "DDG"}, {"id": 13, "source": 6, "target": 14, "type": "DDG"}, {"id": 14, "source": 6, "target": 15, "type": "DDG"}, {"id": "-1", "source": 26, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 18, "target": 19, "type": "DDG"}, {"id": 3, "source": 18, "target": 20, "type": "DDG"}, {"id": 4, "source": 18, "target": 21, "type": "DDG"}, {"id": 5, "source": 17, "target": 22, "type": "DDG"}, {"id": 6, "source": 17, "target": 23, "type": "DDG"}, {"id": 7, "source": 16, "target": 24, "type": "DDG"}, {"id": 8, "source": 16, "target": 25, "type": "DDG"}, {"id": 9, "source": 19, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_41____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 109, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 115, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 116, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 121, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 132, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 134, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 144, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 146, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__URLConnection_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 156, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["FUN0", "(", "VAR3", ")"], "tokens_order": [16, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 38, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 40, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 2, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 44, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 48, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 49, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 50, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 51, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 62, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 64, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 74, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 76, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 86, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 88, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_41", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 10, "type": "DDG"}, {"id": 1, "source": 9, "target": 11, "type": "DDG"}, {"id": 2, "source": 11, "target": 12, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 14, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 15, "target": 17, "type": "DDG"}, {"id": 8, "source": 15, "target": 18, "type": "DDG"}, {"id": 9, "source": 14, "target": 19, "type": "DDG"}, {"id": 10, "source": 14, "target": 20, "type": "DDG"}, {"id": 11, "source": 13, "target": 21, "type": "DDG"}, {"id": 12, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_53a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 55, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 56, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 107, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 109, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_53b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_53b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_53b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__listen_tcp_53c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_53c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_53c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_53c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__listen_tcp_53d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 15, 2, 22, 23, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_53d()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR6", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 15, 2, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 18, 2, 22, 23, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0], "fixed": true}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["CLS3", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_53d", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 19, "type": "DDG"}, {"id": 1, "source": 18, "target": 20, "type": "DDG"}, {"id": 2, "source": 20, "target": 21, "type": "DDG"}, {"id": 3, "source": 20, "target": 22, "type": "DDG"}, {"id": 4, "source": 22, "target": 23, "type": "DDG"}, {"id": 5, "source": 23, "target": 24, "type": "DDG"}, {"id": 6, "source": 24, "target": 25, "type": "DDG"}, {"id": 7, "source": 24, "target": 26, "type": "DDG"}, {"id": 8, "source": 24, "target": 27, "type": "DDG"}, {"id": 9, "source": 23, "target": 28, "type": "DDG"}, {"id": 10, "source": 23, "target": 29, "type": "DDG"}, {"id": 11, "source": 22, "target": 30, "type": "DDG"}, {"id": 12, "source": 22, "target": 31, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink - see how tools report flaws that don't always occur */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (IO.staticReturnsTrueOrFalse()) {\r\n        data = \"\";\r\n        /* initialize data in case id is not in query string */\r\n        /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n        {\r\n            StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n            while (tokenizer.hasMoreTokens()) {\r\n                String token = tokenizer.nextToken();\r\n                /* a token will be like \"id=foo\" */\r\n                if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n                {\r\n                    data = token.substring(3);\r\n                    /* set data to \"foo\" */\r\n                    break;\r\n                    /* exit while loop */\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        /* FIX: Use a hardcoded string */\r\n        data = \"foo\";\r\n    }\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 13, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 38, "column": 17, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 39, "column": 24, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 41, "column": 21, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 42, "column": 24, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 44, "column": 25, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 54, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 59, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 61, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 65, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 69, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 70, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 71, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 72, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 83, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 85, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 95, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 97, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 107, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 109, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 6, "target": 8, "type": "DDG"}, {"id": 2, "source": 1, "target": 8, "type": "DDG"}, {"id": 3, "source": 7, "target": 9, "type": "DDG"}, {"id": 4, "source": 6, "target": 9, "type": "DDG"}, {"id": 5, "source": 1, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 9, "target": 11, "type": "DDG"}, {"id": 8, "source": 11, "target": 12, "type": "DDG"}, {"id": 9, "source": 12, "target": 13, "type": "DDG"}, {"id": 10, "source": 13, "target": 14, "type": "DDG"}, {"id": 11, "source": 13, "target": 15, "type": "DDG"}, {"id": 12, "source": 13, "target": 16, "type": "DDG"}, {"id": 13, "source": 12, "target": 17, "type": "DDG"}, {"id": 14, "source": 12, "target": 18, "type": "DDG"}, {"id": 15, "source": 11, "target": 19, "type": "DDG"}, {"id": 16, "source": 11, "target": 20, "type": "DDG"}, {"id": 17, "source": 0, "target": 2, "type": "DDG"}, {"id": 18, "source": 2, "target": 3, "type": "DDG"}, {"id": 19, "source": 2, "target": 4, "type": "DDG"}, {"id": 20, "source": 4, "target": 5, "type": "DDG"}, {"id": 21, "source": 4, "target": 6, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__database_52a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__database_52b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__database_52b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__database_52b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_52a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 2]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__database_52c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__database_52b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__database_52c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__database_52c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__database_52c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_52b", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR4", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 11, 2]}, {"id": 13, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 31, 3, 47, 1, 2, 2, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_52c", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": "-1", "source": 12, "target": 13, "type": "func_call_out"}, {"id": 0, "source": 13, "target": 14, "type": "DDG"}, {"id": 1, "source": 13, "target": 15, "type": "DDG"}, {"id": 2, "source": 15, "target": 16, "type": "DDG"}, {"id": 3, "source": 15, "target": 17, "type": "DDG"}, {"id": 4, "source": 17, "target": 18, "type": "DDG"}, {"id": 5, "source": 18, "target": 19, "type": "DDG"}, {"id": 6, "source": 19, "target": 20, "type": "DDG"}, {"id": 7, "source": 19, "target": 21, "type": "DDG"}, {"id": 8, "source": 19, "target": 22, "type": "DDG"}, {"id": 9, "source": 18, "target": 23, "type": "DDG"}, {"id": 10, "source": 18, "target": 24, "type": "DDG"}, {"id": 11, "source": 17, "target": 25, "type": "DDG"}, {"id": 12, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_52a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 42, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 48, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 49, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 54, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 65, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 77, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__URLConnection_52b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 89, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__URLConnection_52b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__URLConnection_52b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 9, 2, 0, 0, 0]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__URLConnection_52c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__URLConnection_52c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__URLConnection_52c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0, 0]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["CLS2", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_52c", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": 1, "source": 11, "target": 13, "type": "DDG"}, {"id": 2, "source": 13, "target": 14, "type": "DDG"}, {"id": 3, "source": 13, "target": 15, "type": "DDG"}, {"id": 4, "source": 15, "target": 16, "type": "DDG"}, {"id": 5, "source": 16, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 17, "target": 19, "type": "DDG"}, {"id": 8, "source": 17, "target": 20, "type": "DDG"}, {"id": 9, "source": 16, "target": 21, "type": "DDG"}, {"id": 10, "source": 16, "target": 22, "type": "DDG"}, {"id": 11, "source": 15, "target": 23, "type": "DDG"}, {"id": 12, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_12____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 21, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 21, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 92, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 94, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 104, "column": 29, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 106, "column": 29, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 120, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "=", "\"foo\""], "tokens_order": [11, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 125, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 127, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 131, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 135, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 136, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 137, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 138, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 149, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 151, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 161, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 163, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 173, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 175, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 4, "target": 14, "type": "DDG"}, {"id": 1, "source": 13, "target": 14, "type": "DDG"}, {"id": 2, "source": 4, "target": 15, "type": "DDG"}, {"id": 3, "source": 13, "target": 15, "type": "DDG"}, {"id": 4, "source": 15, "target": 16, "type": "DDG"}, {"id": 5, "source": 15, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 19, "target": 20, "type": "DDG"}, {"id": 9, "source": 19, "target": 21, "type": "DDG"}, {"id": 10, "source": 19, "target": 22, "type": "DDG"}, {"id": 11, "source": 18, "target": 23, "type": "DDG"}, {"id": 12, "source": 18, "target": 24, "type": "DDG"}, {"id": 13, "source": 17, "target": 25, "type": "DDG"}, {"id": 14, "source": 17, "target": 26, "type": "DDG"}, {"id": 15, "source": 0, "target": 1, "type": "DDG"}, {"id": 16, "source": 1, "target": 2, "type": "DDG"}, {"id": 17, "source": 2, "target": 3, "type": "DDG"}, {"id": 18, "source": 3, "target": 4, "type": "DDG"}, {"id": 19, "source": 3, "target": 5, "type": "DDG"}, {"id": 20, "source": 3, "target": 6, "type": "DDG"}, {"id": 21, "source": 2, "target": 7, "type": "DDG"}, {"id": 22, "source": 2, "target": 8, "type": "DDG"}, {"id": 23, "source": 1, "target": 9, "type": "DDG"}, {"id": 24, "source": 1, "target": 10, "type": "DDG"}, {"id": 25, "source": 0, "target": 11, "type": "DDG"}, {"id": 26, "source": 0, "target": 12, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    String[] dataArray = new String[5];\r\n    dataArray[2] = data;\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b()).badSink(dataArray, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 35, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 36, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 39, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 43, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["String", "[", "]", "VAR4", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 11, 4, 7, 20, 29, 73, 30, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 44, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR4", "[", "2", "]", "=", "VAR2"], "tokens_order": [11, 29, 35, 30, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "mtdSignature": "badSink(java.lang.String[], javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataArray", "request", "response"], "line": 45, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "(", ")", ")", ".", "badSink", "(", "dataArray", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b()).badSink(dataArray, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 11, 8, 5, 8, 10, 2, 0, 0]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "dataArray", "[", "]", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String[] dataArray, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataArray[2];\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", "[", "]", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 29, 30, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["String", "VAR8", "=", "VAR5", "[", "2", "]"], "tokens_order": [20, 26, 4, 14, 29, 35, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 5, "target": 6, "type": "DDG"}, {"id": 4, "source": 4, "target": 6, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": 1, "source": 9, "target": 10, "type": "DDG"}, {"id": 2, "source": 9, "target": 11, "type": "DDG"}, {"id": 3, "source": 11, "target": 12, "type": "DDG"}, {"id": 4, "source": 11, "target": 13, "type": "DDG"}, {"id": 5, "source": 13, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 15, "target": 17, "type": "DDG"}, {"id": 9, "source": 15, "target": 18, "type": "DDG"}, {"id": 10, "source": 14, "target": 19, "type": "DDG"}, {"id": 11, "source": 14, "target": 20, "type": "DDG"}, {"id": 12, "source": 13, "target": 21, "type": "DDG"}, {"id": 13, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_51a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 49, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 50, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 54, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 55, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 58, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 94, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 106, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 118, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_51b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 33, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 37, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 41, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 43, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 44, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 55, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 67, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 79, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_51b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 14, "target": 16, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 16, "target": 18, "type": "DDG"}, {"id": 4, "source": 18, "target": 19, "type": "DDG"}, {"id": 5, "source": 19, "target": 20, "type": "DDG"}, {"id": 6, "source": 20, "target": 21, "type": "DDG"}, {"id": 7, "source": 20, "target": 22, "type": "DDG"}, {"id": 8, "source": 20, "target": 23, "type": "DDG"}, {"id": 9, "source": 19, "target": 24, "type": "DDG"}, {"id": 10, "source": 19, "target": 25, "type": "DDG"}, {"id": 11, "source": 18, "target": 26, "type": "DDG"}, {"id": 12, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 140, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 142, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 143, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "mtdSignature": "goodG2BSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__listen_tcp_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 144, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_67b()).goodG2BSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 97, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE36_Absolute_Path_Traversal__listen_tcp_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE36_Absolute_Path_Traversal__listen_tcp_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__listen_tcp_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 99, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 104, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 108, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 112, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 114, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 115, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 128, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 140, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 152, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 6, "type": "DDG"}, {"id": 2, "source": 5, "target": 7, "type": "DDG"}, {"id": 3, "source": 7, "target": 8, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 11, "target": 13, "type": "DDG"}, {"id": 9, "source": 11, "target": 14, "type": "DDG"}, {"id": 10, "source": 10, "target": 15, "type": "DDG"}, {"id": 11, "source": 10, "target": 16, "type": "DDG"}, {"id": 12, "source": 9, "target": 17, "type": "DDG"}, {"id": 13, "source": 9, "target": 18, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Property_81a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_81a", "new_tokens": ["VAR0", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [5, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 34, "column": 9, "tokens": ["CWE36_Absolute_Path_Traversal__Property_81_base", "baseObject", "=", "new", "CWE36_Absolute_Path_Traversal__Property_81_bad", "(", ")"], "code": "CWE36_Absolute_Path_Traversal__Property_81_base baseObject = new CWE36_Absolute_Path_Traversal__Property_81_bad()", "java_file": "CWE36_Absolute_Path_Traversal__Property_81a", "new_tokens": ["CLS0", "VAR1", "=", "new", "VAR", "(", ")"], "tokens_order": [27, 10, 4, 7, 78, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Property_81_base", "mtdSignature": "action(java.lang.String)", "called_column": "9"}], "varibles": ["data", "baseObject"], "line": 35, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ")"], "code": "baseObject.action(data)", "java_file": "CWE36_Absolute_Path_Traversal__Property_81a", "new_tokens": ["VAR1", ".", "FUN0", "(", "VAR0", ")"], "tokens_order": [10, 3, 16, 1, 5, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void action(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 6, 2, 22, 23, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0], "bad_sink": true}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_81_bad", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": 1, "source": 3, "target": 5, "type": "DDG"}, {"id": 2, "source": 5, "target": 6, "type": "DDG"}, {"id": 3, "source": 5, "target": 7, "type": "DDG"}, {"id": 4, "source": 7, "target": 8, "type": "DDG"}, {"id": 5, "source": 8, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 9, "target": 11, "type": "DDG"}, {"id": 8, "source": 9, "target": 12, "type": "DDG"}, {"id": 9, "source": 8, "target": 13, "type": "DDG"}, {"id": 10, "source": 8, "target": 14, "type": "DDG"}, {"id": 11, "source": 7, "target": 15, "type": "DDG"}, {"id": 12, "source": 7, "target": 16, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Property_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Property_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 41, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 46, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["VAR5", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [14, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0], "bad_source": true}, {"id": 15, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__Property_42", "new_tokens": ["return", "VAR5", ";"], "tokens_order": [84, 14, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 15, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 34, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 37, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 39, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 43, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 47, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 48, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 49, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 50, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 61, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 63, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 73, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 75, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 85, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 87, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_01", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": 9, "source": 7, "target": 10, "type": "DDG"}, {"id": 10, "source": 6, "target": 11, "type": "DDG"}, {"id": 11, "source": 6, "target": 12, "type": "DDG"}, {"id": 12, "source": 5, "target": 13, "type": "DDG"}, {"id": 13, "source": 5, "target": 14, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_61a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "String data = (new CWE36_Absolute_Path_Traversal__connect_tcp_61b()).badSource()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["String", "VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 48, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR5", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [14, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 52, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 3, 58, 1, 2, 8, 42, 2]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 53, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR8", "=", "VAR7", ".", "readLine", "(", ")"], "tokens_order": [26, 4, 18, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 92, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 94, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 104, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_61b", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 24, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 15, "target": 16, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 16, "target": 18, "type": "DDG"}, {"id": 4, "source": 16, "target": 19, "type": "DDG"}, {"id": 5, "source": 15, "target": 20, "type": "DDG"}, {"id": 6, "source": 15, "target": 21, "type": "DDG"}, {"id": 7, "source": 14, "target": 22, "type": "DDG"}, {"id": 8, "source": 14, "target": 23, "type": "DDG"}, {"id": 9, "source": 17, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (true) {\r\n        data = \"\";\r\n        /* initialize data in case id is not in query string */\r\n        /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n        {\r\n            StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n            while (tokenizer.hasMoreTokens()) {\r\n                String token = tokenizer.nextToken();\r\n                /* a token will be like \"id=foo\" */\r\n                if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n                {\r\n                    data = token.substring(3);\r\n                    /* set data to \"foo\" */\r\n                    break;\r\n                    /* exit while loop */\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run\r\n             * but ensure data is inititialized before the Sink to avoid compiler errors */\r\n        data = null;\r\n    }\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 13, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 38, "column": 17, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 39, "column": 24, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 41, "column": 21, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 42, "column": 24, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 44, "column": 25, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 54, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR2", "=", "null"], "tokens_order": [6, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 58, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 60, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 64, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 68, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 69, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 70, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 71, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 82, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 84, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 94, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 96, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 106, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 108, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_02", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 8, "type": "DDG"}, {"id": 1, "source": 7, "target": 8, "type": "DDG"}, {"id": 2, "source": 6, "target": 8, "type": "DDG"}, {"id": 3, "source": 1, "target": 9, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 6, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 9, "target": 11, "type": "DDG"}, {"id": 8, "source": 11, "target": 12, "type": "DDG"}, {"id": 9, "source": 12, "target": 13, "type": "DDG"}, {"id": 10, "source": 13, "target": 14, "type": "DDG"}, {"id": 11, "source": 13, "target": 15, "type": "DDG"}, {"id": 12, "source": 13, "target": 16, "type": "DDG"}, {"id": 13, "source": 12, "target": 17, "type": "DDG"}, {"id": 14, "source": 12, "target": 18, "type": "DDG"}, {"id": 15, "source": 11, "target": 19, "type": "DDG"}, {"id": 16, "source": 11, "target": 20, "type": "DDG"}, {"id": 17, "source": 0, "target": 2, "type": "DDG"}, {"id": 18, "source": 2, "target": 3, "type": "DDG"}, {"id": 19, "source": 2, "target": 4, "type": "DDG"}, {"id": 20, "source": 4, "target": 5, "type": "DDG"}, {"id": 21, "source": 4, "target": 6, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_72a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 41, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 49, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 50, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 91, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 93, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 103, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR5", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 14, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 104, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR5", ".", "add", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 105, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR5", ".", "add", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 106, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["VAR5", ".", "add", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 107, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__File_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ")"], "code": "(new CWE36_Absolute_Path_Traversal__File_72b()).badSink(dataVector)", "java_file": "CWE36_Absolute_Path_Traversal__File_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 15, 2, 22, 23, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_72b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 12, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": 13, "source": 11, "target": 13, "type": "DDG"}, {"id": 14, "source": 4, "target": 14, "type": "DDG"}, {"id": 15, "source": 11, "target": 14, "type": "DDG"}, {"id": 16, "source": 11, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 17, "target": 19, "type": "DDG"}, {"id": 3, "source": 19, "target": 20, "type": "DDG"}, {"id": 4, "source": 19, "target": 21, "type": "DDG"}, {"id": 5, "source": 21, "target": 22, "type": "DDG"}, {"id": 6, "source": 22, "target": 23, "type": "DDG"}, {"id": 7, "source": 23, "target": 24, "type": "DDG"}, {"id": 8, "source": 23, "target": 25, "type": "DDG"}, {"id": 9, "source": 23, "target": 26, "type": "DDG"}, {"id": 10, "source": 22, "target": 27, "type": "DDG"}, {"id": 11, "source": 22, "target": 28, "type": "DDG"}, {"id": 12, "source": 21, "target": 29, "type": "DDG"}, {"id": 13, "source": 21, "target": 30, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    Vector<String> dataVector = new Vector<String>(5);\r\n    dataVector.add(0, data);\r\n    dataVector.add(1, data);\r\n    dataVector.add(2, data);\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b()).badSink(dataVector, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 36, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 37, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 40, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 44, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR4", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 11, 4, 7, 68, 32, 20, 34, 1, 73, 2, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 45, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR4", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 46, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR4", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 47, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR4", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [11, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataVector"], "line": 48, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b()).badSink(dataVector, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 11, 8, 5, 8, 10, 2, 0, 0, 0]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["public", "void", "FUN1", "(", "Vector", "<", "String", ">", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 68, 32, 20, 34, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["String", "VAR8", "=", "VAR5", ".", "remove", "(", "2", ")"], "tokens_order": [20, 26, 4, 14, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 1, "target": 6, "type": "DDG"}, {"id": 4, "source": 4, "target": 6, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 4, "target": 7, "type": "DDG"}, {"id": 8, "source": 5, "target": 7, "type": "DDG"}, {"id": 9, "source": 1, "target": 8, "type": "DDG"}, {"id": 10, "source": 4, "target": 8, "type": "DDG"}, {"id": 11, "source": 5, "target": 8, "type": "DDG"}, {"id": 12, "source": 0, "target": 9, "type": "DDG"}, {"id": 13, "source": 5, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 11, "target": 12, "type": "DDG"}, {"id": 2, "source": 11, "target": 13, "type": "DDG"}, {"id": 3, "source": 13, "target": 14, "type": "DDG"}, {"id": 4, "source": 13, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 16, "target": 17, "type": "DDG"}, {"id": 7, "source": 17, "target": 18, "type": "DDG"}, {"id": 8, "source": 17, "target": 19, "type": "DDG"}, {"id": 9, "source": 17, "target": 20, "type": "DDG"}, {"id": 10, "source": 16, "target": 21, "type": "DDG"}, {"id": 11, "source": 16, "target": 22, "type": "DDG"}, {"id": 12, "source": 15, "target": 23, "type": "DDG"}, {"id": 13, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 54, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    String[] dataArray = new String[5];\r\n    dataArray[2] = data;\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b()).goodG2BSink(dataArray, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 59, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 61, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["String", "[", "]", "VAR3", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 9, 4, 7, 20, 29, 73, 30, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 62, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["VAR3", "[", "2", "]", "=", "VAR2"], "tokens_order": [9, 29, 35, 30, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "mtdSignature": "goodG2BSink(java.lang.String[], javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataArray", "request", "response"], "line": 63, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "(", ")", ")", ".", "goodG2BSink", "(", "dataArray", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b()).goodG2BSink(dataArray, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray", "request", "response"], "line": 97, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "dataArray", "[", "]", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String[] dataArray, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataArray[2];\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", "[", "]", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 29, 30, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 99, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["String", "VAR7", "=", "VAR4", "[", "2", "]"], "tokens_order": [20, 18, 4, 11, 29, 35, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 104, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 108, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 112, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 114, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 115, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 128, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 140, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 152, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_66b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": 1, "source": 1, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": 1, "source": 6, "target": 7, "type": "DDG"}, {"id": 2, "source": 6, "target": 8, "type": "DDG"}, {"id": 3, "source": 8, "target": 9, "type": "DDG"}, {"id": 4, "source": 8, "target": 10, "type": "DDG"}, {"id": 5, "source": 10, "target": 11, "type": "DDG"}, {"id": 6, "source": 11, "target": 12, "type": "DDG"}, {"id": 7, "source": 12, "target": 13, "type": "DDG"}, {"id": 8, "source": 12, "target": 14, "type": "DDG"}, {"id": 9, "source": 12, "target": 15, "type": "DDG"}, {"id": 10, "source": 11, "target": 16, "type": "DDG"}, {"id": 11, "source": 11, "target": 17, "type": "DDG"}, {"id": 12, "source": 10, "target": 18, "type": "DDG"}, {"id": 13, "source": 10, "target": 19, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__console_readLine_01____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 46, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 47, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 50, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 60, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 62, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 72, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 74, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 86, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 88, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 92, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 96, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 97, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 98, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 99, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 110, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 112, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 122, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 124, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 134, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 136, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_01", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 8, "target": 10, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 12, "target": 13, "type": "DDG"}, {"id": 13, "source": 12, "target": 14, "type": "DDG"}, {"id": 14, "source": 12, "target": 15, "type": "DDG"}, {"id": 15, "source": 11, "target": 16, "type": "DDG"}, {"id": 16, "source": 11, "target": 17, "type": "DDG"}, {"id": 17, "source": 10, "target": 18, "type": "DDG"}, {"id": 18, "source": 10, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 102, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b()).goodG2BSource(request, response);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b", "mtdSignature": "goodG2BSource(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "23"}], "varibles": ["request", "data", "response"], "line": 104, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b", "(", ")", ")", ".", "goodG2BSource", "(", "request", ",", "response", ")"], "code": "String data = (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b()).goodG2BSource(request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["String", "VAR2", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [20, 6, 4, 1, 7, 27, 1, 2, 2, 3, 25, 1, 5, 8, 10, 2]}, {"id": 2, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 107, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 109, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 113, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 117, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 118, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 119, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 120, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 15, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 131, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 133, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 143, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 145, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 155, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 157, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 52, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b", "new_tokens": ["VAR7", "=", "\"foo\""], "tokens_order": [18, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 54, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_61b", "new_tokens": ["return", "VAR7", ";"], "tokens_order": [84, 18, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": 9, "source": 7, "target": 10, "type": "DDG"}, {"id": 10, "source": 6, "target": 11, "type": "DDG"}, {"id": 11, "source": 6, "target": 12, "type": "DDG"}, {"id": 12, "source": 5, "target": 13, "type": "DDG"}, {"id": 13, "source": 5, "target": 14, "type": "DDG"}, {"id": "-1", "source": 16, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 33, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case id is not in query string */\r\n    /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n    {\r\n        StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n        while (tokenizer.hasMoreTokens()) {\r\n            String token = tokenizer.nextToken();\r\n            /* a token will be like \"id=foo\" */\r\n            if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n            {\r\n                data = token.substring(3);\r\n                /* set data to \"foo\" */\r\n                break;\r\n                /* exit while loop */\r\n            }\r\n        }\r\n    }\r\n    /* serialize data to a byte array */\r\n    ByteArrayOutputStream streamByteArrayOutput = null;\r\n    ObjectOutput outputObject = null;\r\n    try {\r\n        streamByteArrayOutput = new ByteArrayOutputStream();\r\n        outputObject = new ObjectOutputStream(streamByteArrayOutput);\r\n        outputObject.writeObject(data);\r\n        byte[] dataSerialized = streamByteArrayOutput.toByteArray();\r\n        (new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b()).badSink(dataSerialized, request, response);\r\n    } catch (IOException exceptIO) {\r\n        IO.logger.log(Level.WARNING, \"IOException in serialization\", exceptIO);\r\n    } finally {\r\n        /* clean up stream writing objects */\r\n        try {\r\n            if (outputObject != null) {\r\n                outputObject.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ObjectOutputStream\", exceptIO);\r\n        }\r\n        try {\r\n            if (streamByteArrayOutput != null) {\r\n                streamByteArrayOutput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ByteArrayOutputStream\", exceptIO);\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 41, "column": 13, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 42, "column": 20, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 44, "column": 17, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 45, "column": 20, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 47, "column": 21, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 59, "column": 13, "tokens": ["streamByteArrayOutput", "=", "new", "ByteArrayOutputStream", "(", ")"], "code": "streamByteArrayOutput = new ByteArrayOutputStream()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR5", "=", "new", "ByteArrayOutputStream", "(", ")"], "tokens_order": [14, 4, 7, 142, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["outputObject", "streamByteArrayOutput"], "line": 60, "column": 13, "tokens": ["outputObject", "=", "new", "ObjectOutputStream", "(", "streamByteArrayOutput", ")"], "code": "outputObject = new ObjectOutputStream(streamByteArrayOutput)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR6", "=", "new", "ObjectOutputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 143, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "outputObject"], "line": 61, "column": 13, "tokens": ["outputObject", ".", "writeObject", "(", "data", ")"], "code": "outputObject.writeObject(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR6", ".", "writeObject", "(", "VAR2", ")"], "tokens_order": [15, 3, 144, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayOutput"], "line": 62, "column": 13, "tokens": ["byte", "[", "]", "dataSerialized", "=", "streamByteArrayOutput", ".", "toByteArray", "(", ")"], "code": "byte[] dataSerialized = streamByteArrayOutput.toByteArray()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["byte", "[", "]", "VAR7", "=", "VAR5", ".", "toByteArray", "(", ")"], "tokens_order": [51, 29, 30, 18, 4, 14, 3, 145, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "mtdSignature": "badSink(byte[], javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "13"}], "varibles": ["request", "dataSerialized", "response"], "line": 63, "column": 13, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "(", ")", ")", ".", "badSink", "(", "dataSerialized", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b()).badSink(dataSerialized, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR7", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 18, 8, 5, 8, 10, 2, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 74, "column": 21, "tokens": ["outputObject", "!=", "null"], "code": "outputObject != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 76, "column": 21, "tokens": ["outputObject", ".", "close", "(", ")"], "code": "outputObject.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 86, "column": 21, "tokens": ["streamByteArrayOutput", "!=", "null"], "code": "streamByteArrayOutput != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 88, "column": 21, "tokens": ["streamByteArrayOutput", ".", "close", "(", ")"], "code": "streamByteArrayOutput.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "dataSerialized", "response"], "line": 31, "column": 5, "tokens": ["public", "void", "badSink", "(", "byte", "[", "]", "dataSerialized", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(byte[] dataSerialized, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* unserialize data */\r\n    ByteArrayInputStream streamByteArrayInput = null;\r\n    ObjectInputStream streamObjectInput = null;\r\n    try {\r\n        streamByteArrayInput = new ByteArrayInputStream(dataSerialized);\r\n        streamObjectInput = new ObjectInputStream(streamByteArrayInput);\r\n        String data = (String) streamObjectInput.readObject();\r\n        /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n        if (data != null) {\r\n            File file = new File(data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } catch (IOException exceptIO) {\r\n        IO.logger.log(Level.WARNING, \"IOException in deserialization\", exceptIO);\r\n    } catch (ClassNotFoundException exceptClassNotFound) {\r\n        IO.logger.log(Level.WARNING, \"ClassNotFoundException in deserialization\", exceptClassNotFound);\r\n    } finally {\r\n        /* clean up stream reading objects */\r\n        try {\r\n            if (streamObjectInput != null) {\r\n                streamObjectInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ObjectInputStream\", exceptIO);\r\n        }\r\n        try {\r\n            if (streamByteArrayInput != null) {\r\n                streamByteArrayInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ByteArrayInputStream\", exceptIO);\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["public", "void", "FUN1", "(", "byte", "[", "]", "VAR8", ",", "HttpServletRequest", "VAR9", ",", "HttpServletResponse", "VAR10", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 51, 29, 30, 26, 8, 39, 31, 8, 40, 36, 2, 22, 23]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayInput"], "line": 39, "column": 13, "tokens": ["streamByteArrayInput", "=", "new", "ByteArrayInputStream", "(", "dataSerialized", ")"], "code": "streamByteArrayInput = new ByteArrayInputStream(dataSerialized)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR11", "=", "new", "ByteArrayInputStream", "(", "VAR8", ")"], "tokens_order": [44, 4, 7, 146, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput", "streamObjectInput"], "line": 40, "column": 13, "tokens": ["streamObjectInput", "=", "new", "ObjectInputStream", "(", "streamByteArrayInput", ")"], "code": "streamObjectInput = new ObjectInputStream(streamByteArrayInput)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR12", "=", "new", "ObjectInputStream", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 147, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "streamObjectInput"], "line": 41, "column": 13, "tokens": ["String", "data", "=", "(", "String", ")", "streamObjectInput", ".", "readObject", "(", ")"], "code": "String data = (String) streamObjectInput.readObject()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["String", "VAR13", "=", "(", "String", ")", "VAR12", ".", "readObject", "(", ")"], "tokens_order": [20, 60, 4, 1, 20, 2, 52, 3, 148, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 46, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["File", "VAR14", "=", "new", "File", "(", "VAR13", ")"], "tokens_order": [55, 77, 4, 7, 55, 1, 60, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR14", ".", "exists", "(", ")", "&&", "VAR14", ".", "isFile", "(", ")"], "tokens_order": [77, 3, 194, 1, 2, 76, 77, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR15", "=", "new", "FileInputStream", "(", "VAR14", ")"], "tokens_order": [91, 4, 7, 66, 1, 77, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR16", "=", "new", "InputStreamReader", "(", "VAR15", ",", "\"UTF-8\"", ")"], "tokens_order": [136, 4, 7, 46, 1, 91, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR17", "=", "new", "BufferedReader", "(", "VAR16", ")"], "tokens_order": [173, 4, 7, 45, 1, 136, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR17", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 173, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR17", "!=", "null"], "tokens_order": [173, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR17", ".", "close", "(", ")"], "tokens_order": [173, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR16", "!=", "null"], "tokens_order": [136, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR16", ".", "close", "(", ")"], "tokens_order": [136, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 33, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 119, "column": 21, "tokens": ["streamObjectInput", "!=", "null"], "code": "streamObjectInput != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 34, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 121, "column": 21, "tokens": ["streamObjectInput", ".", "close", "(", ")"], "code": "streamObjectInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 35, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 131, "column": 21, "tokens": ["streamByteArrayInput", "!=", "null"], "code": "streamByteArrayInput != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 36, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 133, "column": 21, "tokens": ["streamByteArrayInput", ".", "close", "(", ")"], "code": "streamByteArrayInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_75b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 7, "target": 8, "type": "DDG"}, {"id": 4, "source": 1, "target": 9, "type": "DDG"}, {"id": 5, "source": 6, "target": 9, "type": "DDG"}, {"id": 6, "source": 8, "target": 9, "type": "DDG"}, {"id": 7, "source": 7, "target": 10, "type": "DDG"}, {"id": 8, "source": 0, "target": 11, "type": "DDG"}, {"id": 9, "source": 10, "target": 11, "type": "DDG"}, {"id": 10, "source": 8, "target": 12, "type": "DDG"}, {"id": 11, "source": 8, "target": 13, "type": "DDG"}, {"id": 12, "source": 7, "target": 14, "type": "DDG"}, {"id": 13, "source": 7, "target": 15, "type": "DDG"}, {"id": 14, "source": 4, "target": 5, "type": "DDG"}, {"id": 15, "source": 4, "target": 6, "type": "DDG"}, {"id": "-1", "source": 11, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 18, "target": 19, "type": "DDG"}, {"id": 3, "source": 19, "target": 20, "type": "DDG"}, {"id": 4, "source": 19, "target": 21, "type": "DDG"}, {"id": 5, "source": 18, "target": 33, "type": "DDG"}, {"id": 6, "source": 18, "target": 34, "type": "DDG"}, {"id": 7, "source": 17, "target": 35, "type": "DDG"}, {"id": 8, "source": 17, "target": 36, "type": "DDG"}, {"id": 9, "source": 21, "target": 22, "type": "DDG"}, {"id": 10, "source": 21, "target": 23, "type": "DDG"}, {"id": 11, "source": 23, "target": 24, "type": "DDG"}, {"id": 12, "source": 24, "target": 25, "type": "DDG"}, {"id": 13, "source": 25, "target": 26, "type": "DDG"}, {"id": 14, "source": 25, "target": 27, "type": "DDG"}, {"id": 15, "source": 25, "target": 28, "type": "DDG"}, {"id": 16, "source": 24, "target": 29, "type": "DDG"}, {"id": 17, "source": 24, "target": 30, "type": "DDG"}, {"id": 18, "source": 23, "target": 31, "type": "DDG"}, {"id": 19, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b()).badSink((Object) data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 35, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 36, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 39, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "mtdSignature": "badSink(java.lang.Object, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 43, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "(", ")", ")", ".", "badSink", "(", "(", "Object", ")", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b()).badSink((Object) data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "(", "Object", ")", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 1, 85, 2, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataObject", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "Object", "dataObject", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(Object dataObject, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = (String) dataObject;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["public", "void", "FUN1", "(", "Object", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 85, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataObject", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "String", ")", "dataObject"], "code": "String data = (String) dataObject", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["String", "VAR7", "=", "(", "String", ")", "VAR4"], "tokens_order": [20, 18, 4, 1, 20, 2, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_71b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 8, "type": "DDG"}, {"id": 2, "source": 7, "target": 9, "type": "DDG"}, {"id": 3, "source": 9, "target": 10, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 13, "target": 15, "type": "DDG"}, {"id": 9, "source": 13, "target": 16, "type": "DDG"}, {"id": 10, "source": 12, "target": 17, "type": "DDG"}, {"id": 11, "source": 12, "target": 18, "type": "DDG"}, {"id": 12, "source": 11, "target": 19, "type": "DDG"}, {"id": 13, "source": 11, "target": 20, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    while (true) {\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n        break;\r\n    }\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["String", "VAR2"], "tokens_order": [20, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 36, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 43, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 47, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 51, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 52, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 53, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 54, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 65, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 67, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 77, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 79, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 89, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 91, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_16", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 4, "type": "DDG"}, {"id": 5, "source": 4, "target": 5, "type": "DDG"}, {"id": 6, "source": 4, "target": 6, "type": "DDG"}, {"id": 7, "source": 6, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 8, "target": 10, "type": "DDG"}, {"id": 11, "source": 8, "target": 11, "type": "DDG"}, {"id": 12, "source": 7, "target": 12, "type": "DDG"}, {"id": 13, "source": 7, "target": 13, "type": "DDG"}, {"id": 14, "source": 6, "target": 14, "type": "DDG"}, {"id": 15, "source": 6, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b()).badSink((Object) data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 32, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "mtdSignature": "badSink(java.lang.Object, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "(", ")", ")", ".", "badSink", "(", "(", "Object", ")", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b()).badSink((Object) data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "(", "Object", ")", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 1, 85, 2, 6, 8, 5, 8, 10, 2]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataObject", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "Object", "dataObject", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(Object dataObject, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = (String) dataObject;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["public", "void", "FUN1", "(", "Object", "VAR3", ",", "HttpServletRequest", "VAR4", ",", "HttpServletResponse", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 85, 9, 8, 39, 11, 8, 40, 14, 2, 22, 23, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataObject", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "String", ")", "dataObject"], "code": "String data = (String) dataObject", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["String", "VAR6", "=", "(", "String", ")", "VAR3"], "tokens_order": [20, 15, 4, 1, 20, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_71b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": 1, "source": 4, "target": 5, "type": "DDG"}, {"id": 2, "source": 4, "target": 6, "type": "DDG"}, {"id": 3, "source": 6, "target": 7, "type": "DDG"}, {"id": 4, "source": 6, "target": 8, "type": "DDG"}, {"id": 5, "source": 8, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 10, "target": 11, "type": "DDG"}, {"id": 8, "source": 10, "target": 12, "type": "DDG"}, {"id": 9, "source": 10, "target": 13, "type": "DDG"}, {"id": 10, "source": 9, "target": 14, "type": "DDG"}, {"id": 11, "source": 9, "target": 15, "type": "DDG"}, {"id": 12, "source": 8, "target": 16, "type": "DDG"}, {"id": 13, "source": 8, "target": 17, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21____goodG2B2", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 234, "column": 5, "tokens": ["private", "void", "goodG2B2", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B2() - use goodsource and badsink by reversing the blocks in the if in the sink function */\r\nprivate void goodG2B2(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    this.goodG2B2_private = true;\r\n    data = goodG2B2_source(request, response);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "mtdSignature": "goodG2B2_source(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "16"}], "varibles": ["request", "data", "response"], "line": 239, "column": 9, "tokens": ["data", "=", "goodG2B2_source", "(", "request", ",", "response", ")"], "code": "data = goodG2B2_source(request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR2", "=", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [6, 4, 25, 1, 5, 8, 10, 2, 0, 0, 0, 0]}, {"id": 2, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 242, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 244, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 248, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 252, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 253, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 254, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 255, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 15, 3, 47, 1, 2, 2, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 266, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 268, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 278, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 280, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 290, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 292, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 312, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR7", "=", "\"foo\""], "tokens_order": [18, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 318, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["VAR7", "=", "null"], "tokens_order": [18, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 321, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_21", "new_tokens": ["return", "VAR7", ";"], "tokens_order": [84, 18, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": 9, "source": 7, "target": 10, "type": "DDG"}, {"id": 10, "source": 6, "target": 11, "type": "DDG"}, {"id": 11, "source": 6, "target": 12, "type": "DDG"}, {"id": 12, "source": 5, "target": 13, "type": "DDG"}, {"id": 13, "source": 5, "target": 14, "type": "DDG"}, {"id": "-1", "source": 17, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 15, "target": 17, "type": "DDG"}, {"id": 1, "source": 16, "target": 17, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__database_71a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__database_71b", "mtdSignature": "badSink(java.lang.Object)", "called_column": "9"}], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__database_71b", "(", ")", ")", ".", "badSink", "(", "(", "Object", ")", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__database_71b()).badSink((Object) data)", "java_file": "CWE36_Absolute_Path_Traversal__database_71a", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "(", "Object", ")", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 1, 85, 2, 9, 2]}, {"id": 11, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataObject"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "Object", "dataObject", ")", "throws", "Throwable"], "code": "public void badSink(Object dataObject) throws Throwable {\r\n    String data = (String) dataObject;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["public", "void", "FUN1", "(", "Object", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 85, 11, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataObject", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "String", ")", "dataObject"], "code": "String data = (String) dataObject", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["String", "VAR5", "=", "(", "String", ")", "VAR4"], "tokens_order": [20, 14, 4, 1, 20, 2, 11, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_71b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 10, "type": "DDG"}, {"id": "-1", "source": 10, "target": 11, "type": "func_call_out"}, {"id": 0, "source": 11, "target": 12, "type": "DDG"}, {"id": 1, "source": 12, "target": 13, "type": "DDG"}, {"id": 2, "source": 12, "target": 14, "type": "DDG"}, {"id": 3, "source": 14, "target": 15, "type": "DDG"}, {"id": 4, "source": 14, "target": 16, "type": "DDG"}, {"id": 5, "source": 16, "target": 17, "type": "DDG"}, {"id": 6, "source": 17, "target": 18, "type": "DDG"}, {"id": 7, "source": 18, "target": 19, "type": "DDG"}, {"id": 8, "source": 18, "target": 20, "type": "DDG"}, {"id": 9, "source": 18, "target": 21, "type": "DDG"}, {"id": 10, "source": 17, "target": 22, "type": "DDG"}, {"id": 11, "source": 17, "target": 23, "type": "DDG"}, {"id": 12, "source": 16, "target": 24, "type": "DDG"}, {"id": 13, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_73a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 120, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR5", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 14, 4, 7, 69, 32, 20, 34, 1, 2]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 121, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR5", ".", "add", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 122, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR5", ".", "add", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 123, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["VAR5", ".", "add", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>)", "called_column": "9"}], "varibles": ["dataLinkedList"], "line": 124, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_73b()).badSink(dataLinkedList)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["public", "void", "FUN0", "(", "LinkedList", "<", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 69, 32, 20, 34, 15, 2, 22, 23, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 89, 1, 35, 2, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_73b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 14, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 15, "type": "DDG"}, {"id": 15, "source": 13, "target": 15, "type": "DDG"}, {"id": 16, "source": 4, "target": 16, "type": "DDG"}, {"id": 17, "source": 13, "target": 16, "type": "DDG"}, {"id": 18, "source": 13, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 19, "type": "DDG"}, {"id": 1, "source": 19, "target": 20, "type": "DDG"}, {"id": 2, "source": 19, "target": 21, "type": "DDG"}, {"id": 3, "source": 21, "target": 22, "type": "DDG"}, {"id": 4, "source": 21, "target": 23, "type": "DDG"}, {"id": 5, "source": 23, "target": 24, "type": "DDG"}, {"id": 6, "source": 24, "target": 25, "type": "DDG"}, {"id": 7, "source": 25, "target": 26, "type": "DDG"}, {"id": 8, "source": 25, "target": 27, "type": "DDG"}, {"id": 9, "source": 25, "target": 28, "type": "DDG"}, {"id": 10, "source": 24, "target": 29, "type": "DDG"}, {"id": 11, "source": 24, "target": 30, "type": "DDG"}, {"id": 12, "source": 23, "target": 31, "type": "DDG"}, {"id": 13, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    String[] dataArray = new String[5];\r\n    dataArray[2] = data;\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b()).badSink(dataArray, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 32, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 34, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a", "new_tokens": ["String", "[", "]", "VAR3", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 9, 4, 7, 20, 29, 73, 30, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 35, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a", "new_tokens": ["VAR3", "[", "2", "]", "=", "VAR2"], "tokens_order": [9, 29, 35, 30, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "mtdSignature": "badSink(java.lang.String[], javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataArray", "request", "response"], "line": 36, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "(", ")", ")", ".", "badSink", "(", "dataArray", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b()).badSink(dataArray, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "dataArray", "[", "]", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String[] dataArray, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataArray[2];\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", "[", "]", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 29, 30, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 6, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["String", "VAR7", "=", "VAR4", "[", "2", "]"], "tokens_order": [20, 18, 4, 11, 29, 35, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_66b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": 1, "source": 6, "target": 7, "type": "DDG"}, {"id": 2, "source": 6, "target": 8, "type": "DDG"}, {"id": 3, "source": 8, "target": 9, "type": "DDG"}, {"id": 4, "source": 8, "target": 10, "type": "DDG"}, {"id": 5, "source": 10, "target": 11, "type": "DDG"}, {"id": 6, "source": 11, "target": 12, "type": "DDG"}, {"id": 7, "source": 12, "target": 13, "type": "DDG"}, {"id": 8, "source": 12, "target": 14, "type": "DDG"}, {"id": 9, "source": 12, "target": 15, "type": "DDG"}, {"id": 10, "source": 11, "target": 16, "type": "DDG"}, {"id": 11, "source": 11, "target": 17, "type": "DDG"}, {"id": 12, "source": 10, "target": 18, "type": "DDG"}, {"id": 13, "source": 10, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_17____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["int", "VAR5", "=", "0"], "tokens_order": [19, 14, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR5", "<", "1"], "tokens_order": [14, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 120, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR5", "++"], "tokens_order": [14, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 125, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 11, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 129, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 133, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 134, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 135, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 136, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 31, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 147, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 149, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 159, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 161, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 171, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 173, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_17", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 15, "target": 14, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 16, "type": "DDG"}, {"id": 15, "source": 4, "target": 17, "type": "DDG"}, {"id": 16, "source": 15, "target": 15, "type": "DDG"}, {"id": 17, "source": 13, "target": 15, "type": "DDG"}, {"id": 18, "source": 17, "target": 18, "type": "DDG"}, {"id": 19, "source": 17, "target": 19, "type": "DDG"}, {"id": 20, "source": 19, "target": 20, "type": "DDG"}, {"id": 21, "source": 20, "target": 21, "type": "DDG"}, {"id": 22, "source": 21, "target": 22, "type": "DDG"}, {"id": 23, "source": 21, "target": 23, "type": "DDG"}, {"id": 24, "source": 21, "target": 24, "type": "DDG"}, {"id": 25, "source": 20, "target": 25, "type": "DDG"}, {"id": 26, "source": 20, "target": 26, "type": "DDG"}, {"id": 27, "source": 19, "target": 27, "type": "DDG"}, {"id": 28, "source": 19, "target": 28, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_17____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["int", "VAR4", "=", "0"], "tokens_order": [19, 11, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR4", "<", "1"], "tokens_order": [11, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 105, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR4", "++"], "tokens_order": [11, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 108, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 110, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 114, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 118, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 119, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 120, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 121, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 132, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 134, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 144, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 146, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 156, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 158, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_17", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 12, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 13, "type": "DDG"}, {"id": 12, "source": 3, "target": 14, "type": "DDG"}, {"id": 13, "source": 12, "target": 12, "type": "DDG"}, {"id": 14, "source": 10, "target": 12, "type": "DDG"}, {"id": 15, "source": 14, "target": 15, "type": "DDG"}, {"id": 16, "source": 14, "target": 16, "type": "DDG"}, {"id": 17, "source": 16, "target": 17, "type": "DDG"}, {"id": 18, "source": 17, "target": 18, "type": "DDG"}, {"id": 19, "source": 18, "target": 19, "type": "DDG"}, {"id": 20, "source": 18, "target": 20, "type": "DDG"}, {"id": 21, "source": 18, "target": 21, "type": "DDG"}, {"id": 22, "source": 17, "target": 22, "type": "DDG"}, {"id": 23, "source": 17, "target": 23, "type": "DDG"}, {"id": 24, "source": 16, "target": 24, "type": "DDG"}, {"id": 25, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Property_61a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Property_61b", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__Property_61b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "String data = (new CWE36_Absolute_Path_Traversal__Property_61b()).badSource()", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["String", "VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Property_61a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "code": "data = System.getProperty(\"user.home\")", "java_file": "CWE36_Absolute_Path_Traversal__Property_61b", "new_tokens": ["VAR5", "=", "System", ".", "getProperty", "(", "\"user.home\"", ")"], "tokens_order": [14, 4, 82, 3, 74, 1, 122, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 15, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__Property_61b", "new_tokens": ["return", "VAR5", ";"], "tokens_order": [84, 14, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 15, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_31____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 46, "column": 17, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 52, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 53, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 58, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "dataCopy"], "line": 93, "column": 13, "tokens": ["dataCopy", "=", "data"], "code": "dataCopy = data", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR4", "=", "VAR3"], "tokens_order": [11, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataCopy", "data"], "line": 96, "column": 13, "tokens": ["String", "data", "=", "dataCopy"], "code": "String data = dataCopy", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["String", "VAR3", "=", "VAR4"], "tokens_order": [20, 9, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 99, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 101, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 105, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 109, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 110, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 111, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 112, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 123, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 125, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 135, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 137, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 147, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 149, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_31", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": 8, "source": 8, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 14, "target": 15, "type": "DDG"}, {"id": 15, "source": 15, "target": 16, "type": "DDG"}, {"id": 16, "source": 15, "target": 17, "type": "DDG"}, {"id": 17, "source": 15, "target": 18, "type": "DDG"}, {"id": 18, "source": 14, "target": 19, "type": "DDG"}, {"id": 19, "source": 14, "target": 20, "type": "DDG"}, {"id": 20, "source": 13, "target": 21, "type": "DDG"}, {"id": 21, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_02____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 43, "column": 17, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 48, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 49, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 53, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 64, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 76, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 92, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR3", "=", "null"], "tokens_order": [9, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 96, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 98, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 102, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 106, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 107, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 108, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 109, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 120, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 122, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 132, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 134, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 144, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 146, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_02", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 9, "type": "DDG"}, {"id": 1, "source": 8, "target": 9, "type": "DDG"}, {"id": 2, "source": 3, "target": 10, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 10, "target": 11, "type": "DDG"}, {"id": 5, "source": 10, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 14, "target": 15, "type": "DDG"}, {"id": 9, "source": 14, "target": 16, "type": "DDG"}, {"id": 10, "source": 14, "target": 17, "type": "DDG"}, {"id": 11, "source": 13, "target": 18, "type": "DDG"}, {"id": 12, "source": 13, "target": 19, "type": "DDG"}, {"id": 13, "source": 12, "target": 20, "type": "DDG"}, {"id": 14, "source": 12, "target": 21, "type": "DDG"}, {"id": 15, "source": 0, "target": 1, "type": "DDG"}, {"id": 16, "source": 1, "target": 2, "type": "DDG"}, {"id": 17, "source": 2, "target": 3, "type": "DDG"}, {"id": 18, "source": 2, "target": 4, "type": "DDG"}, {"id": 19, "source": 2, "target": 5, "type": "DDG"}, {"id": 20, "source": 1, "target": 6, "type": "DDG"}, {"id": 21, "source": 1, "target": 7, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_17____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 43, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 49, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 50, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 55, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 90, "column": 14, "tokens": ["int", "i", "=", "0"], "code": "int i = 0", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["int", "VAR4", "=", "0"], "tokens_order": [19, 11, 4, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 90, "column": 25, "tokens": ["i", "<", "1"], "code": "i < 1", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR4", "<", "1"], "tokens_order": [11, 32, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "UnaryExpr", "mtdCallInfo": [], "varibles": ["i"], "line": 90, "column": 32, "tokens": ["i", "++"], "code": "i++", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR4", "++"], "tokens_order": [11, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 93, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 95, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 99, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 103, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 104, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 105, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 106, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 117, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 119, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 129, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 131, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 141, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 143, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_17", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 8, "target": 9, "type": "DDG"}, {"id": 8, "source": 10, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 3, "target": 12, "type": "DDG"}, {"id": 11, "source": 8, "target": 10, "type": "DDG"}, {"id": 12, "source": 10, "target": 10, "type": "DDG"}, {"id": 13, "source": 12, "target": 13, "type": "DDG"}, {"id": 14, "source": 12, "target": 14, "type": "DDG"}, {"id": 15, "source": 14, "target": 15, "type": "DDG"}, {"id": 16, "source": 15, "target": 16, "type": "DDG"}, {"id": 17, "source": 16, "target": 17, "type": "DDG"}, {"id": 18, "source": 16, "target": 18, "type": "DDG"}, {"id": 19, "source": 16, "target": 19, "type": "DDG"}, {"id": 20, "source": 15, "target": 20, "type": "DDG"}, {"id": 21, "source": 15, "target": 21, "type": "DDG"}, {"id": 22, "source": 14, "target": 22, "type": "DDG"}, {"id": 23, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_21____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "mtdSignature": "bad_source()", "called_column": "16"}], "varibles": ["data"], "line": 43, "column": 9, "tokens": ["data", "=", "bad_source", "(", ")"], "code": "data = bad_source()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR0", "=", "FUN0", "(", ")"], "tokens_order": [5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 46, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 125, "column": 21, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [14, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 126, "column": 21, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", "=", "VAR5", ".", "accept", "(", ")"], "tokens_order": [15, 4, 14, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 128, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 3, 58, 1, 2, 8, 42, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 129, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 131, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 142, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 144, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 154, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 156, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 167, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 169, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 179, "column": 29, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 181, "column": 29, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 195, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["VAR9", "=", "null"], "tokens_order": [31, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 198, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_21", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 28, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 18, "target": 28, "type": "DDG"}, {"id": 1, "source": 27, "target": 28, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 15, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 17, "target": 19, "type": "DDG"}, {"id": 7, "source": 17, "target": 20, "type": "DDG"}, {"id": 8, "source": 16, "target": 21, "type": "DDG"}, {"id": 9, "source": 16, "target": 22, "type": "DDG"}, {"id": 10, "source": 15, "target": 23, "type": "DDG"}, {"id": 11, "source": 15, "target": 24, "type": "DDG"}, {"id": 12, "source": 14, "target": 25, "type": "DDG"}, {"id": 13, "source": 14, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_74a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 105, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR4", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 11, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 106, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "0", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 33, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 107, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "1", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 37, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 108, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["VAR4", ".", "put", "(", "2", ",", "VAR3", ")"], "tokens_order": [11, 3, 64, 1, 35, 8, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 109, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_74b()).badSink(dataHashMap)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 14, 2, 22, 23, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "get", "(", "2", ")"], "tokens_order": [20, 15, 4, 14, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_74b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 12, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 3, "target": 13, "type": "DDG"}, {"id": 14, "source": 10, "target": 13, "type": "DDG"}, {"id": 15, "source": 10, "target": 14, "type": "DDG"}, {"id": "-1", "source": 14, "target": 15, "type": "func_call_out"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": 1, "source": 16, "target": 17, "type": "DDG"}, {"id": 2, "source": 16, "target": 18, "type": "DDG"}, {"id": 3, "source": 18, "target": 19, "type": "DDG"}, {"id": 4, "source": 18, "target": 20, "type": "DDG"}, {"id": 5, "source": 20, "target": 21, "type": "DDG"}, {"id": 6, "source": 21, "target": 22, "type": "DDG"}, {"id": 7, "source": 22, "target": 23, "type": "DDG"}, {"id": 8, "source": 22, "target": 24, "type": "DDG"}, {"id": 9, "source": 22, "target": 25, "type": "DDG"}, {"id": 10, "source": 21, "target": 26, "type": "DDG"}, {"id": 11, "source": 21, "target": 27, "type": "DDG"}, {"id": 12, "source": 20, "target": 28, "type": "DDG"}, {"id": 13, "source": 20, "target": 29, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 30, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    while (true) {\r\n        data = \"\";\r\n        /* initialize data in case id is not in query string */\r\n        /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n        {\r\n            StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n            while (tokenizer.hasMoreTokens()) {\r\n                String token = tokenizer.nextToken();\r\n                /* a token will be like \"id=foo\" */\r\n                if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n                {\r\n                    data = token.substring(3);\r\n                    /* set data to \"foo\" */\r\n                    break;\r\n                    /* exit while loop */\r\n                }\r\n            }\r\n        }\r\n        break;\r\n    }\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0]}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["String", "data"], "code": "String data", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["String", "VAR2"], "tokens_order": [20, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 13, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 39, "column": 17, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2], "bad_source": true}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 40, "column": 24, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 42, "column": 21, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 43, "column": 24, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 45, "column": 25, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 54, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 56, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 60, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 64, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 65, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 66, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 67, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 78, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 80, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 90, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 92, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 102, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 104, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_16", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 8, "type": "DDG"}, {"id": 1, "source": 7, "target": 8, "type": "DDG"}, {"id": 2, "source": 2, "target": 8, "type": "DDG"}, {"id": 3, "source": 1, "target": 9, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 2, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 9, "target": 11, "type": "DDG"}, {"id": 8, "source": 11, "target": 12, "type": "DDG"}, {"id": 9, "source": 12, "target": 13, "type": "DDG"}, {"id": 10, "source": 13, "target": 14, "type": "DDG"}, {"id": 11, "source": 13, "target": 15, "type": "DDG"}, {"id": 12, "source": 13, "target": 16, "type": "DDG"}, {"id": 13, "source": 12, "target": 17, "type": "DDG"}, {"id": 14, "source": 12, "target": 18, "type": "DDG"}, {"id": 15, "source": 11, "target": 19, "type": "DDG"}, {"id": 16, "source": 11, "target": 20, "type": "DDG"}, {"id": 17, "source": 0, "target": 3, "type": "DDG"}, {"id": 18, "source": 3, "target": 4, "type": "DDG"}, {"id": 19, "source": 3, "target": 5, "type": "DDG"}, {"id": 20, "source": 5, "target": 6, "type": "DDG"}, {"id": 21, "source": 5, "target": 7, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 35, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 36, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 39, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 43, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR5", ",", "VAR6", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 11, 8, 14, 8, 15, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR7", ",", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 18, 8, 39, 26, 8, 40, 31, 2, 22, 23]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR7", ",", "VAR8", ",", "VAR9", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 18, 8, 26, 8, 31, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR10", ",", "HttpServletRequest", "VAR11", ",", "HttpServletResponse", "VAR12", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 36, 8, 39, 44, 8, 40, 52, 2, 22, 23]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "new_tokens": ["(", "new", "CLS3", "(", ")", ")", ".", "FUN1", "(", "VAR10", ",", "VAR11", ",", "VAR12", ")"], "tokens_order": [1, 7, 92, 1, 2, 2, 3, 25, 1, 36, 8, 44, 8, 52, 2]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR13", ",", "HttpServletRequest", "VAR14", ",", "HttpServletResponse", "VAR15", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 60, 8, 39, 77, 8, 40, 91, 2, 22, 23]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["File", "VAR16", "=", "new", "File", "(", "VAR13", ")"], "tokens_order": [55, 136, 4, 7, 55, 1, 60, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR16", ".", "exists", "(", ")", "&&", "VAR16", ".", "isFile", "(", ")"], "tokens_order": [136, 3, 194, 1, 2, 76, 136, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", "=", "new", "FileInputStream", "(", "VAR16", ")"], "tokens_order": [173, 4, 7, 66, 1, 136, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", "=", "new", "InputStreamReader", "(", "VAR17", ",", "\"UTF-8\"", ")"], "tokens_order": [212, 4, 7, 46, 1, 173, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR19", "=", "new", "BufferedReader", "(", "VAR18", ")"], "tokens_order": [278, 4, 7, 45, 1, 212, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["CLS4", ".", "FUN2", "(", "VAR19", ".", "readLine", "(", ")", ")"], "tokens_order": [164, 3, 57, 1, 278, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR19", "!=", "null"], "tokens_order": [278, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR19", ".", "close", "(", ")"], "tokens_order": [278, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", "!=", "null"], "tokens_order": [212, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", ".", "close", "(", ")"], "tokens_order": [212, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", "!=", "null"], "tokens_order": [173, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", ".", "close", "(", ")"], "tokens_order": [173, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 13, "type": "DDG"}, {"id": 1, "source": 12, "target": 14, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 14, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 18, "target": 20, "type": "DDG"}, {"id": 8, "source": 18, "target": 21, "type": "DDG"}, {"id": 9, "source": 17, "target": 22, "type": "DDG"}, {"id": 10, "source": 17, "target": 23, "type": "DDG"}, {"id": 11, "source": 16, "target": 24, "type": "DDG"}, {"id": 12, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 41, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 50, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 61, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 63, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__PropertiesFile_52b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 73, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__PropertiesFile_52b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__PropertiesFile_52b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR2", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 6, 2]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__PropertiesFile_52c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR3", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 9, 2, 22, 23, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__PropertiesFile_52c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 9, 2]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 2, 0, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["CLS2", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_52c", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 10, "type": "DDG"}, {"id": 1, "source": 9, "target": 11, "type": "DDG"}, {"id": 2, "source": 11, "target": 12, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 14, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 15, "target": 17, "type": "DDG"}, {"id": 8, "source": 15, "target": 18, "type": "DDG"}, {"id": 9, "source": 14, "target": 19, "type": "DDG"}, {"id": 10, "source": 14, "target": 20, "type": "DDG"}, {"id": 11, "source": 13, "target": 21, "type": "DDG"}, {"id": 12, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Environment_12____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 35, "column": 13, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 46, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 11, 3, 47, 1, 2, 2, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_12", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 3, "target": 4, "type": "DDG"}, {"id": 5, "source": 3, "target": 5, "type": "DDG"}, {"id": 6, "source": 5, "target": 6, "type": "DDG"}, {"id": 7, "source": 6, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 7, "target": 9, "type": "DDG"}, {"id": 10, "source": 7, "target": 10, "type": "DDG"}, {"id": 11, "source": 6, "target": 11, "type": "DDG"}, {"id": 12, "source": 6, "target": 12, "type": "DDG"}, {"id": 13, "source": 5, "target": 13, "type": "DDG"}, {"id": 14, "source": 5, "target": 14, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_66a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 48, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 49, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 50, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 55, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 90, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 92, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 102, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["String", "[", "]", "VAR5", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 14, 4, 7, 20, 29, 73, 30, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 103, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["VAR5", "[", "2", "]", "=", "VAR4"], "tokens_order": [14, 29, 35, 30, 4, 11, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_66b", "mtdSignature": "badSink(java.lang.String[])", "called_column": "9"}], "varibles": ["dataArray"], "line": 104, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__File_66b", "(", ")", ")", ".", "badSink", "(", "dataArray", ")"], "code": "(new CWE36_Absolute_Path_Traversal__File_66b()).badSink(dataArray)", "java_file": "CWE36_Absolute_Path_Traversal__File_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "dataArray", "[", "]", ")", "throws", "Throwable"], "code": "public void badSink(String[] dataArray) throws Throwable {\r\n    String data = dataArray[2];\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR6", "[", "]", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 15, 29, 30, 2, 22, 23]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["String", "VAR7", "=", "VAR6", "[", "2", "]"], "tokens_order": [20, 18, 4, 15, 29, 35, 30, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_66b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 11, "target": 12, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 15, "target": 16, "type": "DDG"}, {"id": 2, "source": 15, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 17, "target": 19, "type": "DDG"}, {"id": 5, "source": 19, "target": 20, "type": "DDG"}, {"id": 6, "source": 20, "target": 21, "type": "DDG"}, {"id": 7, "source": 21, "target": 22, "type": "DDG"}, {"id": 8, "source": 21, "target": 23, "type": "DDG"}, {"id": 9, "source": 21, "target": 24, "type": "DDG"}, {"id": 10, "source": 20, "target": 25, "type": "DDG"}, {"id": 11, "source": 20, "target": 26, "type": "DDG"}, {"id": 12, "source": 19, "target": 27, "type": "DDG"}, {"id": 13, "source": 19, "target": 28, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_02____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 48, "column": 21, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 50, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 53, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 64, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 76, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 89, "column": 29, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 91, "column": 29, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 105, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR3", "=", "null"], "tokens_order": [9, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 109, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 111, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 115, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 119, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 120, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 121, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 122, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 133, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 135, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 145, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 147, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 157, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 159, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_02", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 11, "type": "DDG"}, {"id": 1, "source": 10, "target": 11, "type": "DDG"}, {"id": 2, "source": 3, "target": 12, "type": "DDG"}, {"id": 3, "source": 10, "target": 12, "type": "DDG"}, {"id": 4, "source": 12, "target": 13, "type": "DDG"}, {"id": 5, "source": 12, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 16, "target": 17, "type": "DDG"}, {"id": 9, "source": 16, "target": 18, "type": "DDG"}, {"id": 10, "source": 16, "target": 19, "type": "DDG"}, {"id": 11, "source": 15, "target": 20, "type": "DDG"}, {"id": 12, "source": 15, "target": 21, "type": "DDG"}, {"id": 13, "source": 14, "target": 22, "type": "DDG"}, {"id": 14, "source": 14, "target": 23, "type": "DDG"}, {"id": 15, "source": 0, "target": 1, "type": "DDG"}, {"id": 16, "source": 1, "target": 2, "type": "DDG"}, {"id": 17, "source": 2, "target": 3, "type": "DDG"}, {"id": 18, "source": 2, "target": 4, "type": "DDG"}, {"id": 19, "source": 2, "target": 5, "type": "DDG"}, {"id": 20, "source": 1, "target": 6, "type": "DDG"}, {"id": 21, "source": 1, "target": 7, "type": "DDG"}, {"id": 22, "source": 0, "target": 8, "type": "DDG"}, {"id": 23, "source": 0, "target": 9, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__console_readLine_54a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 49, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 59, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 61, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 71, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 73, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_54b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 84, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_54b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_54b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 9, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__console_readLine_54c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_54c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_54c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_54c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__console_readLine_54d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_54d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_54d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_54d()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 14, 2]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__console_readLine_54e()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 15, 2, 22, 23, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_54e", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_54e()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54d", "new_tokens": ["(", "new", "CLS3", "(", ")", ")", ".", "FUN0", "(", "VAR6", ")"], "tokens_order": [1, 7, 92, 1, 2, 2, 3, 16, 1, 15, 2]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 18, 2, 22, 23, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["CLS4", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [164, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_54e", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 14, "target": 16, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 16, "target": 18, "type": "DDG"}, {"id": 4, "source": 18, "target": 19, "type": "DDG"}, {"id": 5, "source": 19, "target": 20, "type": "DDG"}, {"id": 6, "source": 20, "target": 21, "type": "DDG"}, {"id": 7, "source": 20, "target": 22, "type": "DDG"}, {"id": 8, "source": 20, "target": 23, "type": "DDG"}, {"id": 9, "source": 19, "target": 24, "type": "DDG"}, {"id": 10, "source": 19, "target": 25, "type": "DDG"}, {"id": 11, "source": 18, "target": 26, "type": "DDG"}, {"id": 12, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 52, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 57, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 59, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b()).goodG2BSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR3", ",", "HttpServletRequest", "VAR4", ",", "HttpServletResponse", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 9, 8, 39, 11, 8, 40, 14, 2, 22, 23]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c()).goodG2BSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR4", ",", "VAR5", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 8, 11, 8, 14, 2]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR6", ",", "HttpServletRequest", "VAR7", ",", "HttpServletResponse", "VAR8", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 15, 8, 39, 18, 8, 40, 26, 2, 22, 23]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d()).goodG2BSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR6", ",", "VAR7", ",", "VAR8", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 15, 8, 18, 8, 26, 2]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e()).goodG2BSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR9", ",", "HttpServletRequest", "VAR10", ",", "HttpServletResponse", "VAR11", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 31, 8, 39, 36, 8, 40, 44, 2, 22, 23]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "mtdSignature": "goodG2BSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "(", ")", ")", ".", "goodG2BSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e()).goodG2BSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54d", "new_tokens": ["(", "new", "CLS3", "(", ")", ")", ".", "FUN1", "(", "VAR9", ",", "VAR10", ",", "VAR11", ")"], "tokens_order": [1, 7, 92, 1, 2, 2, 3, 25, 1, 31, 8, 36, 8, 44, 2]}, {"id": 9, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 96, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR12", ",", "HttpServletRequest", "VAR13", ",", "HttpServletResponse", "VAR14", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 52, 8, 39, 60, 8, 40, 77, 2, 22, 23]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 100, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 102, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["File", "VAR15", "=", "new", "File", "(", "VAR12", ")"], "tokens_order": [55, 91, 4, 7, 55, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 106, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR15", ".", "exists", "(", ")", "&&", "VAR15", ".", "isFile", "(", ")"], "tokens_order": [91, 3, 194, 1, 2, 76, 91, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 110, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR16", "=", "new", "FileInputStream", "(", "VAR15", ")"], "tokens_order": [136, 4, 7, 66, 1, 91, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 111, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", "=", "new", "InputStreamReader", "(", "VAR16", ",", "\"UTF-8\"", ")"], "tokens_order": [173, 4, 7, 46, 1, 136, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 112, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", "=", "new", "BufferedReader", "(", "VAR17", ")"], "tokens_order": [212, 4, 7, 45, 1, 173, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 113, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["CLS4", ".", "FUN2", "(", "VAR18", ".", "readLine", "(", ")", ")"], "tokens_order": [164, 3, 57, 1, 212, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 124, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", "!=", "null"], "tokens_order": [212, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR18", ".", "close", "(", ")"], "tokens_order": [212, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 136, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", "!=", "null"], "tokens_order": [173, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR17", ".", "close", "(", ")"], "tokens_order": [173, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 148, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR16", "!=", "null"], "tokens_order": [136, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_54e", "new_tokens": ["VAR16", ".", "close", "(", ")"], "tokens_order": [136, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": "-1", "source": 8, "target": 9, "type": "func_call_out"}, {"id": 0, "source": 9, "target": 10, "type": "DDG"}, {"id": 1, "source": 9, "target": 11, "type": "DDG"}, {"id": 2, "source": 11, "target": 12, "type": "DDG"}, {"id": 3, "source": 11, "target": 13, "type": "DDG"}, {"id": 4, "source": 13, "target": 14, "type": "DDG"}, {"id": 5, "source": 14, "target": 15, "type": "DDG"}, {"id": 6, "source": 15, "target": 16, "type": "DDG"}, {"id": 7, "source": 15, "target": 17, "type": "DDG"}, {"id": 8, "source": 15, "target": 18, "type": "DDG"}, {"id": 9, "source": 14, "target": 19, "type": "DDG"}, {"id": 10, "source": 14, "target": 20, "type": "DDG"}, {"id": 11, "source": 13, "target": 21, "type": "DDG"}, {"id": 12, "source": 13, "target": 22, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_73a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 125, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR1", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 10, 4, 7, 69, 32, 20, 34, 1, 2]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 126, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", ".", "add", "(", "0", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 33, 8, 5, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 127, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", ".", "add", "(", "1", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 37, 8, 5, 2, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 128, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", ".", "add", "(", "2", ",", "VAR0", ")"], "tokens_order": [10, 3, 53, 1, 35, 8, 5, 2, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "mtdSignature": "goodG2BSink(java.util.LinkedList<java.lang.String>)", "called_column": "9"}], "varibles": ["dataLinkedList"], "line": 129, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "(", ")", ")", ".", "goodG2BSink", "(", "dataLinkedList", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_73b()).goodG2BSink(dataLinkedList)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2, 0, 0]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 98, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(LinkedList<String> dataLinkedList) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["public", "void", "FUN0", "(", "LinkedList", "<", "String", ">", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 69, 32, 20, 34, 6, 2, 22, 23, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 100, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "remove", "(", "2", ")"], "tokens_order": [20, 9, 4, 6, 3, 89, 1, 35, 2, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 103, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 105, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 109, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 114, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 115, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 116, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 127, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 129, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 139, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 141, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 151, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 153, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 3, "type": "DDG"}, {"id": 4, "source": 0, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 4, "type": "DDG"}, {"id": 6, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 7, "target": 8, "type": "DDG"}, {"id": 2, "source": 7, "target": 9, "type": "DDG"}, {"id": 3, "source": 9, "target": 10, "type": "DDG"}, {"id": 4, "source": 9, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 13, "target": 14, "type": "DDG"}, {"id": 8, "source": 13, "target": 15, "type": "DDG"}, {"id": 9, "source": 13, "target": 16, "type": "DDG"}, {"id": 10, "source": 12, "target": 17, "type": "DDG"}, {"id": 11, "source": 12, "target": 18, "type": "DDG"}, {"id": 12, "source": 11, "target": 19, "type": "DDG"}, {"id": 13, "source": 11, "target": 20, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 57, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>();\r\n    dataHashMap.put(0, data);\r\n    dataHashMap.put(1, data);\r\n    dataHashMap.put(2, data);\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b()).goodG2BSink(dataHashMap, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 62, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 64, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR3", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 9, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 65, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["VAR3", ".", "put", "(", "0", ",", "VAR2", ")"], "tokens_order": [9, 3, 64, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 66, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["VAR3", ".", "put", "(", "1", ",", "VAR2", ")"], "tokens_order": [9, 3, 64, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 67, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["VAR3", ".", "put", "(", "2", ",", "VAR2", ")"], "tokens_order": [9, 3, 64, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "mtdSignature": "goodG2BSink(java.util.HashMap<java.lang.Integer, java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataHashMap"], "line": 68, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "(", ")", ")", ".", "goodG2BSink", "(", "dataHashMap", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b()).goodG2BSink(dataHashMap, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataHashMap"], "line": 98, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(HashMap<Integer, String> dataHashMap, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["public", "void", "FUN1", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 63, 32, 50, 8, 20, 34, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 100, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "get", "(", "2", ")"], "tokens_order": [20, 18, 4, 11, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 103, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 105, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 109, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 114, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 115, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 116, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 127, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 129, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 139, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 141, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 151, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 153, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_74b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 3, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 2, "target": 5, "type": "DDG"}, {"id": 6, "source": 0, "target": 6, "type": "DDG"}, {"id": 7, "source": 2, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 8, "target": 9, "type": "DDG"}, {"id": 2, "source": 8, "target": 10, "type": "DDG"}, {"id": 3, "source": 10, "target": 11, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 14, "target": 16, "type": "DDG"}, {"id": 9, "source": 14, "target": 17, "type": "DDG"}, {"id": 10, "source": 13, "target": 18, "type": "DDG"}, {"id": 11, "source": 13, "target": 19, "type": "DDG"}, {"id": 12, "source": 12, "target": 20, "type": "DDG"}, {"id": 13, "source": 12, "target": 21, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_67a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 45, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 53, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 54, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 55, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 95, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 97, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 107, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["Container", "VAR5", "=", "new", "Container", "(", ")"], "tokens_order": [56, 14, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 108, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["VAR5", ".", "containerOne", "=", "VAR4"], "tokens_order": [14, 3, 70, 4, 11, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_67b", "mtdSignature": "badSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__File_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 109, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__File_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__File_67b()).badSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__File_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2]}, {"id": 14, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE36_Absolute_Path_Traversal__File_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE36_Absolute_Path_Traversal__File_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__File_67a", ".", "Container", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 15, 2, 22, 23]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "containerOne"], "tokens_order": [20, 18, 4, 15, 3, 70, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0], "bad_sink": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_67b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 11, "target": 12, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 11, "target": 13, "type": "DDG"}, {"id": "-1", "source": 13, "target": 14, "type": "func_call_out"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 15, "target": 16, "type": "DDG"}, {"id": 2, "source": 15, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 17, "target": 19, "type": "DDG"}, {"id": 5, "source": 19, "target": 20, "type": "DDG"}, {"id": 6, "source": 20, "target": 21, "type": "DDG"}, {"id": 7, "source": 21, "target": 22, "type": "DDG"}, {"id": 8, "source": 21, "target": 23, "type": "DDG"}, {"id": 9, "source": 21, "target": 24, "type": "DDG"}, {"id": 10, "source": 20, "target": 25, "type": "DDG"}, {"id": 11, "source": 20, "target": 26, "type": "DDG"}, {"id": 12, "source": 19, "target": 27, "type": "DDG"}, {"id": 13, "source": 19, "target": 28, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__database_22a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__database_22b", "mtdSignature": "badSource()", "called_column": "16"}], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__database_22b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "data = (new CWE36_Absolute_Path_Traversal__database_22b()).badSource()", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 40, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 42, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 46, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 50, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 51, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 52, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 53, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 64, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 66, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 76, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 78, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 88, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 90, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "34"}], "varibles": ["connection"], "line": 48, "column": 21, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR5", "=", "CLS1", ".", "FUN2", "(", ")"], "tokens_order": [14, 4, 38, 3, 57, 1, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 50, "column": 21, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR6", "=", "VAR5", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [15, 4, 14, 3, 79, 1, 112, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 51, "column": 21, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR7", "=", "VAR6", ".", "executeQuery", "(", ")"], "tokens_order": [18, 4, 15, 3, 90, 1, 2, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 53, "column": 21, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR8", "=", "VAR7", ".", "getString", "(", "1", ")"], "tokens_order": [26, 4, 18, 3, 113, 1, 37, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 64, "column": 29, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 29, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 76, "column": 29, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 29, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 88, "column": 29, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 29, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 104, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["VAR8", "=", "null"], "tokens_order": [26, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 106, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__database_22b", "new_tokens": ["return", "VAR8", ";"], "tokens_order": [84, 26, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 25, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 17, "target": 25, "type": "DDG"}, {"id": 1, "source": 24, "target": 25, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 15, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 16, "target": 18, "type": "DDG"}, {"id": 6, "source": 16, "target": 19, "type": "DDG"}, {"id": 7, "source": 15, "target": 20, "type": "DDG"}, {"id": 8, "source": 15, "target": 21, "type": "DDG"}, {"id": 9, "source": 14, "target": 22, "type": "DDG"}, {"id": 10, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 34, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 35, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 38, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 42, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 33, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 37, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 41, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 43, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 44, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 55, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 67, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 79, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_51b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 4, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 6, "target": 8, "type": "DDG"}, {"id": 2, "source": 8, "target": 9, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 10, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 12, "target": 14, "type": "DDG"}, {"id": 8, "source": 12, "target": 15, "type": "DDG"}, {"id": 9, "source": 11, "target": 16, "type": "DDG"}, {"id": 10, "source": 11, "target": 17, "type": "DDG"}, {"id": 11, "source": 10, "target": 18, "type": "DDG"}, {"id": 12, "source": 10, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_61a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "String data = (new CWE36_Absolute_Path_Traversal__listen_tcp_61b()).badSource()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["String", "VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR5", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [14, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR6", "=", "VAR5", ".", "accept", "(", ")"], "tokens_order": [15, 4, 14, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 55, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 3, 58, 1, 2, 8, 42, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 56, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 107, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 109, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_61b", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 27, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 15, "target": 16, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 17, "target": 19, "type": "DDG"}, {"id": 5, "source": 17, "target": 20, "type": "DDG"}, {"id": 6, "source": 16, "target": 21, "type": "DDG"}, {"id": 7, "source": 16, "target": 22, "type": "DDG"}, {"id": 8, "source": 15, "target": 23, "type": "DDG"}, {"id": 9, "source": 15, "target": 24, "type": "DDG"}, {"id": 10, "source": 14, "target": 25, "type": "DDG"}, {"id": 11, "source": 14, "target": 26, "type": "DDG"}, {"id": 12, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 32, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR3", ",", "HttpServletRequest", "VAR4", ",", "HttpServletResponse", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 9, 8, 39, 11, 8, 40, 14, 2, 22, 23]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR4", ",", "VAR5", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 9, 8, 11, 8, 14, 2]}, {"id": 5, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR6", ",", "HttpServletRequest", "VAR7", ",", "HttpServletResponse", "VAR8", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 15, 8, 39, 18, 8, 40, 26, 2, 22, 23]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR6", ",", "VAR7", ",", "VAR8", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 15, 8, 18, 8, 26, 2]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR9", ",", "HttpServletRequest", "VAR10", ",", "HttpServletResponse", "VAR11", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 31, 8, 39, 36, 8, 40, 44, 2, 22, 23]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["File", "VAR12", "=", "new", "File", "(", "VAR9", ")"], "tokens_order": [55, 52, 4, 7, 55, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR12", ".", "exists", "(", ")", "&&", "VAR12", ".", "isFile", "(", ")"], "tokens_order": [52, 3, 194, 1, 2, 76, 52, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR13", "=", "new", "FileInputStream", "(", "VAR12", ")"], "tokens_order": [60, 4, 7, 66, 1, 52, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR14", "=", "new", "InputStreamReader", "(", "VAR13", ",", "\"UTF-8\"", ")"], "tokens_order": [77, 4, 7, 46, 1, 60, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR15", "=", "new", "BufferedReader", "(", "VAR14", ")"], "tokens_order": [91, 4, 7, 45, 1, 77, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["CLS3", ".", "FUN2", "(", "VAR15", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 57, 1, 91, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_53d", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": "-1", "source": 4, "target": 5, "type": "func_call_out"}, {"id": 0, "source": 5, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 7, "target": 9, "type": "DDG"}, {"id": 2, "source": 9, "target": 10, "type": "DDG"}, {"id": 3, "source": 9, "target": 11, "type": "DDG"}, {"id": 4, "source": 11, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 13, "target": 15, "type": "DDG"}, {"id": 8, "source": 13, "target": 16, "type": "DDG"}, {"id": 9, "source": 12, "target": 17, "type": "DDG"}, {"id": 10, "source": 12, "target": 18, "type": "DDG"}, {"id": 11, "source": 11, "target": 19, "type": "DDG"}, {"id": 12, "source": 11, "target": 20, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 110, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 112, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 113, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "mtdSignature": "goodG2BSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__URLConnection_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 114, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__URLConnection_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__URLConnection_67b()).goodG2BSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 97, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE36_Absolute_Path_Traversal__URLConnection_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE36_Absolute_Path_Traversal__URLConnection_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__URLConnection_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 99, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 104, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 108, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 112, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 114, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 115, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 128, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 140, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 152, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_67b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 6, "type": "DDG"}, {"id": 2, "source": 5, "target": 7, "type": "DDG"}, {"id": 3, "source": 7, "target": 8, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 11, "target": 13, "type": "DDG"}, {"id": 9, "source": 11, "target": 14, "type": "DDG"}, {"id": 10, "source": 10, "target": 15, "type": "DDG"}, {"id": 11, "source": 10, "target": 16, "type": "DDG"}, {"id": 12, "source": 9, "target": 17, "type": "DDG"}, {"id": 13, "source": 9, "target": 18, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_22a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_22b", "mtdSignature": "badSource()", "called_column": "16"}], "varibles": ["data"], "line": 37, "column": 9, "tokens": ["data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__File_22b", "(", ")", ")", ".", "badSource", "(", ")"], "code": "data = (new CWE36_Absolute_Path_Traversal__File_22b()).badSource()", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 40, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 42, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 46, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 50, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 51, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 52, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 53, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 64, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 66, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 76, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 78, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 88, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 90, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 42, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 114, 2, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 49, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 50, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 55, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 90, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 92, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 106, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["VAR9", "=", "null"], "tokens_order": [31, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 108, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__File_22b", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 26, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 18, "target": 26, "type": "DDG"}, {"id": 1, "source": 25, "target": 26, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 15, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 17, "target": 19, "type": "DDG"}, {"id": 7, "source": 17, "target": 20, "type": "DDG"}, {"id": 8, "source": 16, "target": 21, "type": "DDG"}, {"id": 9, "source": 16, "target": 22, "type": "DDG"}, {"id": 10, "source": 15, "target": 23, "type": "DDG"}, {"id": 11, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__PropertiesFile_12____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 42, "column": 17, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 21, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 49, "column": 21, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 60, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 62, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 76, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 81, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 83, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 87, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 91, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 92, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 93, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 94, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 105, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 107, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 117, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 119, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 129, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 131, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_12", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 3, "target": 7, "type": "DDG"}, {"id": 1, "source": 6, "target": 7, "type": "DDG"}, {"id": 2, "source": 3, "target": 8, "type": "DDG"}, {"id": 3, "source": 6, "target": 8, "type": "DDG"}, {"id": 4, "source": 8, "target": 9, "type": "DDG"}, {"id": 5, "source": 8, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 12, "target": 13, "type": "DDG"}, {"id": 9, "source": 12, "target": 14, "type": "DDG"}, {"id": 10, "source": 12, "target": 15, "type": "DDG"}, {"id": 11, "source": 11, "target": 16, "type": "DDG"}, {"id": 12, "source": 11, "target": 17, "type": "DDG"}, {"id": 13, "source": 10, "target": 18, "type": "DDG"}, {"id": 14, "source": 10, "target": 19, "type": "DDG"}, {"id": 15, "source": 0, "target": 2, "type": "DDG"}, {"id": 16, "source": 1, "target": 2, "type": "DDG"}, {"id": 17, "source": 0, "target": 3, "type": "DDG"}, {"id": 18, "source": 1, "target": 4, "type": "DDG"}, {"id": 19, "source": 1, "target": 5, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Environment_53a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53a", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Environment_53b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__Environment_53b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__Environment_53b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR0", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 5, 2]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__Environment_53c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Environment_53c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__Environment_53c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__Environment_53c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__Environment_53d()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 6, 2, 22, 23, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Environment_53d", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__Environment_53d", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__Environment_53d()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR2", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 6, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR3", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 9, 2, 22, 23, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0], "bad_sink": true}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["CLS3", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_53d", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": 1, "source": 6, "target": 8, "type": "DDG"}, {"id": 2, "source": 8, "target": 9, "type": "DDG"}, {"id": 3, "source": 8, "target": 10, "type": "DDG"}, {"id": 4, "source": 10, "target": 11, "type": "DDG"}, {"id": 5, "source": 11, "target": 12, "type": "DDG"}, {"id": 6, "source": 12, "target": 13, "type": "DDG"}, {"id": 7, "source": 12, "target": 14, "type": "DDG"}, {"id": 8, "source": 12, "target": 15, "type": "DDG"}, {"id": 9, "source": 11, "target": 16, "type": "DDG"}, {"id": 10, "source": 11, "target": 17, "type": "DDG"}, {"id": 11, "source": 10, "target": 18, "type": "DDG"}, {"id": 12, "source": 10, "target": 19, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__console_readLine_66a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 49, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 59, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 61, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 71, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 73, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 84, "column": 9, "tokens": ["String", "[", "]", "dataArray", "=", "new", "String", "[", "5", "]"], "code": "String[] dataArray = new String[5]", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["String", "[", "]", "VAR4", "=", "new", "String", "[", "5", "]"], "tokens_order": [20, 29, 30, 11, 4, 7, 20, 29, 73, 30, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 85, "column": 9, "tokens": ["dataArray", "[", "2", "]", "=", "data"], "code": "dataArray[2] = data", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["VAR4", "[", "2", "]", "=", "VAR3"], "tokens_order": [11, 29, 35, 30, 4, 9, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "mtdSignature": "badSink(java.lang.String[])", "called_column": "9"}], "varibles": ["dataArray"], "line": 86, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_66b", "(", ")", ")", ".", "badSink", "(", "dataArray", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_66b()).badSink(dataArray)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataArray"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "dataArray", "[", "]", ")", "throws", "Throwable"], "code": "public void badSink(String[] dataArray) throws Throwable {\r\n    String data = dataArray[2];\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", "[", "]", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 29, 30, 2, 22, 23]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataArray", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataArray", "[", "2", "]"], "code": "String data = dataArray[2]", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["String", "VAR6", "=", "VAR5", "[", "2", "]"], "tokens_order": [20, 15, 4, 14, 29, 35, 30, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0], "bad_sink": true}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_66b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 7, "target": 8, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 11, "target": 12, "type": "DDG"}, {"id": 2, "source": 11, "target": 13, "type": "DDG"}, {"id": 3, "source": 13, "target": 14, "type": "DDG"}, {"id": 4, "source": 13, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 16, "target": 17, "type": "DDG"}, {"id": 7, "source": 17, "target": 18, "type": "DDG"}, {"id": 8, "source": 17, "target": 19, "type": "DDG"}, {"id": 9, "source": 17, "target": 20, "type": "DDG"}, {"id": 10, "source": 16, "target": 21, "type": "DDG"}, {"id": 11, "source": 16, "target": 22, "type": "DDG"}, {"id": 12, "source": 15, "target": 23, "type": "DDG"}, {"id": 13, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n    data = request.getParameter(\"name\");\r\n    LinkedList<String> dataLinkedList = new LinkedList<String>();\r\n    dataLinkedList.add(0, data);\r\n    dataLinkedList.add(1, data);\r\n    dataLinkedList.add(2, data);\r\n    (new CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b()).badSink(dataLinkedList, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 33, "column": 9, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 35, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR3", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 9, 4, 7, 69, 32, 20, 34, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 36, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["VAR3", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 37, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["VAR3", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 38, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["VAR3", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataLinkedList"], "line": 39, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b()).badSink(dataLinkedList, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0, 0]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["public", "void", "FUN1", "(", "LinkedList", "<", "String", ">", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 69, 32, 20, 34, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 11, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_73b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 4, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": 6, "source": 2, "target": 5, "type": "DDG"}, {"id": 7, "source": 0, "target": 6, "type": "DDG"}, {"id": 8, "source": 2, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 8, "target": 9, "type": "DDG"}, {"id": 2, "source": 8, "target": 10, "type": "DDG"}, {"id": 3, "source": 10, "target": 11, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 14, "target": 16, "type": "DDG"}, {"id": 9, "source": 14, "target": 17, "type": "DDG"}, {"id": 10, "source": 13, "target": 18, "type": "DDG"}, {"id": 11, "source": 13, "target": 19, "type": "DDG"}, {"id": 12, "source": 12, "target": 20, "type": "DDG"}, {"id": 13, "source": 12, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_54a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 118, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_54b", "mtdSignature": "goodG2BSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 120, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_54b", "(", ")", ")", ".", "goodG2BSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_54b()).goodG2BSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR0", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 5, 2]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__connect_tcp_54c()).goodG2BSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_54c", "mtdSignature": "goodG2BSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_54c", "(", ")", ")", ".", "goodG2BSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_54c()).goodG2BSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__connect_tcp_54d()).goodG2BSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 6, 2, 22, 23, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_54d", "mtdSignature": "goodG2BSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_54d", "(", ")", ")", ".", "goodG2BSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_54d()).goodG2BSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN0", "(", "VAR2", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 16, 1, 6, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__connect_tcp_54e()).goodG2BSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54d", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR3", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 9, 2, 22, 23, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "mtdSignature": "goodG2BSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 34, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "(", ")", ")", ".", "goodG2BSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_54e()).goodG2BSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54d", "new_tokens": ["(", "new", "CLS3", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 92, 1, 2, 2, 3, 16, 1, 9, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 96, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 100, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 102, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 2, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 106, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 110, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 111, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 112, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 113, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["CLS4", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [164, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 124, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 136, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 148, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_54e", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": 1, "source": 8, "target": 10, "type": "DDG"}, {"id": 2, "source": 10, "target": 11, "type": "DDG"}, {"id": 3, "source": 10, "target": 12, "type": "DDG"}, {"id": 4, "source": 12, "target": 13, "type": "DDG"}, {"id": 5, "source": 13, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 14, "target": 16, "type": "DDG"}, {"id": 8, "source": 14, "target": 17, "type": "DDG"}, {"id": 9, "source": 13, "target": 18, "type": "DDG"}, {"id": 10, "source": 13, "target": 19, "type": "DDG"}, {"id": 11, "source": 12, "target": 20, "type": "DDG"}, {"id": 12, "source": 12, "target": 21, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case id is not in query string */\r\n    /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n    {\r\n        StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n        while (tokenizer.hasMoreTokens()) {\r\n            String token = tokenizer.nextToken();\r\n            /* a token will be like \"id=foo\" */\r\n            if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n            {\r\n                data = token.substring(3);\r\n                /* set data to \"foo\" */\r\n                break;\r\n                /* exit while loop */\r\n            }\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 36, "column": 13, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2, 0], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 37, "column": 20, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 39, "column": 17, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 40, "column": 20, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 42, "column": 21, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 48, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR5", ",", "VAR6", ",", "VAR7", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 14, 8, 15, 8, 18, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR8", ",", "HttpServletRequest", "VAR9", ",", "HttpServletResponse", "VAR10", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 26, 8, 39, 31, 8, 40, 36, 2, 22, 23]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR8", ",", "VAR9", ",", "VAR10", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 26, 8, 31, 8, 36, 2]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR11", ",", "HttpServletRequest", "VAR12", ",", "HttpServletResponse", "VAR13", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 44, 8, 39, 52, 8, 40, 60, 2, 22, 23]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["File", "VAR14", "=", "new", "File", "(", "VAR11", ")"], "tokens_order": [55, 77, 4, 7, 55, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR14", ".", "exists", "(", ")", "&&", "VAR14", ".", "isFile", "(", ")"], "tokens_order": [77, 3, 194, 1, 2, 76, 77, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR15", "=", "new", "FileInputStream", "(", "VAR14", ")"], "tokens_order": [91, 4, 7, 66, 1, 77, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR16", "=", "new", "InputStreamReader", "(", "VAR15", ",", "\"UTF-8\"", ")"], "tokens_order": [136, 4, 7, 46, 1, 91, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR17", "=", "new", "BufferedReader", "(", "VAR16", ")"], "tokens_order": [173, 4, 7, 45, 1, 136, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["CLS3", ".", "FUN2", "(", "VAR17", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 57, 1, 173, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR17", "!=", "null"], "tokens_order": [173, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR17", ".", "close", "(", ")"], "tokens_order": [173, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR16", "!=", "null"], "tokens_order": [136, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR16", ".", "close", "(", ")"], "tokens_order": [136, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_53d", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 7, "type": "DDG"}, {"id": 4, "source": 1, "target": 7, "type": "DDG"}, {"id": 5, "source": 6, "target": 7, "type": "DDG"}, {"id": 6, "source": 4, "target": 5, "type": "DDG"}, {"id": 7, "source": 4, "target": 6, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 13, "type": "DDG"}, {"id": 1, "source": 12, "target": 14, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 14, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 18, "target": 20, "type": "DDG"}, {"id": 8, "source": 18, "target": 21, "type": "DDG"}, {"id": 9, "source": 17, "target": 22, "type": "DDG"}, {"id": 10, "source": 17, "target": 23, "type": "DDG"}, {"id": 11, "source": 16, "target": 24, "type": "DDG"}, {"id": 12, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_81a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 121, "column": 9, "tokens": ["CWE36_Absolute_Path_Traversal__connect_tcp_81_base", "baseObject", "=", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "(", ")"], "code": "CWE36_Absolute_Path_Traversal__connect_tcp_81_base baseObject = new CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81a", "new_tokens": ["CLS0", "VAR1", "=", "new", "VAR", "(", ")"], "tokens_order": [27, 10, 4, 7, 78, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_81_base", "mtdSignature": "action(java.lang.String)", "called_column": "9"}], "varibles": ["data", "baseObject"], "line": 122, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ")"], "code": "baseObject.action(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81a", "new_tokens": ["VAR1", ".", "FUN0", "(", "VAR0", ")"], "tokens_order": [10, 3, 16, 1, 5, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void action(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 6, 2, 22, 23, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_81_goodG2B", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": "-1", "source": 2, "target": 3, "type": "func_call_out"}, {"id": 0, "source": 3, "target": 4, "type": "DDG"}, {"id": 1, "source": 3, "target": 5, "type": "DDG"}, {"id": 2, "source": 5, "target": 6, "type": "DDG"}, {"id": 3, "source": 5, "target": 7, "type": "DDG"}, {"id": 4, "source": 7, "target": 8, "type": "DDG"}, {"id": 5, "source": 8, "target": 9, "type": "DDG"}, {"id": 6, "source": 9, "target": 10, "type": "DDG"}, {"id": 7, "source": 9, "target": 11, "type": "DDG"}, {"id": 8, "source": 9, "target": 12, "type": "DDG"}, {"id": 9, "source": 8, "target": 13, "type": "DDG"}, {"id": 10, "source": 8, "target": 14, "type": "DDG"}, {"id": 11, "source": 7, "target": 15, "type": "DDG"}, {"id": 12, "source": 7, "target": 16, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_42____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "mtdSignature": "badSource()", "called_column": "23"}], "varibles": ["data"], "line": 125, "column": 9, "tokens": ["String", "data", "=", "badSource", "(", ")"], "code": "String data = badSource()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["String", "VAR0", "=", "FUN0", "(", ")"], "tokens_order": [20, 5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 128, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 130, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 134, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 138, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 139, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 140, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 141, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 152, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 154, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 164, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 166, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 176, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 178, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 50, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [14, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 51, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", "=", "VAR5", ".", "accept", "(", ")"], "tokens_order": [15, 4, 14, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 55, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 3, 58, 1, 2, 8, 42, 2]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 56, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 107, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 109, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 119, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_42", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 27, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 14, "target": 15, "type": "DDG"}, {"id": 1, "source": 15, "target": 16, "type": "DDG"}, {"id": 2, "source": 16, "target": 17, "type": "DDG"}, {"id": 3, "source": 17, "target": 18, "type": "DDG"}, {"id": 4, "source": 17, "target": 19, "type": "DDG"}, {"id": 5, "source": 17, "target": 20, "type": "DDG"}, {"id": 6, "source": 16, "target": 21, "type": "DDG"}, {"id": 7, "source": 16, "target": 22, "type": "DDG"}, {"id": 8, "source": 15, "target": 23, "type": "DDG"}, {"id": 9, "source": 15, "target": 24, "type": "DDG"}, {"id": 10, "source": 14, "target": 25, "type": "DDG"}, {"id": 11, "source": 14, "target": 26, "type": "DDG"}, {"id": 12, "source": 18, "target": 27, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a____goodG2B1", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 115, "column": 5, "tokens": ["private", "void", "goodG2B1", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B1() - use goodsource and badsink by setting the static variable to false instead of true */\r\nprivate void goodG2B1(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a.goodG2B1PublicStatic = false;\r\n    data = (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b()).goodG2B1Source(request, response);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b", "mtdSignature": "goodG2B1Source(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "16"}], "varibles": ["request", "data", "response"], "line": 120, "column": 9, "tokens": ["data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b", "(", ")", ")", ".", "goodG2B1Source", "(", "request", ",", "response", ")"], "code": "data = (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b()).goodG2B1Source(request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR0", ",", "VAR1", ")"], "tokens_order": [6, 4, 1, 7, 27, 1, 2, 2, 3, 25, 1, 5, 8, 10, 2]}, {"id": 2, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 123, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 125, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 129, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 133, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 134, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 135, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 136, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 15, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 147, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 149, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 159, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 161, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 171, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 173, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 62, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR7", "=", "null"], "tokens_order": [18, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 68, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["VAR7", "=", "\"foo\""], "tokens_order": [18, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 17, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 72, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_22b", "new_tokens": ["return", "VAR7", ";"], "tokens_order": [84, 18, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 7, "target": 9, "type": "DDG"}, {"id": 9, "source": 7, "target": 10, "type": "DDG"}, {"id": 10, "source": 6, "target": 11, "type": "DDG"}, {"id": 11, "source": 6, "target": 12, "type": "DDG"}, {"id": 12, "source": 5, "target": 13, "type": "DDG"}, {"id": 13, "source": 5, "target": 14, "type": "DDG"}, {"id": "-1", "source": 17, "target": 1, "type": "func_call_in"}, {"id": 0, "source": 15, "target": 17, "type": "DDG"}, {"id": 1, "source": 16, "target": 17, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__Environment_41____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 100, "column": 9, "tokens": ["data", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "code": "data = System.getenv(\"ADD\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR0", "=", "System", ".", "getenv", "(", "\"ADD\"", ")"], "tokens_order": [5, 4, 82, 3, 120, 1, 121, 2, 0, 0, 0], "bad_source": true}, {"id": 1, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__Environment_41", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 102, "column": 9, "tokens": ["badSink", "(", "data", ")"], "code": "badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["FUN0", "(", "VAR0", ")"], "tokens_order": [16, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 27, "column": 5, "tokens": ["private", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "private void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["private", "void", "FUN0", "(", "String", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 20, 10, 2, 22, 23, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 33, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["File", "VAR2", "=", "new", "File", "(", "VAR1", ")"], "tokens_order": [55, 6, 4, 7, 55, 1, 10, 2, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 37, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR2", ".", "exists", "(", ")", "&&", "VAR2", ".", "isFile", "(", ")"], "tokens_order": [6, 3, 194, 1, 2, 76, 6, 3, 197, 1, 2]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 41, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR3", "=", "new", "FileInputStream", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 66, 1, 6, 2, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR4", "=", "new", "InputStreamReader", "(", "VAR3", ",", "\"UTF-8\"", ")"], "tokens_order": [11, 4, 7, 46, 1, 9, 8, 42, 2, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 43, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR5", "=", "new", "BufferedReader", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 45, 1, 11, 2, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 44, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR5", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 14, 3, 47, 1, 2, 2, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 55, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 67, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 79, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__Environment_41", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": "-1", "source": 1, "target": 2, "type": "func_call_out"}, {"id": 0, "source": 2, "target": 3, "type": "DDG"}, {"id": 1, "source": 2, "target": 4, "type": "DDG"}, {"id": 2, "source": 4, "target": 5, "type": "DDG"}, {"id": 3, "source": 4, "target": 6, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 7, "target": 8, "type": "DDG"}, {"id": 6, "source": 8, "target": 9, "type": "DDG"}, {"id": 7, "source": 8, "target": 10, "type": "DDG"}, {"id": 8, "source": 8, "target": 11, "type": "DDG"}, {"id": 9, "source": 7, "target": 12, "type": "DDG"}, {"id": 10, "source": 7, "target": 13, "type": "DDG"}, {"id": 11, "source": 6, "target": 14, "type": "DDG"}, {"id": 12, "source": 6, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_01____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 43, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 49, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 50, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 55, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 66, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 78, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 91, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 93, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 97, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 101, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 102, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 103, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 104, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 18, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 115, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 117, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 127, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 129, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 139, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 141, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_01", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 3, "target": 8, "type": "DDG"}, {"id": 8, "source": 3, "target": 9, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 9, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 12, "target": 13, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": 15, "source": 13, "target": 16, "type": "DDG"}, {"id": 16, "source": 12, "target": 17, "type": "DDG"}, {"id": 17, "source": 12, "target": 18, "type": "DDG"}, {"id": 18, "source": 11, "target": 19, "type": "DDG"}, {"id": 19, "source": 11, "target": 20, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_73a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 49, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 53, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 93, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 95, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 105, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR4", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 11, 4, 7, 69, 32, 20, 34, 1, 2]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 106, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR4", ".", "add", "(", "0", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 33, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 107, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR4", ".", "add", "(", "1", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 37, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 108, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["VAR4", ".", "add", "(", "2", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 35, 8, 9, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>)", "called_column": "9"}], "varibles": ["dataLinkedList"], "line": 109, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_73b()).badSink(dataLinkedList)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0]}, {"id": 15, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["public", "void", "FUN0", "(", "LinkedList", "<", "String", ">", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 69, 32, 20, 34, 14, 2, 22, 23, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "remove", "(", "2", ")"], "tokens_order": [20, 15, 4, 14, 3, 89, 1, 35, 2, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_73b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": 11, "source": 3, "target": 12, "type": "DDG"}, {"id": 12, "source": 10, "target": 12, "type": "DDG"}, {"id": 13, "source": 3, "target": 13, "type": "DDG"}, {"id": 14, "source": 10, "target": 13, "type": "DDG"}, {"id": 15, "source": 10, "target": 14, "type": "DDG"}, {"id": "-1", "source": 14, "target": 15, "type": "func_call_out"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": 1, "source": 16, "target": 17, "type": "DDG"}, {"id": 2, "source": 16, "target": 18, "type": "DDG"}, {"id": 3, "source": 18, "target": 19, "type": "DDG"}, {"id": 4, "source": 18, "target": 20, "type": "DDG"}, {"id": 5, "source": 20, "target": 21, "type": "DDG"}, {"id": 6, "source": 21, "target": 22, "type": "DDG"}, {"id": 7, "source": 22, "target": 23, "type": "DDG"}, {"id": 8, "source": 22, "target": 24, "type": "DDG"}, {"id": 9, "source": 22, "target": 25, "type": "DDG"}, {"id": 10, "source": 21, "target": 26, "type": "DDG"}, {"id": 11, "source": 21, "target": 27, "type": "DDG"}, {"id": 12, "source": 20, "target": 28, "type": "DDG"}, {"id": 13, "source": 20, "target": 29, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["properties"], "line": 41, "column": 13, "tokens": ["Properties", "properties", "=", "new", "Properties", "(", ")"], "code": "Properties properties = new Properties()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["Properties", "VAR0", "=", "new", "Properties", "(", ")"], "tokens_order": [71, 5, 4, 7, 71, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 46, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "code": "streamFileInput = new FileInputStream(\"../common/config.properties\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "\"../common/config.properties\"", ")"], "tokens_order": [10, 4, 7, 66, 1, 111, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["properties", "streamFileInput"], "line": 47, "column": 17, "tokens": ["properties", ".", "load", "(", "streamFileInput", ")"], "code": "properties.load(streamFileInput)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["VAR0", ".", "load", "(", "VAR1", ")"], "tokens_order": [5, 3, 101, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "properties"], "line": 50, "column": 17, "tokens": ["data", "=", "properties", ".", "getProperty", "(", "\"data\"", ")"], "code": "data = properties.getProperty(\"data\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["VAR2", "=", "VAR0", ".", "getProperty", "(", "\"data\"", ")"], "tokens_order": [6, 4, 5, 3, 74, 1, 115, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 61, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 63, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "mtdSignature": "badSink(java.lang.Object)", "called_column": "9"}], "varibles": ["data"], "line": 73, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "(", ")", ")", ".", "badSink", "(", "(", "Object", ")", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__PropertiesFile_71b()).badSink((Object) data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "(", "Object", ")", "VAR2", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 1, 85, 2, 6, 2]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataObject"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "Object", "dataObject", ")", "throws", "Throwable"], "code": "public void badSink(Object dataObject) throws Throwable {\r\n    String data = (String) dataObject;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["public", "void", "FUN0", "(", "Object", "VAR3", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 85, 9, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataObject", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "(", "String", ")", "dataObject"], "code": "String data = (String) dataObject", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["String", "VAR4", "=", "(", "String", ")", "VAR3"], "tokens_order": [20, 11, 4, 1, 20, 2, 9, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 11, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR5", ".", "exists", "(", ")", "&&", "VAR5", ".", "isFile", "(", ")"], "tokens_order": [14, 3, 194, 1, 2, 76, 14, 3, 197, 1, 2, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 26, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_71b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 0, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 8, "target": 9, "type": "DDG"}, {"id": 2, "source": 8, "target": 10, "type": "DDG"}, {"id": 3, "source": 10, "target": 11, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 14, "target": 16, "type": "DDG"}, {"id": 9, "source": 14, "target": 17, "type": "DDG"}, {"id": 10, "source": 13, "target": 18, "type": "DDG"}, {"id": 11, "source": 13, "target": 19, "type": "DDG"}, {"id": 12, "source": 12, "target": 20, "type": "DDG"}, {"id": 13, "source": 12, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__console_readLine_72a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 46, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 47, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 50, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 60, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 62, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 72, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 74, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 85, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR4", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 11, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 86, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR4", ".", "add", "(", "0", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 33, 8, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 87, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR4", ".", "add", "(", "1", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 37, 8, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 88, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["VAR4", ".", "add", "(", "2", ",", "VAR3", ")"], "tokens_order": [11, 3, 53, 1, 35, 8, 9, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 89, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_72b()).badSink(dataVector)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0, 0]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 14, 2, 22, 23, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "remove", "(", "2", ")"], "tokens_order": [20, 15, 4, 14, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_72b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 8, "type": "DDG"}, {"id": 7, "source": 7, "target": 8, "type": "DDG"}, {"id": 8, "source": 2, "target": 9, "type": "DDG"}, {"id": 9, "source": 7, "target": 9, "type": "DDG"}, {"id": 10, "source": 2, "target": 10, "type": "DDG"}, {"id": 11, "source": 7, "target": 10, "type": "DDG"}, {"id": 12, "source": 7, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 13, "type": "DDG"}, {"id": 1, "source": 13, "target": 14, "type": "DDG"}, {"id": 2, "source": 13, "target": 15, "type": "DDG"}, {"id": 3, "source": 15, "target": 16, "type": "DDG"}, {"id": 4, "source": 15, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 19, "target": 20, "type": "DDG"}, {"id": 8, "source": 19, "target": 21, "type": "DDG"}, {"id": 9, "source": 19, "target": 22, "type": "DDG"}, {"id": 10, "source": 18, "target": 23, "type": "DDG"}, {"id": 11, "source": 18, "target": 24, "type": "DDG"}, {"id": 12, "source": 17, "target": 25, "type": "DDG"}, {"id": 13, "source": 17, "target": 26, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_31____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 44, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 52, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 53, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 54, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 59, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 94, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 96, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "dataCopy"], "line": 106, "column": 13, "tokens": ["dataCopy", "=", "data"], "code": "dataCopy = data", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR5", "=", "VAR4"], "tokens_order": [14, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataCopy", "data"], "line": 109, "column": 13, "tokens": ["String", "data", "=", "dataCopy"], "code": "String data = dataCopy", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["String", "VAR4", "=", "VAR5"], "tokens_order": [20, 11, 4, 14, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 112, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 114, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "VAR4", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 11, 2, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 118, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR0", ".", "exists", "(", ")", "&&", "VAR0", ".", "isFile", "(", ")"], "tokens_order": [5, 3, 194, 1, 2, 76, 5, 3, 197, 1, 2]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 122, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [15, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 123, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 124, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 125, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["CLS0", ".", "FUN0", "(", "VAR8", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 16, 1, 26, 3, 47, 1, 2, 2, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 136, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 138, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 148, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 150, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 160, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 162, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_31", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 12, "target": 13, "type": "DDG"}, {"id": 13, "source": 12, "target": 14, "type": "DDG"}, {"id": 14, "source": 14, "target": 15, "type": "DDG"}, {"id": 15, "source": 14, "target": 16, "type": "DDG"}, {"id": 16, "source": 16, "target": 17, "type": "DDG"}, {"id": 17, "source": 17, "target": 18, "type": "DDG"}, {"id": 18, "source": 18, "target": 19, "type": "DDG"}, {"id": 19, "source": 18, "target": 20, "type": "DDG"}, {"id": 20, "source": 18, "target": 21, "type": "DDG"}, {"id": 21, "source": 17, "target": 22, "type": "DDG"}, {"id": 22, "source": 17, "target": 23, "type": "DDG"}, {"id": 23, "source": 16, "target": 24, "type": "DDG"}, {"id": 24, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case id is not in query string */\r\n    /* POTENTIAL FLAW: Parse id param out of the URL querystring (without using getParameter()) */\r\n    {\r\n        StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\");\r\n        while (tokenizer.hasMoreTokens()) {\r\n            String token = tokenizer.nextToken();\r\n            /* a token will be like \"id=foo\" */\r\n            if (token.startsWith(\"id=\")) /* check if we have the \"id\" parameter\" */\r\n            {\r\n                data = token.substring(3);\r\n                /* set data to \"foo\" */\r\n                break;\r\n                /* exit while loop */\r\n            }\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "tokenizer"], "line": 35, "column": 13, "tokens": ["StringTokenizer", "tokenizer", "=", "new", "StringTokenizer", "(", "request", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "code": "StringTokenizer tokenizer = new StringTokenizer(request.getQueryString(), \"&\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["StringTokenizer", "VAR3", "=", "new", "StringTokenizer", "(", "VAR0", ".", "getQueryString", "(", ")", ",", "\"&\"", ")"], "tokens_order": [86, 9, 4, 7, 86, 1, 5, 3, 128, 1, 2, 8, 129, 2, 0], "bad_source": true}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["tokenizer"], "line": 36, "column": 20, "tokens": ["tokenizer", ".", "hasMoreTokens", "(", ")"], "code": "tokenizer.hasMoreTokens()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["VAR3", ".", "hasMoreTokens", "(", ")"], "tokens_order": [9, 3, 130, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["tokenizer", "token"], "line": 38, "column": 17, "tokens": ["String", "token", "=", "tokenizer", ".", "nextToken", "(", ")"], "code": "String token = tokenizer.nextToken()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["String", "VAR4", "=", "VAR3", ".", "nextToken", "(", ")"], "tokens_order": [20, 11, 4, 9, 3, 131, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["token"], "line": 39, "column": 20, "tokens": ["token", ".", "startsWith", "(", "\"id=\"", ")"], "code": "token.startsWith(\"id=\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["VAR4", ".", "startsWith", "(", "\"id=\"", ")"], "tokens_order": [11, 3, 132, 1, 133, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "token"], "line": 41, "column": 21, "tokens": ["data", "=", "token", ".", "substring", "(", "3", ")"], "code": "data = token.substring(3)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["VAR2", "=", "VAR4", ".", "substring", "(", "3", ")"], "tokens_order": [6, 4, 11, 3, 134, 1, 75, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 47, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 33, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 14, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 37, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 41, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 43, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 44, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 55, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 67, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 79, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getQueryString_Servlet_51b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 7, "type": "DDG"}, {"id": 4, "source": 6, "target": 7, "type": "DDG"}, {"id": 5, "source": 1, "target": 7, "type": "DDG"}, {"id": 6, "source": 4, "target": 5, "type": "DDG"}, {"id": 7, "source": 4, "target": 6, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": 1, "source": 8, "target": 10, "type": "DDG"}, {"id": 2, "source": 10, "target": 11, "type": "DDG"}, {"id": 3, "source": 10, "target": 12, "type": "DDG"}, {"id": 4, "source": 12, "target": 13, "type": "DDG"}, {"id": 5, "source": 13, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 14, "target": 16, "type": "DDG"}, {"id": 8, "source": 14, "target": 17, "type": "DDG"}, {"id": 9, "source": 13, "target": 18, "type": "DDG"}, {"id": 10, "source": 13, "target": 19, "type": "DDG"}, {"id": 11, "source": 12, "target": 20, "type": "DDG"}, {"id": 12, "source": 12, "target": 21, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a____goodG2B", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 57, "column": 5, "tokens": ["private", "void", "goodG2B", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\nprivate void goodG2B(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    /* FIX: Use a hardcoded string */\r\n    data = \"foo\";\r\n    Vector<String> dataVector = new Vector<String>(5);\r\n    dataVector.add(0, data);\r\n    dataVector.add(1, data);\r\n    dataVector.add(2, data);\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b()).goodG2BSink(dataVector, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["private", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [61, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 62, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR2", "=", "\"foo\""], "tokens_order": [6, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 64, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR3", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 9, 4, 7, 68, 32, 20, 34, 1, 73, 2, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 65, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "0", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 33, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 66, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "1", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 37, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 67, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["VAR3", ".", "add", "(", "2", ",", "VAR2", ")"], "tokens_order": [9, 3, 53, 1, 35, 8, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "mtdSignature": "goodG2BSink(java.util.Vector<java.lang.String>, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "response", "dataVector"], "line": 68, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "(", ")", ")", ".", "goodG2BSink", "(", "dataVector", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b()).goodG2BSink(dataVector, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR3", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 9, 8, 5, 8, 10, 2, 0, 0, 0]}, {"id": 7, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response", "dataVector"], "line": 98, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "Vector", "<", "String", ">", "dataVector", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(Vector<String> dataVector, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["public", "void", "FUN1", "(", "Vector", "<", "String", ">", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 68, 32, 20, 34, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 8, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 100, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["String", "VAR7", "=", "VAR4", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 11, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 103, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 105, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 109, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 114, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 115, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 116, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 127, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 129, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 139, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 141, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 151, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 153, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_72b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 3, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 4, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 5, "type": "DDG"}, {"id": 5, "source": 2, "target": 5, "type": "DDG"}, {"id": 6, "source": 0, "target": 6, "type": "DDG"}, {"id": 7, "source": 2, "target": 6, "type": "DDG"}, {"id": "-1", "source": 6, "target": 7, "type": "func_call_out"}, {"id": 0, "source": 7, "target": 8, "type": "DDG"}, {"id": 1, "source": 8, "target": 9, "type": "DDG"}, {"id": 2, "source": 8, "target": 10, "type": "DDG"}, {"id": 3, "source": 10, "target": 11, "type": "DDG"}, {"id": 4, "source": 10, "target": 12, "type": "DDG"}, {"id": 5, "source": 12, "target": 13, "type": "DDG"}, {"id": 6, "source": 13, "target": 14, "type": "DDG"}, {"id": 7, "source": 14, "target": 15, "type": "DDG"}, {"id": 8, "source": 14, "target": 16, "type": "DDG"}, {"id": 9, "source": 14, "target": 17, "type": "DDG"}, {"id": 10, "source": 13, "target": 18, "type": "DDG"}, {"id": 11, "source": 13, "target": 19, "type": "DDG"}, {"id": 12, "source": 12, "target": 20, "type": "DDG"}, {"id": 13, "source": 12, "target": 21, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__database_81a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "getDBConnection()", "called_column": "30"}], "varibles": ["connection"], "line": 48, "column": 17, "tokens": ["connection", "=", "IO", ".", "getDBConnection", "(", ")"], "code": "connection = IO.getDBConnection()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR0", "=", "CLS0", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 27, 3, 16, 1, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "connection"], "line": 51, "column": 17, "tokens": ["preparedStatement", "=", "connection", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "code": "preparedStatement = connection.prepareStatement(\"select name from users where id=0\")", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR1", "=", "VAR0", ".", "prepareStatement", "(", "\"select name from users where id=0\"", ")"], "tokens_order": [10, 4, 5, 3, 79, 1, 112, 2, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["preparedStatement", "resultSet"], "line": 52, "column": 17, "tokens": ["resultSet", "=", "preparedStatement", ".", "executeQuery", "(", ")"], "code": "resultSet = preparedStatement.executeQuery()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR2", "=", "VAR1", ".", "executeQuery", "(", ")"], "tokens_order": [6, 4, 10, 3, 90, 1, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "resultSet"], "line": 55, "column": 17, "tokens": ["data", "=", "resultSet", ".", "getString", "(", "1", ")"], "code": "data = resultSet.getString(1)", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR3", "=", "VAR2", ".", "getString", "(", "1", ")"], "tokens_order": [9, 4, 6, 3, 113, 1, 37, 2, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 66, "column": 25, "tokens": ["resultSet", "!=", "null"], "code": "resultSet != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["resultSet"], "line": 68, "column": 25, "tokens": ["resultSet", ".", "close", "(", ")"], "code": "resultSet.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 78, "column": 25, "tokens": ["preparedStatement", "!=", "null"], "code": "preparedStatement != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["preparedStatement"], "line": 80, "column": 25, "tokens": ["preparedStatement", ".", "close", "(", ")"], "code": "preparedStatement.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 90, "column": 25, "tokens": ["connection", "!=", "null"], "code": "connection != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["connection"], "line": 92, "column": 25, "tokens": ["connection", ".", "close", "(", ")"], "code": "connection.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["baseObject"], "line": 102, "column": 9, "tokens": ["CWE36_Absolute_Path_Traversal__database_81_base", "baseObject", "=", "new", "CWE36_Absolute_Path_Traversal__database_81_bad", "(", ")"], "code": "CWE36_Absolute_Path_Traversal__database_81_base baseObject = new CWE36_Absolute_Path_Traversal__database_81_bad()", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["CLS1", "VAR4", "=", "new", "VAR", "(", ")"], "tokens_order": [38, 11, 4, 7, 78, 1, 2, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__database_81_base", "mtdSignature": "action(java.lang.String)", "called_column": "9"}], "varibles": ["data", "baseObject"], "line": 103, "column": 9, "tokens": ["baseObject", ".", "action", "(", "data", ")"], "code": "baseObject.action(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_81a", "new_tokens": ["VAR4", ".", "FUN1", "(", "VAR3", ")"], "tokens_order": [11, 3, 25, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "action", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void action(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["CLS0", ".", "FUN2", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 57, 1, 31, 3, 47, 1, 2, 2, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__database_81_bad", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 3, "target": 11, "type": "DDG"}, {"id": 10, "source": 10, "target": 11, "type": "DDG"}, {"id": "-1", "source": 11, "target": 12, "type": "func_call_out"}, {"id": 0, "source": 12, "target": 13, "type": "DDG"}, {"id": 1, "source": 12, "target": 14, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 14, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 18, "target": 19, "type": "DDG"}, {"id": 7, "source": 18, "target": 20, "type": "DDG"}, {"id": 8, "source": 18, "target": 21, "type": "DDG"}, {"id": 9, "source": 17, "target": 22, "type": "DDG"}, {"id": 10, "source": 17, "target": 23, "type": "DDG"}, {"id": 11, "source": 16, "target": 24, "type": "DDG"}, {"id": 12, "source": 16, "target": 25, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 32, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    Container dataContainer = new Container();\r\n    dataContainer.containerOne = data;\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b()).badSink(dataContainer, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 36, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 40, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 41, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 44, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 48, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["Container", "VAR4", "=", "new", "Container", "(", ")"], "tokens_order": [56, 11, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 49, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["VAR4", ".", "containerOne", "=", "VAR2"], "tokens_order": [11, 3, 70, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "mtdSignature": "badSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a.Container, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["dataContainer", "request", "response"], "line": 50, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b()).badSink(dataContainer, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 11, 8, 5, 8, 10, 2, 0, 0]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer", "request", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", ".", "Container", "dataContainer", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a.Container dataContainer, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["public", "void", "FUN1", "(", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67a", ".", "Container", "VAR5", ",", "HttpServletRequest", "VAR6", ",", "HttpServletResponse", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 0, 3, 56, 14, 8, 39, 15, 8, 40, 18, 2, 22, 23]}, {"id": 9, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["String", "VAR8", "=", "VAR5", ".", "containerOne"], "tokens_order": [20, 26, 4, 14, 3, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["File", "VAR9", "=", "new", "File", "(", "VAR8", ")"], "tokens_order": [55, 31, 4, 7, 55, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR9", ".", "exists", "(", ")", "&&", "VAR9", ".", "isFile", "(", ")"], "tokens_order": [31, 3, 194, 1, 2, 76, 31, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR10", "=", "new", "FileInputStream", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 66, 1, 31, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", "=", "new", "InputStreamReader", "(", "VAR10", ",", "\"UTF-8\"", ")"], "tokens_order": [44, 4, 7, 46, 1, 36, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", "=", "new", "BufferedReader", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 45, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["CLS1", ".", "FUN2", "(", "VAR12", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 57, 1, 52, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 5, "target": 6, "type": "DDG"}, {"id": 4, "source": 4, "target": 6, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 5, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": 1, "source": 9, "target": 10, "type": "DDG"}, {"id": 2, "source": 9, "target": 11, "type": "DDG"}, {"id": 3, "source": 11, "target": 12, "type": "DDG"}, {"id": 4, "source": 11, "target": 13, "type": "DDG"}, {"id": 5, "source": 13, "target": 14, "type": "DDG"}, {"id": 6, "source": 14, "target": 15, "type": "DDG"}, {"id": 7, "source": 15, "target": 16, "type": "DDG"}, {"id": 8, "source": 15, "target": 17, "type": "DDG"}, {"id": 9, "source": 15, "target": 18, "type": "DDG"}, {"id": 10, "source": 14, "target": 19, "type": "DDG"}, {"id": 11, "source": 14, "target": 20, "type": "DDG"}, {"id": 12, "source": 13, "target": 21, "type": "DDG"}, {"id": 13, "source": 13, "target": 22, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_21____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_21", "mtdSignature": "bad_source()", "called_column": "16"}], "varibles": ["data"], "line": 43, "column": 9, "tokens": ["data", "=", "bad_source", "(", ")"], "code": "data = bad_source()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR0", "=", "FUN0", "(", ")"], "tokens_order": [5, 4, 16, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 46, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 48, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0], "bad_sink": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 52, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 57, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 58, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 59, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 72, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 84, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 96, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 117, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["File", "VAR5", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 14, 4, 7, 55, 1, 114, 2, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 124, "column": 21, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR6", "=", "new", "FileInputStream", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 66, 1, 14, 2, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 125, "column": 21, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR7", "=", "new", "InputStreamReader", "(", "VAR6", ",", "\"UTF-8\"", ")"], "tokens_order": [18, 4, 7, 46, 1, 15, 8, 42, 2, 0, 0]}, {"id": 17, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 126, "column": 21, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR8", "=", "new", "BufferedReader", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 45, 1, 18, 2, 0, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 130, "column": 21, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR9", "=", "VAR8", ".", "readLine", "(", ")"], "tokens_order": [31, 4, 26, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 19, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 141, "column": 29, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 143, "column": 29, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 153, "column": 29, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 155, "column": 29, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 165, "column": 29, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 167, "column": 29, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 181, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["VAR9", "=", "null"], "tokens_order": [31, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 184, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__File_21", "new_tokens": ["return", "VAR9", ";"], "tokens_order": [84, 31, 83, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 26, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 18, "target": 26, "type": "DDG"}, {"id": 1, "source": 25, "target": 26, "type": "DDG"}, {"id": 2, "source": 14, "target": 15, "type": "DDG"}, {"id": 3, "source": 15, "target": 16, "type": "DDG"}, {"id": 4, "source": 16, "target": 17, "type": "DDG"}, {"id": 5, "source": 17, "target": 18, "type": "DDG"}, {"id": 6, "source": 17, "target": 19, "type": "DDG"}, {"id": 7, "source": 17, "target": 20, "type": "DDG"}, {"id": 8, "source": 16, "target": 21, "type": "DDG"}, {"id": 9, "source": 16, "target": 22, "type": "DDG"}, {"id": 10, "source": 15, "target": 23, "type": "DDG"}, {"id": 11, "source": 15, "target": 24, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 27, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    data = \"\";\r\n    /* initialize data in case there are no cookies */\r\n    /* Read data from cookies */\r\n    {\r\n        Cookie[] cookieSources = request.getCookies();\r\n        if (cookieSources != null) {\r\n            /* POTENTIAL FLAW: Read data from the first cookie value */\r\n            data = cookieSources[0].getValue();\r\n        }\r\n    }\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 31, "column": 9, "tokens": ["data", "=", "\"\""], "code": "data = \"\"", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["VAR2", "=", "\"\""], "tokens_order": [6, 4, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["request", "cookieSources"], "line": 35, "column": 13, "tokens": ["Cookie", "cookieSources", "[", "]", "=", "request", ".", "getCookies", "(", ")"], "code": "Cookie[] cookieSources = request.getCookies()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["Cookie", "VAR3", "[", "]", "=", "VAR0", ".", "getCookies", "(", ")"], "tokens_order": [88, 9, 29, 30, 4, 5, 3, 125, 1, 2, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["cookieSources"], "line": 36, "column": 17, "tokens": ["cookieSources", "!=", "null"], "code": "cookieSources != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "cookieSources"], "line": 39, "column": 17, "tokens": ["data", "=", "cookieSources", "[", "0", "]", ".", "getValue", "(", ")"], "code": "data = cookieSources[0].getValue()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["VAR2", "=", "VAR3", "[", "0", "]", ".", "getValue", "(", ")"], "tokens_order": [6, 4, 9, 29, 33, 30, 3, 126, 1, 2, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 43, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN1", "(", "VAR2", ",", "VAR0", ",", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 25, 1, 6, 8, 5, 8, 10, 2]}, {"id": 6, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR4", ",", "HttpServletRequest", "VAR5", ",", "HttpServletResponse", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 11, 8, 39, 14, 8, 40, 15, 2, 22, 23]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN1", "(", "VAR4", ",", "VAR5", ",", "VAR6", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 25, 1, 11, 8, 14, 8, 15, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d()).badSink(data, request, response);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR7", ",", "HttpServletRequest", "VAR8", ",", "HttpServletResponse", "VAR9", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 18, 8, 39, 26, 8, 40, 31, 2, 22, 23]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "mtdSignature": "badSink(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)", "called_column": "9"}], "varibles": ["request", "data", "response"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "(", ")", ")", ".", "badSink", "(", "data", ",", "request", ",", "response", ")"], "code": "(new CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d()).badSink(data, request, response)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53c", "new_tokens": ["(", "new", "CLS2", "(", ")", ")", ".", "FUN1", "(", "VAR7", ",", "VAR8", ",", "VAR9", ")"], "tokens_order": [1, 7, 72, 1, 2, 2, 3, 25, 1, 18, 8, 26, 8, 31, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "data", "response"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ",", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "public void badSink(String data, HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["public", "void", "FUN1", "(", "String", "VAR10", ",", "HttpServletRequest", "VAR11", ",", "HttpServletResponse", "VAR12", ")", "throws", "Throwable"], "tokens_order": [28, 24, 25, 1, 20, 36, 8, 39, 44, 8, 40, 52, 2, 22, 23]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["File", "VAR13", "=", "new", "File", "(", "VAR10", ")"], "tokens_order": [55, 60, 4, 7, 55, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR13", ".", "exists", "(", ")", "&&", "VAR13", ".", "isFile", "(", ")"], "tokens_order": [60, 3, 194, 1, 2, 76, 60, 3, 197, 1, 2, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR14", "=", "new", "FileInputStream", "(", "VAR13", ")"], "tokens_order": [77, 4, 7, 66, 1, 60, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR15", "=", "new", "InputStreamReader", "(", "VAR14", ",", "\"UTF-8\"", ")"], "tokens_order": [91, 4, 7, 46, 1, 77, 8, 42, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR16", "=", "new", "BufferedReader", "(", "VAR15", ")"], "tokens_order": [136, 4, 7, 45, 1, 91, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["CLS3", ".", "FUN2", "(", "VAR16", ".", "readLine", "(", ")", ")"], "tokens_order": [92, 3, 57, 1, 136, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR16", "!=", "null"], "tokens_order": [136, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR16", ".", "close", "(", ")"], "tokens_order": [136, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR15", "!=", "null"], "tokens_order": [91, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR15", ".", "close", "(", ")"], "tokens_order": [91, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getCookies_Servlet_53d", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 2, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 2, "target": 4, "type": "DDG"}, {"id": 3, "source": 0, "target": 5, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 5, "type": "DDG"}, {"id": "-1", "source": 5, "target": 6, "type": "func_call_out"}, {"id": 0, "source": 6, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 10, "target": 12, "type": "DDG"}, {"id": 2, "source": 12, "target": 13, "type": "DDG"}, {"id": 3, "source": 12, "target": 14, "type": "DDG"}, {"id": 4, "source": 14, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 16, "target": 17, "type": "DDG"}, {"id": 7, "source": 16, "target": 18, "type": "DDG"}, {"id": 8, "source": 16, "target": 19, "type": "DDG"}, {"id": 9, "source": 15, "target": 20, "type": "DDG"}, {"id": 10, "source": 15, "target": 21, "type": "DDG"}, {"id": 11, "source": 14, "target": 22, "type": "DDG"}, {"id": 12, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_67a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 55, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 56, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 60, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 61, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 64, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 75, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 77, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 87, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 89, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 100, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 102, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 112, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 114, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 124, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["Container", "VAR5", "=", "new", "Container", "(", ")"], "tokens_order": [56, 14, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 125, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["VAR5", ".", "containerOne", "=", "VAR4"], "tokens_order": [14, 3, 70, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "mtdSignature": "badSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__listen_tcp_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 126, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_67b()).badSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE36_Absolute_Path_Traversal__listen_tcp_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE36_Absolute_Path_Traversal__listen_tcp_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__listen_tcp_67a", ".", "Container", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 15, 2, 22, 23, 0, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "containerOne"], "tokens_order": [20, 18, 4, 15, 3, 70, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_67b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 13, "target": 14, "type": "DDG"}, {"id": 13, "source": 4, "target": 14, "type": "DDG"}, {"id": 14, "source": 13, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 17, "target": 19, "type": "DDG"}, {"id": 3, "source": 19, "target": 20, "type": "DDG"}, {"id": 4, "source": 19, "target": 21, "type": "DDG"}, {"id": 5, "source": 21, "target": 22, "type": "DDG"}, {"id": 6, "source": 22, "target": 23, "type": "DDG"}, {"id": 7, "source": 23, "target": 24, "type": "DDG"}, {"id": 8, "source": 23, "target": 25, "type": "DDG"}, {"id": 9, "source": 23, "target": 26, "type": "DDG"}, {"id": 10, "source": 22, "target": 27, "type": "DDG"}, {"id": 11, "source": 22, "target": 28, "type": "DDG"}, {"id": 12, "source": 21, "target": 29, "type": "DDG"}, {"id": 13, "source": 21, "target": 30, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02____bad", "nodes": [{"id": 0, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["request", "response"], "line": 29, "column": 5, "tokens": ["public", "void", "bad", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "Throwable"], "code": "/* uses badsource and badsink */\r\npublic void bad(HttpServletRequest request, HttpServletResponse response) throws Throwable {\r\n    String data;\r\n    if (true) {\r\n        /* POTENTIAL FLAW: Read data from a querystring using getParameter */\r\n        data = request.getParameter(\"name\");\r\n    } else {\r\n        /* INCIDENTAL: CWE 561 Dead Code, the code below will never run\r\n             * but ensure data is inititialized before the Sink to avoid compiler errors */\r\n        data = null;\r\n    }\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["public", "void", "FUN0", "(", "HttpServletRequest", "VAR0", ",", "HttpServletResponse", "VAR1", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 39, 5, 8, 40, 10, 2, 22, 23]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["request", "data"], "line": 35, "column": 13, "tokens": ["data", "=", "request", ".", "getParameter", "(", "\"name\"", ")"], "code": "data = request.getParameter(\"name\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR2", "=", "VAR0", ".", "getParameter", "(", "\"name\"", ")"], "tokens_order": [6, 4, 5, 3, 119, 1, 127, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 41, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR2", "=", "null"], "tokens_order": [6, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 45, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 47, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["File", "VAR3", "=", "new", "File", "(", "VAR2", ")"], "tokens_order": [55, 9, 4, 7, 55, 1, 6, 2, 0, 0, 0, 0], "bad_sink": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 51, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR3", ".", "exists", "(", ")", "&&", "VAR3", ".", "isFile", "(", ")"], "tokens_order": [9, 3, 194, 1, 2, 76, 9, 3, 197, 1, 2, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 55, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR4", "=", "new", "FileInputStream", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 66, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 56, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR5", "=", "new", "InputStreamReader", "(", "VAR4", ",", "\"UTF-8\"", ")"], "tokens_order": [14, 4, 7, 46, 1, 11, 8, 42, 2, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 57, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR6", "=", "new", "BufferedReader", "(", "VAR5", ")"], "tokens_order": [15, 4, 7, 45, 1, 14, 2, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 58, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["CLS0", ".", "FUN1", "(", "VAR6", ".", "readLine", "(", ")", ")"], "tokens_order": [27, 3, 25, 1, 15, 3, 47, 1, 2, 2, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 69, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 71, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 81, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 83, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 93, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 95, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__getParameter_Servlet_02", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 2, "target": 3, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 1, "target": 4, "type": "DDG"}, {"id": 5, "source": 4, "target": 5, "type": "DDG"}, {"id": 6, "source": 4, "target": 6, "type": "DDG"}, {"id": 7, "source": 6, "target": 7, "type": "DDG"}, {"id": 8, "source": 7, "target": 8, "type": "DDG"}, {"id": 9, "source": 8, "target": 9, "type": "DDG"}, {"id": 10, "source": 8, "target": 10, "type": "DDG"}, {"id": 11, "source": 8, "target": 11, "type": "DDG"}, {"id": 12, "source": 7, "target": 12, "type": "DDG"}, {"id": 13, "source": 7, "target": 13, "type": "DDG"}, {"id": 14, "source": 6, "target": 14, "type": "DDG"}, {"id": 15, "source": 6, "target": 15, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_74a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 120, "column": 9, "tokens": ["HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "code": "HashMap<Integer, String> dataHashMap = new HashMap<Integer, String>()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["HashMap", "<", "Integer", ",", "String", ">", "VAR5", "=", "new", "HashMap", "<", "Integer", ",", "String", ">", "(", ")"], "tokens_order": [63, 32, 50, 8, 20, 34, 14, 4, 7, 63, 32, 50, 8, 20, 34, 1, 2]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 121, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "0", ",", "data", ")"], "code": "dataHashMap.put(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 122, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "1", ",", "data", ")"], "code": "dataHashMap.put(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 123, "column": 9, "tokens": ["dataHashMap", ".", "put", "(", "2", ",", "data", ")"], "code": "dataHashMap.put(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["VAR5", ".", "put", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 64, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "mtdSignature": "badSink(java.util.HashMap<java.lang.Integer, java.lang.String>)", "called_column": "9"}], "varibles": ["dataHashMap"], "line": 124, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "(", ")", ")", ".", "badSink", "(", "dataHashMap", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_74b()).badSink(dataHashMap)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataHashMap"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "HashMap", "<", "Integer", ",", "String", ">", "dataHashMap", ")", "throws", "Throwable"], "code": "public void badSink(HashMap<Integer, String> dataHashMap) throws Throwable {\r\n    String data = dataHashMap.get(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["public", "void", "FUN0", "(", "HashMap", "<", "Integer", ",", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 63, 32, 50, 8, 20, 34, 15, 2, 22, 23, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataHashMap"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataHashMap", ".", "get", "(", "2", ")"], "code": "String data = dataHashMap.get(2)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "get", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 141, 1, 35, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_74b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 14, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 15, "type": "DDG"}, {"id": 15, "source": 13, "target": 15, "type": "DDG"}, {"id": 16, "source": 4, "target": 16, "type": "DDG"}, {"id": 17, "source": 13, "target": 16, "type": "DDG"}, {"id": 18, "source": 13, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 19, "type": "DDG"}, {"id": 1, "source": 19, "target": 20, "type": "DDG"}, {"id": 2, "source": 19, "target": 21, "type": "DDG"}, {"id": 3, "source": 21, "target": 22, "type": "DDG"}, {"id": 4, "source": 21, "target": 23, "type": "DDG"}, {"id": 5, "source": 23, "target": 24, "type": "DDG"}, {"id": 6, "source": 24, "target": 25, "type": "DDG"}, {"id": 7, "source": 25, "target": 26, "type": "DDG"}, {"id": 8, "source": 25, "target": 27, "type": "DDG"}, {"id": 9, "source": 25, "target": 28, "type": "DDG"}, {"id": 10, "source": 24, "target": 29, "type": "DDG"}, {"id": 11, "source": 24, "target": 30, "type": "DDG"}, {"id": 12, "source": 23, "target": 31, "type": "DDG"}, {"id": 13, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__listen_tcp_72a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 51, "column": 17, "tokens": ["listener", "=", "new", "ServerSocket", "(", "39543", ")"], "code": "listener = new ServerSocket(39543)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR0", "=", "new", "ServerSocket", "(", "39543", ")"], "tokens_order": [5, 4, 7, 102, 1, 105, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["listener", "socket"], "line": 52, "column": 17, "tokens": ["socket", "=", "listener", ".", "accept", "(", ")"], "code": "socket = listener.accept()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR1", "=", "VAR0", ".", "accept", "(", ")"], "tokens_order": [10, 4, 5, 3, 106, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 56, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 57, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 60, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 71, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 73, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 83, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 85, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 96, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 98, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 108, "column": 25, "tokens": ["listener", "!=", "null"], "code": "listener != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["listener"], "line": 110, "column": 25, "tokens": ["listener", ".", "close", "(", ")"], "code": "listener.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 120, "column": 9, "tokens": ["Vector", "<", "String", ">", "dataVector", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "code": "Vector<String> dataVector = new Vector<String>(5)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["Vector", "<", "String", ">", "VAR5", "=", "new", "Vector", "<", "String", ">", "(", "5", ")"], "tokens_order": [68, 32, 20, 34, 14, 4, 7, 68, 32, 20, 34, 1, 73, 2]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 121, "column": 9, "tokens": ["dataVector", ".", "add", "(", "0", ",", "data", ")"], "code": "dataVector.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR5", ".", "add", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 122, "column": 9, "tokens": ["dataVector", ".", "add", "(", "1", ",", "data", ")"], "code": "dataVector.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR5", ".", "add", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 123, "column": 9, "tokens": ["dataVector", ".", "add", "(", "2", ",", "data", ")"], "code": "dataVector.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["VAR5", ".", "add", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "mtdSignature": "badSink(java.util.Vector<java.lang.String>)", "called_column": "9"}], "varibles": ["dataVector"], "line": 124, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "(", ")", ")", ".", "badSink", "(", "dataVector", ")"], "code": "(new CWE36_Absolute_Path_Traversal__listen_tcp_72b()).badSink(dataVector)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0, 0]}, {"id": 18, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataVector"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "Vector", "<", "String", ">", "dataVector", ")", "throws", "Throwable"], "code": "public void badSink(Vector<String> dataVector) throws Throwable {\r\n    String data = dataVector.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["public", "void", "FUN0", "(", "Vector", "<", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 68, 32, 20, 34, 15, 2, 22, 23, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataVector"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataVector", ".", "remove", "(", "2", ")"], "code": "String data = dataVector.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 89, 1, 35, 2, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__listen_tcp_72b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 0, "target": 11, "type": "DDG"}, {"id": 11, "source": 0, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 14, "type": "DDG"}, {"id": 13, "source": 13, "target": 14, "type": "DDG"}, {"id": 14, "source": 4, "target": 15, "type": "DDG"}, {"id": 15, "source": 13, "target": 15, "type": "DDG"}, {"id": 16, "source": 4, "target": 16, "type": "DDG"}, {"id": 17, "source": 13, "target": 16, "type": "DDG"}, {"id": 18, "source": 13, "target": 17, "type": "DDG"}, {"id": "-1", "source": 17, "target": 18, "type": "func_call_out"}, {"id": 0, "source": 18, "target": 19, "type": "DDG"}, {"id": 1, "source": 19, "target": 20, "type": "DDG"}, {"id": 2, "source": 19, "target": 21, "type": "DDG"}, {"id": 3, "source": 21, "target": 22, "type": "DDG"}, {"id": 4, "source": 21, "target": 23, "type": "DDG"}, {"id": 5, "source": 23, "target": 24, "type": "DDG"}, {"id": 6, "source": 24, "target": 25, "type": "DDG"}, {"id": 7, "source": 25, "target": 26, "type": "DDG"}, {"id": 8, "source": 25, "target": 27, "type": "DDG"}, {"id": 9, "source": 25, "target": 28, "type": "DDG"}, {"id": 10, "source": 24, "target": 29, "type": "DDG"}, {"id": 11, "source": 24, "target": 30, "type": "DDG"}, {"id": 12, "source": 23, "target": 31, "type": "DDG"}, {"id": 13, "source": 23, "target": 32, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__console_readLine_52a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "System"], "line": 45, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "System", ".", "in", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(System.in, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR0", "=", "new", "InputStreamReader", "(", "VAR1", ".", "in", ",", "\"UTF-8\"", ")"], "tokens_order": [5, 4, 7, 46, 1, 10, 3, 87, 8, 42, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 46, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR0", ")"], "tokens_order": [6, 4, 7, 45, 1, 5, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 49, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0], "bad_source": true}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 59, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 61, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 71, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 73, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_52b", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 84, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_52b", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_52b()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR3", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 9, 2]}, {"id": 8, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 26, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    (new CWE36_Absolute_Path_Traversal__console_readLine_52c()).badSink(data);\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52b", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR4", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 11, 2, 22, 23, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "mtdSignature": "badSink(java.lang.String)", "called_column": "9"}], "varibles": ["data"], "line": 28, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__console_readLine_52c", "(", ")", ")", ".", "badSink", "(", "data", ")"], "code": "(new CWE36_Absolute_Path_Traversal__console_readLine_52c()).badSink(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52b", "new_tokens": ["(", "new", "CLS1", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 38, 1, 2, 2, 3, 16, 1, 11, 2]}, {"id": 10, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["data"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "String", "data", ")", "throws", "Throwable"], "code": "public void badSink(String data) throws Throwable {\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["public", "void", "FUN0", "(", "String", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 20, 14, 2, 22, 23, 0, 0]}, {"id": 11, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 32, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 34, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["File", "VAR6", "=", "new", "File", "(", "VAR5", ")"], "tokens_order": [55, 15, 4, 7, 55, 1, 14, 2, 0, 0, 0], "bad_sink": true}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 38, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR6", ".", "exists", "(", ")", "&&", "VAR6", ".", "isFile", "(", ")"], "tokens_order": [15, 3, 194, 1, 2, 76, 15, 3, 197, 1, 2]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 42, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR7", "=", "new", "FileInputStream", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 66, 1, 15, 2, 0, 0, 0, 0]}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR8", "=", "new", "InputStreamReader", "(", "VAR7", ",", "\"UTF-8\"", ")"], "tokens_order": [26, 4, 7, 46, 1, 18, 8, 42, 2, 0, 0]}, {"id": 16, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 44, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR9", "=", "new", "BufferedReader", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 45, 1, 26, 2, 0, 0, 0, 0]}, {"id": 17, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 45, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["CLS2", ".", "FUN1", "(", "VAR9", ".", "readLine", "(", ")", ")"], "tokens_order": [72, 3, 25, 1, 31, 3, 47, 1, 2, 2, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 56, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 68, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 80, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__console_readLine_52c", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": 3, "source": 1, "target": 4, "type": "DDG"}, {"id": 4, "source": 0, "target": 5, "type": "DDG"}, {"id": 5, "source": 0, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": "-1", "source": 7, "target": 8, "type": "func_call_out"}, {"id": 0, "source": 8, "target": 9, "type": "DDG"}, {"id": "-1", "source": 9, "target": 10, "type": "func_call_out"}, {"id": 0, "source": 10, "target": 11, "type": "DDG"}, {"id": 1, "source": 10, "target": 12, "type": "DDG"}, {"id": 2, "source": 12, "target": 13, "type": "DDG"}, {"id": 3, "source": 12, "target": 14, "type": "DDG"}, {"id": 4, "source": 14, "target": 15, "type": "DDG"}, {"id": 5, "source": 15, "target": 16, "type": "DDG"}, {"id": 6, "source": 16, "target": 17, "type": "DDG"}, {"id": 7, "source": 16, "target": 18, "type": "DDG"}, {"id": 8, "source": 16, "target": 19, "type": "DDG"}, {"id": 9, "source": 15, "target": 20, "type": "DDG"}, {"id": 10, "source": 15, "target": 21, "type": "DDG"}, {"id": 11, "source": 14, "target": 22, "type": "DDG"}, {"id": 12, "source": 14, "target": 23, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__PropertiesFile_67a____goodG2B", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 94, "column": 9, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", "new_tokens": ["VAR0", "=", "\"foo\""], "tokens_order": [5, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0], "fixed": true}, {"id": 1, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 96, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", "new_tokens": ["Container", "VAR1", "=", "new", "Container", "(", ")"], "tokens_order": [56, 10, 4, 7, 56, 1, 2, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 97, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", "new_tokens": ["VAR1", ".", "containerOne", "=", "VAR0"], "tokens_order": [10, 3, 70, 4, 5, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "mtdSignature": "goodG2BSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__PropertiesFile_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 98, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "(", ")", ")", ".", "goodG2BSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__PropertiesFile_67b()).goodG2BSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR1", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 10, 2]}, {"id": 4, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 97, "column": 5, "tokens": ["public", "void", "goodG2BSink", "(", "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "/* goodG2B() - use goodsource and badsink */\r\npublic void goodG2BSink(CWE36_Absolute_Path_Traversal__PropertiesFile_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__PropertiesFile_67a", ".", "Container", "VAR2", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 6, 2, 22, 23]}, {"id": 5, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 99, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["String", "VAR3", "=", "VAR2", ".", "containerOne"], "tokens_order": [20, 9, 4, 6, 3, 70, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 102, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 104, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["File", "VAR4", "=", "new", "File", "(", "VAR3", ")"], "tokens_order": [55, 11, 4, 7, 55, 1, 9, 2, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 108, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR4", ".", "exists", "(", ")", "&&", "VAR4", ".", "isFile", "(", ")"], "tokens_order": [11, 3, 194, 1, 2, 76, 11, 3, 197, 1, 2]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 112, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR5", "=", "new", "FileInputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 66, 1, 11, 2, 0, 0, 0, 0]}, {"id": 10, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 113, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR6", "=", "new", "InputStreamReader", "(", "VAR5", ",", "\"UTF-8\"", ")"], "tokens_order": [15, 4, 7, 46, 1, 14, 8, 42, 2, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 114, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR7", "=", "new", "BufferedReader", "(", "VAR6", ")"], "tokens_order": [18, 4, 7, 45, 1, 15, 2, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 115, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR7", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 18, 3, 47, 1, 2, 2, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 126, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 128, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR7", ".", "close", "(", ")"], "tokens_order": [18, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 138, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 140, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR6", ".", "close", "(", ")"], "tokens_order": [15, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 150, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 18, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 152, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__PropertiesFile_67b", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 1, "target": 2, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 1, "target": 3, "type": "DDG"}, {"id": "-1", "source": 3, "target": 4, "type": "func_call_out"}, {"id": 0, "source": 4, "target": 5, "type": "DDG"}, {"id": 1, "source": 5, "target": 6, "type": "DDG"}, {"id": 2, "source": 5, "target": 7, "type": "DDG"}, {"id": 3, "source": 7, "target": 8, "type": "DDG"}, {"id": 4, "source": 7, "target": 9, "type": "DDG"}, {"id": 5, "source": 9, "target": 10, "type": "DDG"}, {"id": 6, "source": 10, "target": 11, "type": "DDG"}, {"id": 7, "source": 11, "target": 12, "type": "DDG"}, {"id": 8, "source": 11, "target": 13, "type": "DDG"}, {"id": 9, "source": 11, "target": 14, "type": "DDG"}, {"id": 10, "source": 10, "target": 15, "type": "DDG"}, {"id": 11, "source": 10, "target": 16, "type": "DDG"}, {"id": 12, "source": 9, "target": 17, "type": "DDG"}, {"id": 13, "source": 9, "target": 18, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__URLConnection_75a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["urlConnection"], "line": 45, "column": 13, "tokens": ["URLConnection", "urlConnection", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "code": "URLConnection urlConnection = (new URL(\"http://www.example.org/\")).openConnection()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["URLConnection", "VAR0", "=", "(", "new", "URL", "(", "\"http://www.example.org/\"", ")", ")", ".", "openConnection", "(", ")"], "tokens_order": [107, 5, 4, 1, 7, 108, 1, 109, 2, 2, 3, 110, 1, 2]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["urlConnection", "readerInputStream"], "line": 51, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "urlConnection", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(urlConnection.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 52, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 57, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 68, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 70, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 80, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 82, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 98, "column": 13, "tokens": ["streamByteArrayOutput", "=", "new", "ByteArrayOutputStream", "(", ")"], "code": "streamByteArrayOutput = new ByteArrayOutputStream()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR4", "=", "new", "ByteArrayOutputStream", "(", ")"], "tokens_order": [11, 4, 7, 142, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["outputObject", "streamByteArrayOutput"], "line": 99, "column": 13, "tokens": ["outputObject", "=", "new", "ObjectOutputStream", "(", "streamByteArrayOutput", ")"], "code": "outputObject = new ObjectOutputStream(streamByteArrayOutput)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR5", "=", "new", "ObjectOutputStream", "(", "VAR4", ")"], "tokens_order": [14, 4, 7, 143, 1, 11, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "outputObject"], "line": 100, "column": 13, "tokens": ["outputObject", ".", "writeObject", "(", "data", ")"], "code": "outputObject.writeObject(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR5", ".", "writeObject", "(", "VAR3", ")"], "tokens_order": [14, 3, 144, 1, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayOutput"], "line": 101, "column": 13, "tokens": ["byte", "[", "]", "dataSerialized", "=", "streamByteArrayOutput", ".", "toByteArray", "(", ")"], "code": "byte[] dataSerialized = streamByteArrayOutput.toByteArray()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["byte", "[", "]", "VAR6", "=", "VAR4", ".", "toByteArray", "(", ")"], "tokens_order": [51, 29, 30, 15, 4, 11, 3, 145, 1, 2, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "mtdSignature": "badSink(byte[])", "called_column": "13"}], "varibles": ["dataSerialized"], "line": 102, "column": 13, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__URLConnection_75b", "(", ")", ")", ".", "badSink", "(", "dataSerialized", ")"], "code": "(new CWE36_Absolute_Path_Traversal__URLConnection_75b()).badSink(dataSerialized)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR6", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 15, 2, 0, 0, 0]}, {"id": 13, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 113, "column": 21, "tokens": ["outputObject", "!=", "null"], "code": "outputObject != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR5", "!=", "null"], "tokens_order": [14, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["outputObject"], "line": 115, "column": 21, "tokens": ["outputObject", ".", "close", "(", ")"], "code": "outputObject.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR5", ".", "close", "(", ")"], "tokens_order": [14, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 125, "column": 21, "tokens": ["streamByteArrayOutput", "!=", "null"], "code": "streamByteArrayOutput != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayOutput"], "line": 127, "column": 21, "tokens": ["streamByteArrayOutput", ".", "close", "(", ")"], "code": "streamByteArrayOutput.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 17, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataSerialized"], "line": 31, "column": 5, "tokens": ["public", "void", "badSink", "(", "byte", "[", "]", "dataSerialized", ")", "throws", "Throwable"], "code": "public void badSink(byte[] dataSerialized) throws Throwable {\r\n    /* unserialize data */\r\n    ByteArrayInputStream streamByteArrayInput = null;\r\n    ObjectInputStream streamObjectInput = null;\r\n    try {\r\n        streamByteArrayInput = new ByteArrayInputStream(dataSerialized);\r\n        streamObjectInput = new ObjectInputStream(streamByteArrayInput);\r\n        String data = (String) streamObjectInput.readObject();\r\n        /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n        if (data != null) {\r\n            File file = new File(data);\r\n            FileInputStream streamFileInputSink = null;\r\n            InputStreamReader readerInputStreamSink = null;\r\n            BufferedReader readerBufferdSink = null;\r\n            if (file.exists() && file.isFile()) {\r\n                try {\r\n                    streamFileInputSink = new FileInputStream(file);\r\n                    readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                    readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                    IO.writeLine(readerBufferdSink.readLine());\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n                } finally {\r\n                    /* Close stream reading objects */\r\n                    try {\r\n                        if (readerBufferdSink != null) {\r\n                            readerBufferdSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (readerInputStreamSink != null) {\r\n                            readerInputStreamSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                    }\r\n                    try {\r\n                        if (streamFileInputSink != null) {\r\n                            streamFileInputSink.close();\r\n                        }\r\n                    } catch (IOException exceptIO) {\r\n                        IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } catch (IOException exceptIO) {\r\n        IO.logger.log(Level.WARNING, \"IOException in deserialization\", exceptIO);\r\n    } catch (ClassNotFoundException exceptClassNotFound) {\r\n        IO.logger.log(Level.WARNING, \"ClassNotFoundException in deserialization\", exceptClassNotFound);\r\n    } finally {\r\n        /* clean up stream reading objects */\r\n        try {\r\n            if (streamObjectInput != null) {\r\n                streamObjectInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ObjectInputStream\", exceptIO);\r\n        }\r\n        try {\r\n            if (streamByteArrayInput != null) {\r\n                streamByteArrayInput.close();\r\n            }\r\n        } catch (IOException exceptIO) {\r\n            IO.logger.log(Level.WARNING, \"Error closing ByteArrayInputStream\", exceptIO);\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["public", "void", "FUN0", "(", "byte", "[", "]", "VAR7", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 51, 29, 30, 18, 2, 22, 23, 0, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataSerialized", "streamByteArrayInput"], "line": 39, "column": 13, "tokens": ["streamByteArrayInput", "=", "new", "ByteArrayInputStream", "(", "dataSerialized", ")"], "code": "streamByteArrayInput = new ByteArrayInputStream(dataSerialized)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR8", "=", "new", "ByteArrayInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 146, 1, 18, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput", "streamObjectInput"], "line": 40, "column": 13, "tokens": ["streamObjectInput", "=", "new", "ObjectInputStream", "(", "streamByteArrayInput", ")"], "code": "streamObjectInput = new ObjectInputStream(streamByteArrayInput)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR9", "=", "new", "ObjectInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 147, 1, 26, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 20, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "streamObjectInput"], "line": 41, "column": 13, "tokens": ["String", "data", "=", "(", "String", ")", "streamObjectInput", ".", "readObject", "(", ")"], "code": "String data = (String) streamObjectInput.readObject()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["String", "VAR10", "=", "(", "String", ")", "VAR9", ".", "readObject", "(", ")"], "tokens_order": [20, 36, 4, 1, 20, 2, 31, 3, 148, 1, 2, 0, 0, 0]}, {"id": 21, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 44, "column": 17, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 46, "column": 17, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["File", "VAR11", "=", "new", "File", "(", "VAR10", ")"], "tokens_order": [55, 44, 4, 7, 55, 1, 36, 2, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 23, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 50, "column": 21, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR11", ".", "exists", "(", ")", "&&", "VAR11", ".", "isFile", "(", ")"], "tokens_order": [44, 3, 194, 1, 2, 76, 44, 3, 197, 1, 2, 0, 0, 0]}, {"id": 24, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 54, "column": 25, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR12", "=", "new", "FileInputStream", "(", "VAR11", ")"], "tokens_order": [52, 4, 7, 66, 1, 44, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 55, "column": 25, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR13", "=", "new", "InputStreamReader", "(", "VAR12", ",", "\"UTF-8\"", ")"], "tokens_order": [60, 4, 7, 46, 1, 52, 8, 42, 2, 0, 0, 0, 0, 0]}, {"id": 26, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 56, "column": 25, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR14", "=", "new", "BufferedReader", "(", "VAR13", ")"], "tokens_order": [77, 4, 7, 45, 1, 60, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "25"}], "varibles": ["readerBufferdSink"], "line": 57, "column": 25, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR14", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 77, 3, 47, 1, 2, 2, 0, 0, 0, 0]}, {"id": 28, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 68, "column": 33, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR14", "!=", "null"], "tokens_order": [77, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 70, "column": 33, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR14", ".", "close", "(", ")"], "tokens_order": [77, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 80, "column": 33, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR13", "!=", "null"], "tokens_order": [60, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 31, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 82, "column": 33, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR13", ".", "close", "(", ")"], "tokens_order": [60, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 32, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 92, "column": 33, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR12", "!=", "null"], "tokens_order": [52, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 33, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 94, "column": 33, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR12", ".", "close", "(", ")"], "tokens_order": [52, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 34, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 119, "column": 21, "tokens": ["streamObjectInput", "!=", "null"], "code": "streamObjectInput != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 35, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamObjectInput"], "line": 121, "column": 21, "tokens": ["streamObjectInput", ".", "close", "(", ")"], "code": "streamObjectInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 36, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 131, "column": 21, "tokens": ["streamByteArrayInput", "!=", "null"], "code": "streamByteArrayInput != null", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 37, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamByteArrayInput"], "line": 133, "column": 21, "tokens": ["streamByteArrayInput", ".", "close", "(", ")"], "code": "streamByteArrayInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__URLConnection_75b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 8, "target": 9, "type": "DDG"}, {"id": 8, "source": 3, "target": 10, "type": "DDG"}, {"id": 9, "source": 9, "target": 10, "type": "DDG"}, {"id": 10, "source": 8, "target": 11, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 9, "target": 13, "type": "DDG"}, {"id": 13, "source": 9, "target": 14, "type": "DDG"}, {"id": 14, "source": 8, "target": 15, "type": "DDG"}, {"id": 15, "source": 8, "target": 16, "type": "DDG"}, {"id": "-1", "source": 12, "target": 17, "type": "func_call_out"}, {"id": 0, "source": 17, "target": 18, "type": "DDG"}, {"id": 1, "source": 18, "target": 19, "type": "DDG"}, {"id": 2, "source": 19, "target": 20, "type": "DDG"}, {"id": 3, "source": 20, "target": 21, "type": "DDG"}, {"id": 4, "source": 20, "target": 22, "type": "DDG"}, {"id": 5, "source": 19, "target": 34, "type": "DDG"}, {"id": 6, "source": 19, "target": 35, "type": "DDG"}, {"id": 7, "source": 18, "target": 36, "type": "DDG"}, {"id": 8, "source": 18, "target": 37, "type": "DDG"}, {"id": 9, "source": 22, "target": 23, "type": "DDG"}, {"id": 10, "source": 22, "target": 24, "type": "DDG"}, {"id": 11, "source": 24, "target": 25, "type": "DDG"}, {"id": 12, "source": 25, "target": 26, "type": "DDG"}, {"id": 13, "source": 26, "target": 27, "type": "DDG"}, {"id": 14, "source": 26, "target": 28, "type": "DDG"}, {"id": 15, "source": 26, "target": 29, "type": "DDG"}, {"id": 16, "source": 25, "target": 30, "type": "DDG"}, {"id": 17, "source": 25, "target": 31, "type": "DDG"}, {"id": 18, "source": 24, "target": 32, "type": "DDG"}, {"id": 19, "source": 24, "target": 33, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__File_73a____bad", "nodes": [{"id": 0, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 41, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "code": "File file = new File(\"C:\\\\data.txt\")", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["File", "VAR0", "=", "new", "File", "(", "\"C:\\\\data.txt\"", ")"], "tokens_order": [55, 5, 4, 7, 55, 1, 114, 2, 0, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInput"], "line": 49, "column": 17, "tokens": ["streamFileInput", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInput = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR1", "=", "new", "FileInputStream", "(", "VAR0", ")"], "tokens_order": [10, 4, 7, 66, 1, 5, 2, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "streamFileInput"], "line": 50, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "streamFileInput", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(streamFileInput, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR2", "=", "new", "InputStreamReader", "(", "VAR1", ",", "\"UTF-8\"", ")"], "tokens_order": [6, 4, 7, 46, 1, 10, 8, 42, 2, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 51, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR3", "=", "new", "BufferedReader", "(", "VAR2", ")"], "tokens_order": [9, 4, 7, 45, 1, 6, 2, 0, 0, 0, 0, 0, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 56, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR4", "=", "VAR3", ".", "readLine", "(", ")"], "tokens_order": [11, 4, 9, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 5, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 67, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 69, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 79, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 81, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 91, "column": 25, "tokens": ["streamFileInput", "!=", "null"], "code": "streamFileInput != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInput"], "line": 93, "column": 25, "tokens": ["streamFileInput", ".", "close", "(", ")"], "code": "streamFileInput.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 103, "column": 9, "tokens": ["LinkedList", "<", "String", ">", "dataLinkedList", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "code": "LinkedList<String> dataLinkedList = new LinkedList<String>()", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["LinkedList", "<", "String", ">", "VAR5", "=", "new", "LinkedList", "<", "String", ">", "(", ")"], "tokens_order": [69, 32, 20, 34, 14, 4, 7, 69, 32, 20, 34, 1, 2]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 104, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "0", ",", "data", ")"], "code": "dataLinkedList.add(0, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR5", ".", "add", "(", "0", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 33, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 105, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "1", ",", "data", ")"], "code": "dataLinkedList.add(1, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR5", ".", "add", "(", "1", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 37, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 14, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 106, "column": 9, "tokens": ["dataLinkedList", ".", "add", "(", "2", ",", "data", ")"], "code": "dataLinkedList.add(2, data)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["VAR5", ".", "add", "(", "2", ",", "VAR4", ")"], "tokens_order": [14, 3, 53, 1, 35, 8, 11, 2, 0, 0, 0, 0, 0]}, {"id": 15, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__File_73b", "mtdSignature": "badSink(java.util.LinkedList<java.lang.String>)", "called_column": "9"}], "varibles": ["dataLinkedList"], "line": 107, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__File_73b", "(", ")", ")", ".", "badSink", "(", "dataLinkedList", ")"], "code": "(new CWE36_Absolute_Path_Traversal__File_73b()).badSink(dataLinkedList)", "java_file": "CWE36_Absolute_Path_Traversal__File_73a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR5", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 14, 2, 0, 0]}, {"id": 16, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataLinkedList"], "line": 29, "column": 5, "tokens": ["public", "void", "badSink", "(", "LinkedList", "<", "String", ">", "dataLinkedList", ")", "throws", "Throwable"], "code": "public void badSink(LinkedList<String> dataLinkedList) throws Throwable {\r\n    String data = dataLinkedList.remove(2);\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["public", "void", "FUN0", "(", "LinkedList", "<", "String", ">", "VAR6", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 69, 32, 20, 34, 15, 2, 22, 23, 0]}, {"id": 17, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["data", "dataLinkedList"], "line": 31, "column": 9, "tokens": ["String", "data", "=", "dataLinkedList", ".", "remove", "(", "2", ")"], "code": "String data = dataLinkedList.remove(2)", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["String", "VAR7", "=", "VAR6", ".", "remove", "(", "2", ")"], "tokens_order": [20, 18, 4, 15, 3, 89, 1, 35, 2, 0, 0, 0, 0]}, {"id": 18, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 34, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR7", "!=", "null"], "tokens_order": [18, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 36, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["File", "VAR8", "=", "new", "File", "(", "VAR7", ")"], "tokens_order": [55, 26, 4, 7, 55, 1, 18, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 20, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 40, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR8", ".", "exists", "(", ")", "&&", "VAR8", ".", "isFile", "(", ")"], "tokens_order": [26, 3, 194, 1, 2, 76, 26, 3, 197, 1, 2, 0, 0]}, {"id": 21, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR9", "=", "new", "FileInputStream", "(", "VAR8", ")"], "tokens_order": [31, 4, 7, 66, 1, 26, 2, 0, 0, 0, 0, 0, 0]}, {"id": 22, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 45, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR10", "=", "new", "InputStreamReader", "(", "VAR9", ",", "\"UTF-8\"", ")"], "tokens_order": [36, 4, 7, 46, 1, 31, 8, 42, 2, 0, 0, 0, 0]}, {"id": 23, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 46, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR11", "=", "new", "BufferedReader", "(", "VAR10", ")"], "tokens_order": [44, 4, 7, 45, 1, 36, 2, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 47, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR11", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 44, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 25, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 58, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR11", "!=", "null"], "tokens_order": [44, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 60, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR11", ".", "close", "(", ")"], "tokens_order": [44, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 70, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 28, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 72, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 29, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 82, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 30, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 84, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__File_73b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 3, "target": 4, "type": "DDG"}, {"id": 4, "source": 3, "target": 5, "type": "DDG"}, {"id": 5, "source": 3, "target": 6, "type": "DDG"}, {"id": 6, "source": 2, "target": 7, "type": "DDG"}, {"id": 7, "source": 2, "target": 8, "type": "DDG"}, {"id": 8, "source": 1, "target": 9, "type": "DDG"}, {"id": 9, "source": 1, "target": 10, "type": "DDG"}, {"id": 10, "source": 4, "target": 12, "type": "DDG"}, {"id": 11, "source": 11, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": 13, "source": 11, "target": 13, "type": "DDG"}, {"id": 14, "source": 4, "target": 14, "type": "DDG"}, {"id": 15, "source": 11, "target": 14, "type": "DDG"}, {"id": 16, "source": 11, "target": 15, "type": "DDG"}, {"id": "-1", "source": 15, "target": 16, "type": "func_call_out"}, {"id": 0, "source": 16, "target": 17, "type": "DDG"}, {"id": 1, "source": 17, "target": 18, "type": "DDG"}, {"id": 2, "source": 17, "target": 19, "type": "DDG"}, {"id": 3, "source": 19, "target": 20, "type": "DDG"}, {"id": 4, "source": 19, "target": 21, "type": "DDG"}, {"id": 5, "source": 21, "target": 22, "type": "DDG"}, {"id": 6, "source": 22, "target": 23, "type": "DDG"}, {"id": 7, "source": 23, "target": 24, "type": "DDG"}, {"id": 8, "source": 23, "target": 25, "type": "DDG"}, {"id": 9, "source": 23, "target": 26, "type": "DDG"}, {"id": 10, "source": 22, "target": 27, "type": "DDG"}, {"id": 11, "source": 22, "target": 28, "type": "DDG"}, {"id": 12, "source": 21, "target": 29, "type": "DDG"}, {"id": 13, "source": 21, "target": 30, "type": "DDG"}], "target": 1}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_22a____goodG2B2", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_22b", "mtdSignature": "goodG2B2Source()", "called_column": "16"}], "varibles": ["data"], "line": 192, "column": 9, "tokens": ["data", "=", "(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_22b", "(", ")", ")", ".", "goodG2B2Source", "(", ")"], "code": "data = (new CWE36_Absolute_Path_Traversal__connect_tcp_22b()).goodG2B2Source()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR0", "=", "(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", ")"], "tokens_order": [5, 4, 1, 7, 27, 1, 2, 2, 3, 16, 1, 2]}, {"id": 1, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 195, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 2, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 197, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["File", "VAR1", "=", "new", "File", "(", "VAR0", ")"], "tokens_order": [55, 10, 4, 7, 55, 1, 5, 2, 0, 0, 0, 0]}, {"id": 3, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 201, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR1", ".", "exists", "(", ")", "&&", "VAR1", ".", "isFile", "(", ")"], "tokens_order": [10, 3, 194, 1, 2, 76, 10, 3, 197, 1, 2, 0]}, {"id": 4, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 205, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR2", "=", "new", "FileInputStream", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 66, 1, 10, 2, 0, 0, 0, 0, 0]}, {"id": 5, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 206, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", "=", "new", "InputStreamReader", "(", "VAR2", ",", "\"UTF-8\"", ")"], "tokens_order": [9, 4, 7, 46, 1, 6, 8, 42, 2, 0, 0, 0]}, {"id": 6, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 207, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", "=", "new", "BufferedReader", "(", "VAR3", ")"], "tokens_order": [11, 4, 7, 45, 1, 9, 2, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 208, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR4", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 11, 3, 47, 1, 2, 2, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 219, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", "!=", "null"], "tokens_order": [11, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 221, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR4", ".", "close", "(", ")"], "tokens_order": [11, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 231, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", "!=", "null"], "tokens_order": [9, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 233, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR3", ".", "close", "(", ")"], "tokens_order": [9, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 243, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 13, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 245, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0]}, {"id": 14, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 140, "column": 13, "tokens": ["data", "=", "\"foo\""], "code": "data = \"foo\"", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22b", "new_tokens": ["VAR5", "=", "\"foo\""], "tokens_order": [14, 4, 162, 0, 0, 0, 0, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 15, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 146, "column": 13, "tokens": ["data", "=", "null"], "code": "data = null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22b", "new_tokens": ["VAR5", "=", "null"], "tokens_order": [14, 4, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "ReturnStmt", "mtdCallInfo": [], "varibles": ["data"], "line": 149, "column": 9, "tokens": ["return", "data", ";"], "code": "return data;", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_22b", "new_tokens": ["return", "VAR5", ";"], "tokens_order": [84, 14, 83, 0, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 0, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 4, "target": 5, "type": "DDG"}, {"id": 5, "source": 5, "target": 6, "type": "DDG"}, {"id": 6, "source": 6, "target": 7, "type": "DDG"}, {"id": 7, "source": 6, "target": 8, "type": "DDG"}, {"id": 8, "source": 6, "target": 9, "type": "DDG"}, {"id": 9, "source": 5, "target": 10, "type": "DDG"}, {"id": 10, "source": 5, "target": 11, "type": "DDG"}, {"id": 11, "source": 4, "target": 12, "type": "DDG"}, {"id": 12, "source": 4, "target": 13, "type": "DDG"}, {"id": "-1", "source": 16, "target": 0, "type": "func_call_in"}, {"id": 0, "source": 15, "target": 16, "type": "DDG"}, {"id": 1, "source": 14, "target": 16, "type": "DDG"}], "target": 0}, {"cwe": "CWE36", "fun_info": "CWE36_Absolute_Path_Traversal__connect_tcp_67a____bad", "nodes": [{"id": 0, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 53, "column": 17, "tokens": ["socket", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "code": "socket = new Socket(\"host.example.org\", 39544)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR0", "=", "new", "Socket", "(", "\"host.example.org\"", ",", "39544", ")"], "tokens_order": [5, 4, 7, 100, 1, 103, 8, 104, 2, 0, 0, 0, 0]}, {"id": 1, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "socket"], "line": 57, "column": 17, "tokens": ["readerInputStream", "=", "new", "InputStreamReader", "(", "socket", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "code": "readerInputStream = new InputStreamReader(socket.getInputStream(), \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR1", "=", "new", "InputStreamReader", "(", "VAR0", ".", "getInputStream", "(", ")", ",", "\"UTF-8\"", ")"], "tokens_order": [10, 4, 7, 46, 1, 5, 3, 58, 1, 2, 8, 42, 2]}, {"id": 2, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStream", "readerBuffered"], "line": 58, "column": 17, "tokens": ["readerBuffered", "=", "new", "BufferedReader", "(", "readerInputStream", ")"], "code": "readerBuffered = new BufferedReader(readerInputStream)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR2", "=", "new", "BufferedReader", "(", "VAR1", ")"], "tokens_order": [6, 4, 7, 45, 1, 10, 2, 0, 0, 0, 0, 0, 0]}, {"id": 3, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["data", "readerBuffered"], "line": 61, "column": 17, "tokens": ["data", "=", "readerBuffered", ".", "readLine", "(", ")"], "code": "data = readerBuffered.readLine()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR3", "=", "VAR2", ".", "readLine", "(", ")"], "tokens_order": [9, 4, 6, 3, 47, 1, 2, 0, 0, 0, 0, 0, 0], "bad_source": true}, {"id": 4, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 72, "column": 25, "tokens": ["readerBuffered", "!=", "null"], "code": "readerBuffered != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR2", "!=", "null"], "tokens_order": [6, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 5, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBuffered"], "line": 74, "column": 25, "tokens": ["readerBuffered", ".", "close", "(", ")"], "code": "readerBuffered.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR2", ".", "close", "(", ")"], "tokens_order": [6, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 6, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 84, "column": 25, "tokens": ["readerInputStream", "!=", "null"], "code": "readerInputStream != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR1", "!=", "null"], "tokens_order": [10, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 7, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStream"], "line": 86, "column": 25, "tokens": ["readerInputStream", ".", "close", "(", ")"], "code": "readerInputStream.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR1", ".", "close", "(", ")"], "tokens_order": [10, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 8, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 97, "column": 25, "tokens": ["socket", "!=", "null"], "code": "socket != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR0", "!=", "null"], "tokens_order": [5, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 9, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["socket"], "line": 99, "column": 25, "tokens": ["socket", ".", "close", "(", ")"], "code": "socket.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR0", ".", "close", "(", ")"], "tokens_order": [5, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 10, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 109, "column": 9, "tokens": ["Container", "dataContainer", "=", "new", "Container", "(", ")"], "code": "Container dataContainer = new Container()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["Container", "VAR4", "=", "new", "Container", "(", ")"], "tokens_order": [56, 11, 4, 7, 56, 1, 2, 0, 0, 0, 0, 0, 0]}, {"id": 11, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 110, "column": 9, "tokens": ["dataContainer", ".", "containerOne", "=", "data"], "code": "dataContainer.containerOne = data", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["VAR4", ".", "containerOne", "=", "VAR3"], "tokens_order": [11, 3, 70, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 12, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "mtdSignature": "badSink(testcases.CWE36_Absolute_Path_Traversal.CWE36_Absolute_Path_Traversal__connect_tcp_67a.Container)", "called_column": "9"}], "varibles": ["dataContainer"], "line": 111, "column": 9, "tokens": ["(", "new", "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "(", ")", ")", ".", "badSink", "(", "dataContainer", ")"], "code": "(new CWE36_Absolute_Path_Traversal__connect_tcp_67b()).badSink(dataContainer)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67a", "new_tokens": ["(", "new", "CLS0", "(", ")", ")", ".", "FUN0", "(", "VAR4", ")"], "tokens_order": [1, 7, 27, 1, 2, 2, 3, 16, 1, 11, 2, 0, 0]}, {"id": 13, "type": "MethodDeclaration", "mtdCallInfo": [], "varibles": ["dataContainer"], "line": 28, "column": 5, "tokens": ["public", "void", "badSink", "(", "CWE36_Absolute_Path_Traversal__connect_tcp_67a", ".", "Container", "dataContainer", ")", "throws", "Throwable"], "code": "public void badSink(CWE36_Absolute_Path_Traversal__connect_tcp_67a.Container dataContainer) throws Throwable {\r\n    String data = dataContainer.containerOne;\r\n    /* POTENTIAL FLAW: unvalidated or sandboxed value */\r\n    if (data != null) {\r\n        File file = new File(data);\r\n        FileInputStream streamFileInputSink = null;\r\n        InputStreamReader readerInputStreamSink = null;\r\n        BufferedReader readerBufferdSink = null;\r\n        if (file.exists() && file.isFile()) {\r\n            try {\r\n                streamFileInputSink = new FileInputStream(file);\r\n                readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\");\r\n                readerBufferdSink = new BufferedReader(readerInputStreamSink);\r\n                IO.writeLine(readerBufferdSink.readLine());\r\n            } catch (IOException exceptIO) {\r\n                IO.logger.log(Level.WARNING, \"Error with stream reading\", exceptIO);\r\n            } finally {\r\n                /* Close stream reading objects */\r\n                try {\r\n                    if (readerBufferdSink != null) {\r\n                        readerBufferdSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing BufferedReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (readerInputStreamSink != null) {\r\n                        readerInputStreamSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing InputStreamReader\", exceptIO);\r\n                }\r\n                try {\r\n                    if (streamFileInputSink != null) {\r\n                        streamFileInputSink.close();\r\n                    }\r\n                } catch (IOException exceptIO) {\r\n                    IO.logger.log(Level.WARNING, \"Error closing FileInputStream\", exceptIO);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return;\r\n}", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["public", "void", "FUN0", "(", "CWE36_Absolute_Path_Traversal__connect_tcp_67a", ".", "Container", "VAR5", ")", "throws", "Throwable"], "tokens_order": [28, 24, 16, 1, 0, 3, 56, 14, 2, 22, 23, 0, 0]}, {"id": 14, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["dataContainer", "data"], "line": 30, "column": 9, "tokens": ["String", "data", "=", "dataContainer", ".", "containerOne"], "code": "String data = dataContainer.containerOne", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["String", "VAR6", "=", "VAR5", ".", "containerOne"], "tokens_order": [20, 15, 4, 14, 3, 70, 0, 0, 0, 0, 0, 0, 0]}, {"id": 15, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["data"], "line": 33, "column": 13, "tokens": ["data", "!=", "null"], "code": "data != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR6", "!=", "null"], "tokens_order": [15, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 16, "type": "VariableDeclarationExpr", "mtdCallInfo": [], "varibles": ["file", "data"], "line": 35, "column": 13, "tokens": ["File", "file", "=", "new", "File", "(", "data", ")"], "code": "File file = new File(data)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["File", "VAR7", "=", "new", "File", "(", "VAR6", ")"], "tokens_order": [55, 18, 4, 7, 55, 1, 15, 2, 0, 0, 0, 0, 0], "bad_sink": true}, {"id": 17, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["file"], "line": 39, "column": 17, "tokens": ["file", ".", "exists", "(", ")", "&&", "file", ".", "isFile", "(", ")"], "code": "file.exists() && file.isFile()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR7", ".", "exists", "(", ")", "&&", "VAR7", ".", "isFile", "(", ")"], "tokens_order": [18, 3, 194, 1, 2, 76, 18, 3, 197, 1, 2, 0, 0]}, {"id": 18, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["file", "streamFileInputSink"], "line": 43, "column": 21, "tokens": ["streamFileInputSink", "=", "new", "FileInputStream", "(", "file", ")"], "code": "streamFileInputSink = new FileInputStream(file)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR8", "=", "new", "FileInputStream", "(", "VAR7", ")"], "tokens_order": [26, 4, 7, 66, 1, 18, 2, 0, 0, 0, 0, 0, 0]}, {"id": 19, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "streamFileInputSink"], "line": 44, "column": 21, "tokens": ["readerInputStreamSink", "=", "new", "InputStreamReader", "(", "streamFileInputSink", ",", "\"UTF-8\"", ")"], "code": "readerInputStreamSink = new InputStreamReader(streamFileInputSink, \"UTF-8\")", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR9", "=", "new", "InputStreamReader", "(", "VAR8", ",", "\"UTF-8\"", ")"], "tokens_order": [31, 4, 7, 46, 1, 26, 8, 42, 2, 0, 0, 0, 0]}, {"id": 20, "type": "AssignExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink", "readerBufferdSink"], "line": 45, "column": 21, "tokens": ["readerBufferdSink", "=", "new", "BufferedReader", "(", "readerInputStreamSink", ")"], "code": "readerBufferdSink = new BufferedReader(readerInputStreamSink)", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR10", "=", "new", "BufferedReader", "(", "VAR9", ")"], "tokens_order": [36, 4, 7, 45, 1, 31, 2, 0, 0, 0, 0, 0, 0]}, {"id": 21, "type": "MethodCallExpr", "mtdCallInfo": [{"className": "IO", "mtdSignature": "writeLine(java.lang.String)", "called_column": "21"}], "varibles": ["readerBufferdSink"], "line": 46, "column": 21, "tokens": ["IO", ".", "writeLine", "(", "readerBufferdSink", ".", "readLine", "(", ")", ")"], "code": "IO.writeLine(readerBufferdSink.readLine())", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["CLS1", ".", "FUN1", "(", "VAR10", ".", "readLine", "(", ")", ")"], "tokens_order": [38, 3, 25, 1, 36, 3, 47, 1, 2, 2, 0, 0, 0]}, {"id": 22, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 57, "column": 29, "tokens": ["readerBufferdSink", "!=", "null"], "code": "readerBufferdSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR10", "!=", "null"], "tokens_order": [36, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 23, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerBufferdSink"], "line": 59, "column": 29, "tokens": ["readerBufferdSink", ".", "close", "(", ")"], "code": "readerBufferdSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR10", ".", "close", "(", ")"], "tokens_order": [36, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 24, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 69, "column": 29, "tokens": ["readerInputStreamSink", "!=", "null"], "code": "readerInputStreamSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR9", "!=", "null"], "tokens_order": [31, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 25, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["readerInputStreamSink"], "line": 71, "column": 29, "tokens": ["readerInputStreamSink", ".", "close", "(", ")"], "code": "readerInputStreamSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR9", ".", "close", "(", ")"], "tokens_order": [31, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 26, "type": "BinaryExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 81, "column": 29, "tokens": ["streamFileInputSink", "!=", "null"], "code": "streamFileInputSink != null", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR8", "!=", "null"], "tokens_order": [26, 13, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, {"id": 27, "type": "MethodCallExpr", "mtdCallInfo": [], "varibles": ["streamFileInputSink"], "line": 83, "column": 29, "tokens": ["streamFileInputSink", ".", "close", "(", ")"], "code": "streamFileInputSink.close()", "java_file": "CWE36_Absolute_Path_Traversal__connect_tcp_67b", "new_tokens": ["VAR8", ".", "close", "(", ")"], "tokens_order": [26, 3, 17, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0]}], "edges": [{"id": 0, "source": 0, "target": 1, "type": "DDG"}, {"id": 1, "source": 1, "target": 2, "type": "DDG"}, {"id": 2, "source": 2, "target": 3, "type": "DDG"}, {"id": 3, "source": 2, "target": 4, "type": "DDG"}, {"id": 4, "source": 2, "target": 5, "type": "DDG"}, {"id": 5, "source": 1, "target": 6, "type": "DDG"}, {"id": 6, "source": 1, "target": 7, "type": "DDG"}, {"id": 7, "source": 0, "target": 8, "type": "DDG"}, {"id": 8, "source": 0, "target": 9, "type": "DDG"}, {"id": 9, "source": 10, "target": 11, "type": "DDG"}, {"id": 10, "source": 3, "target": 11, "type": "DDG"}, {"id": 11, "source": 10, "target": 12, "type": "DDG"}, {"id": "-1", "source": 12, "target": 13, "type": "func_call_out"}, {"id": 0, "source": 13, "target": 14, "type": "DDG"}, {"id": 1, "source": 14, "target": 15, "type": "DDG"}, {"id": 2, "source": 14, "target": 16, "type": "DDG"}, {"id": 3, "source": 16, "target": 17, "type": "DDG"}, {"id": 4, "source": 16, "target": 18, "type": "DDG"}, {"id": 5, "source": 18, "target": 19, "type": "DDG"}, {"id": 6, "source": 19, "target": 20, "type": "DDG"}, {"id": 7, "source": 20, "target": 21, "type": "DDG"}, {"id": 8, "source": 20, "target": 22, "type": "DDG"}, {"id": 9, "source": 20, "target": 23, "type": "DDG"}, {"id": 10, "source": 19, "target": 24, "type": "DDG"}, {"id": 11, "source": 19, "target": 25, "type": "DDG"}, {"id": 12, "source": 18, "target": 26, "type": "DDG"}, {"id": 13, "source": 18, "target": 27, "type": "DDG"}], "target": 1}]